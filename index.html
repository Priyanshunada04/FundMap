<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#000000">
<meta name="description" content="CapStack — Find, verify, and apply for startup funding. 2,400+ verified grants, accelerators, angels and VCs.">
<title>CapStack — Find. Verify. Apply.</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=Instrument+Sans:ital,wght@0,400;0,500;0,600;1,400&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }

:root {
–bg: #F5F2ED;
–bg2: #EDE9E2;
–surface: #FFFFFF;
–surface2: #FAF8F5;
–ink: #1C1814;
–ink2: #3D3530;
–muted: #8A7E74;
–border: #D8D0C6;
–accent: #33B50C;
–accent2: #2A6B4A;
–accent3: #1E4FA8;
–gold: #B8860B;
–green-vivid: #33B50C;
–tag-bg: #EDE9E2;
–font-display: ‘Syne’, sans-serif;
–font-body: ‘Instrument Sans’, sans-serif;
–font-serif: ‘Instrument Serif’, serif;
–radius: 8px;
–shadow: 0 2px 12px rgba(28,24,20,0.08);
–shadow-lg: 0 8px 40px rgba(28,24,20,0.14);
}

body { background: var(–bg); color: var(–ink); font-family: var(–font-body); font-size: 15px; line-height: 1.6; overflow-x: hidden; }

body::after {
content: ‘’;
position: fixed;
inset: 0;
background-image: url(“data:image/svg+xml,%3Csvg viewBox=‘0 0 256 256’ xmlns=‘http://www.w3.org/2000/svg’%3E%3Cfilter id=‘noise’%3E%3CfeTurbulence type=‘fractalNoise’ baseFrequency=‘0.9’ numOctaves=‘4’ stitchTiles=‘stitch’/%3E%3C/filter%3E%3Crect width=‘100%25’ height=‘100%25’ filter=‘url(%23noise)’ opacity=‘0.04’/%3E%3C/svg%3E”);
pointer-events: none;
z-index: 9999;
opacity: 0.4;
}

.view { display: none; min-height: 100vh; }
.view.active { display: block; animation: viewEnter 0.35s cubic-bezier(0.4,0,0.2,1) both; }
@keyframes viewEnter { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }

/* ── SKELETON LOADERS ── */
@keyframes shimmer {
0%   { background-position: -700px 0; }
100% { background-position:  700px 0; }
}
.skeleton-card {
background: var(–surface);
border: 1px solid var(–border);
border-radius: 14px;
padding: 20px 22px;
margin-bottom: 12px;
display: flex;
gap: 14px;
align-items: flex-start;
}
.skeleton-block {
background: linear-gradient(90deg, var(–bg2) 25%, rgba(200,195,188,0.4) 50%, var(–bg2) 75%);
background-size: 700px 100%;
animation: shimmer 1.5s infinite linear;
border-radius: 6px;
flex-shrink: 0;
}

/* ── CARD MICRO-INTERACTIONS ── */
.opp-card {
transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s cubic-bezier(0.34,1.56,0.64,1) !important;
}
.opp-card:hover { transform: translateY(-3px) scale(1.005) !important; }
.opp-card:active { transform: translateY(-1px) scale(1.002) !important; transition-duration: 0.08s !important; }

/* ── BUTTON MICRO-INTERACTIONS ── */
.btn { transition: transform 0.12s cubic-bezier(0.34,1.56,0.64,1), box-shadow 0.15s, background 0.15s, border-color 0.15s !important; }
.btn:hover  { transform: translateY(-1px); }
.btn:active { transform: translateY(0) scale(0.98); }

/* ── MODAL ENTRANCE ── */
.modal-box {
animation: modalIn 0.28s cubic-bezier(0.34,1.2,0.64,1) both;
}
@keyframes modalIn {
from { opacity:0; transform: scale(0.94) translateY(16px); }
to   { opacity:1; transform: scale(1)    translateY(0); }
}
.modal-overlay.open {
animation: fadeOverlay 0.2s ease both;
}
@keyframes fadeOverlay {
from { opacity:0; backdrop-filter:blur(0px); }
to   { opacity:1; backdrop-filter:blur(6px); }
}

/* ── TOAST TRANSITION ── */
@keyframes toastIn  { from { opacity:0; transform:translateX(24px); } to { opacity:1; transform:translateX(0); } }
@keyframes toastOut { from { opacity:1; transform:translateX(0); }    to { opacity:0; transform:translateX(24px); } }

/* ── NAV LINK ACTIVE INDICATOR ── */
.nav-link { position: relative; }
.nav-link.active::after {
content: ‘’;
position: absolute;
bottom: -1px; left: 50%; transform: translateX(-50%);
width: 16px; height: 2px;
background: #33B50C;
border-radius: 2px;
}

/* ── NAVIGATION ── */
.nav {
position: sticky; top: 0; z-index: 100;
background: #000000;
backdrop-filter: blur(16px);
border-bottom: 1px solid rgba(255,255,255,0.08);
padding: 0 40px;
display: flex; align-items: center; justify-content: space-between;
height: 60px;
}
.nav-logo { font-family: var(–font-display); font-weight: 800; font-size: 20px; color: #ffffff; cursor: pointer; letter-spacing: -0.02em; display: flex; align-items: center; gap: 0px; }
.nav-logo span { color: #33B50C; }
.nav-links { display: flex; align-items: center; gap: 4px; }
.nav-link { font-family: var(–font-body); font-size: 13px; font-weight: 500; color: rgba(255,255,255,0.75); padding: 6px 14px; border-radius: 20px; cursor: pointer; border: none; background: none; transition: background 0.15s, color 0.15s; }
.nav-link:hover { background: rgba(255,255,255,0.1); color: #fff; }
.nav-link.active { background: rgba(255,255,255,0.15); color: #fff; }
.nav-link.hidden { display: none; }
/* Critical fix: hidden must override user-menu’s display:flex */
.user-menu.hidden { display: none !important; }

/* ── PAGE TRANSITIONS ── */
.view {
display: none;
opacity: 0;
transform: translateY(12px);
transition: opacity 0.32s cubic-bezier(0.4,0,0.2,1), transform 0.32s cubic-bezier(0.4,0,0.2,1);
}
.view.active {
display: block;
opacity: 1;
transform: translateY(0);
}
.view.transitioning-out {
opacity: 0;
transform: translateY(-8px);
pointer-events: none;
}
/* Skeleton shimmer for loading states */
@keyframes shimmer {
0% { background-position: -600px 0; }
100% { background-position: 600px 0; }
}
.skeleton {
border-radius: 8px;
background: linear-gradient(90deg, var(–bg2) 25%, var(–border) 50%, var(–bg2) 75%);
background-size: 600px 100%;
animation: shimmer 1.4s infinite;
}
/* Nav transition */
.nav-link { transition: background 0.15s, color 0.15s, opacity 0.2s; }
.nav-link.hidden { display: none; }
/* User menu fade in/out */
.user-menu { transition: opacity 0.2s; }
.user-menu.hidden { display: none !important; opacity: 0; }

/* Auth button in nav */
.nav-auth-btn {
background: transparent;
color: #fff;
font-family: var(–font-display);
font-size: 13px;
font-weight: 600;
padding: 7px 18px;
border-radius: 6px;
border: 1.5px solid rgba(255,255,255,0.3);
cursor: pointer;
letter-spacing: 0.02em;
transition: all 0.15s;
}
.nav-auth-btn:hover {
border-color: #33B50C;
color: #33B50C;
background: rgba(51,181,12,0.06);
}
.nav-auth-btn.hidden { display: none !important; }

/* User menu — redesigned */
.user-menu { position: relative; display: flex; align-items: center; }
.user-avatar {
display: flex;
align-items: center;
gap: 8px;
padding: 5px 10px 5px 5px;
border-radius: 8px;
border: 1px solid rgba(255,255,255,0.15);
background: rgba(255,255,255,0.06);
cursor: pointer;
transition: all 0.15s;
font-family: var(–font-body);
font-size: 13px;
font-weight: 500;
color: rgba(255,255,255,0.85);
height: 36px;
}
.user-avatar:hover { border-color: rgba(255,255,255,0.28); background: rgba(255,255,255,0.1); color: #fff; }
.user-avatar-initials {
width: 26px; height: 26px; border-radius: 6px;
background: linear-gradient(135deg, #33B50C, #28920A);
color: #fff;
font-size: 11px; font-weight: 700;
display: flex; align-items: center; justify-content: center;
flex-shrink: 0;
letter-spacing: 0.02em;
}
.user-avatar.investor .user-avatar-initials { background: linear-gradient(135deg, #1E4FA8, #163a80); }
.user-avatar-name { max-width: 90px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.user-avatar-chevron { font-size: 9px; opacity: 0.4; margin-left: 2px; transition: transform 0.15s; }
.user-menu.open .user-avatar-chevron { transform: rotate(180deg); }

.user-dropdown {
display: none;
position: absolute; top: calc(100% + 8px); right: 0;
background: #fff;
border: 1px solid var(–border);
border-radius: 14px;
box-shadow: 0 12px 48px rgba(28,24,20,0.18), 0 2px 8px rgba(28,24,20,0.06);
min-width: 240px;
z-index: 500;
overflow: hidden;
animation: dropIn 0.15s ease;
}
@keyframes dropIn { from { opacity:0; transform:translateY(-6px) scale(0.98); } to { opacity:1; transform:translateY(0) scale(1); } }
.user-dropdown.open { display: block; }

.dropdown-header {
padding: 16px 18px 14px;
background: linear-gradient(135deg, #f8f6f2, #f0ece4);
border-bottom: 1px solid var(–border);
display: flex;
align-items: center;
gap: 12px;
}
.dropdown-avatar-large {
width: 40px; height: 40px; border-radius: 10px;
background: linear-gradient(135deg, #33B50C, #28920A);
color: #fff;
font-family: var(–font-display);
font-size: 15px; font-weight: 800;
display: flex; align-items: center; justify-content: center;
flex-shrink: 0;
}
.dropdown-avatar-large.investor { background: linear-gradient(135deg, #1E4FA8, #163a80); }
.dropdown-header-text { flex: 1; min-width: 0; }
.dropdown-name { font-family: var(–font-display); font-weight: 700; font-size: 14px; color: var(–ink); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.dropdown-email { font-size: 11px; color: var(–muted); margin-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.dropdown-type {
display: inline-flex; align-items: center; gap: 4px;
font-size: 10px; font-weight: 700; letter-spacing: 0.04em;
padding: 2px 7px; border-radius: 4px; margin-top: 5px;
}
.dropdown-type.founder { background: rgba(51,181,12,0.1); color: #1e7a00; }
.dropdown-type.investor { background: rgba(30,79,168,0.1); color: #1E4FA8; }
.dropdown-type.admin { background: rgba(200,75,49,0.1); color: #c84b31; }

.dropdown-section { padding: 8px 8px; border-bottom: 1px solid var(–border); }
.dropdown-section:last-child { border-bottom: none; }
.dropdown-item {
display: flex; align-items: center; gap: 10px;
width: 100%; text-align: left;
padding: 9px 12px; border-radius: 8px;
font-family: var(–font-body); font-size: 13px;
color: var(–ink2); cursor: pointer;
border: none; background: none;
transition: background 0.1s, color 0.1s;
}
.dropdown-item:hover { background: var(–bg2); color: var(–ink); }
.dropdown-item .di-icon { font-size: 15px; width: 20px; text-align: center; flex-shrink: 0; }
.dropdown-item .di-label { flex: 1; font-weight: 500; }
.dropdown-item .di-badge { font-size: 10px; background: var(–accent); color: #fff; padding: 1px 6px; border-radius: 4px; font-weight: 700; }
.dropdown-item.danger { color: #c84b31; }
.dropdown-item.danger:hover { background: rgba(200,75,49,0.06); color: #a83d28; }
.dropdown-divider { display: none; }

/* ── CONTAINERS ── */
.container { max-width: 1100px; margin: 0 auto; padding: 0 40px; }
.container-sm { max-width: 720px; margin: 0 auto; padding: 0 40px; }

/* ── BADGES & TAGS ── */
.badge { display: inline-flex; align-items: center; gap: 5px; font-family: var(–font-display); font-size: 11px; font-weight: 600; letter-spacing: 0.06em; text-transform: uppercase; padding: 3px 9px; border-radius: 4px; }
.badge-active { background: #D4EDDA; color: #155724; }
.badge-closed { background: #F8D7DA; color: #721C24; }
.badge-invite { background: #FFF3CD; color: #856404; }
.badge-pending { background: #FFF3CD; color: #856404; }
.badge-live { background: #D4EDDA; color: #155724; }
.badge-rejected { background: #F8D7DA; color: #721C24; }
.badge-verified { background: #D1ECF1; color: #0C5460; }
.badge-new { background: #33B50C; color: #fff; }
.badge-pro { background: linear-gradient(135deg, #B8860B, #DAA520); color: #fff; }

.tag { display: inline-block; font-size: 11px; font-weight: 500; padding: 2px 8px; border-radius: 4px; background: var(–tag-bg); color: var(–ink2); border: 1px solid var(–border); }

/* ── BUTTONS ── */
.btn { display: inline-flex; align-items: center; gap: 8px; font-family: var(–font-display); font-weight: 600; font-size: 14px; padding: 10px 22px; border-radius: 6px; border: none; cursor: pointer; transition: all 0.15s; letter-spacing: 0.01em; text-decoration: none; }
.btn-primary { background: var(–accent); color: #fff; }
.btn-primary:hover { background: #28920A; transform: translateY(-1px); box-shadow: 0 4px 16px rgba(51,181,12,0.3); }
.btn-secondary { background: var(–surface); color: var(–ink); border: 1px solid var(–border); }
.btn-secondary:hover { background: var(–bg2); }
.btn-ghost { background: transparent; color: var(–ink2); border: 1px solid var(–border); }
.btn-ghost:hover { background: var(–bg2); }
.btn-green { background: var(–accent2); color: #fff; }
.btn-green:hover { background: #1e5238; }
.btn-blue { background: var(–accent3); color: #fff; }
.btn-blue:hover { background: #183d85; }
.btn-sm { font-size: 12px; padding: 7px 14px; }
.btn-lg { font-size: 16px; padding: 14px 32px; }

/* ═══════════════════════════════════
AUTH MODAL
═══════════════════════════════════ */
.modal-overlay {
position: fixed; inset: 0; z-index: 9000;
background: rgba(28,24,20,0.7);
backdrop-filter: blur(6px);
display: flex; align-items: center; justify-content: center;
opacity: 0; pointer-events: none;
transition: opacity 0.2s;
}
.modal-overlay.open { opacity: 1; pointer-events: all; }

.auth-modal {
background: var(–surface);
border-radius: 20px;
width: 100%;
max-width: 460px;
margin: 20px;
box-shadow: 0 24px 80px rgba(28,24,20,0.3);
overflow: hidden;
transform: translateY(20px) scale(0.97);
transition: transform 0.25s ease;
}
.modal-overlay.open .auth-modal { transform: translateY(0) scale(1); }

.auth-modal-header {
padding: 32px 36px 0;
}
.auth-modal-logo { font-family: var(–font-display); font-weight: 800; font-size: 18px; color: var(–ink); margin-bottom: 24px; }
.auth-modal-logo span { color: var(–accent); }

/* Tab switcher */
.auth-tabs { display: flex; background: var(–bg2); border-radius: 8px; padding: 3px; margin-bottom: 28px; }
.auth-tab { flex: 1; padding: 8px; text-align: center; font-family: var(–font-display); font-size: 13px; font-weight: 600; color: var(–muted); border-radius: 6px; cursor: pointer; transition: all 0.15s; border: none; background: none; }
.auth-tab.active { background: var(–surface); color: var(–ink); box-shadow: 0 1px 4px rgba(28,24,20,0.1); }

.auth-modal-body { padding: 0 36px 36px; }

.auth-form { display: none; }
.auth-form.active { display: block; }

/* User type selector */
.user-type-selector { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
.user-type-btn {
border: 1.5px solid var(–border);
border-radius: 10px;
padding: 14px 12px;
text-align: center;
cursor: pointer;
transition: all 0.15s;
background: var(–surface);
}
.user-type-btn:hover { border-color: var(–ink2); }
.user-type-btn.selected.founder { border-color: var(–accent2); background: rgba(42,107,74,0.05); }
.user-type-btn.selected.investor { border-color: var(–accent3); background: rgba(30,79,168,0.05); }
.user-type-icon { font-size: 24px; margin-bottom: 6px; }
.user-type-label { font-family: var(–font-display); font-weight: 700; font-size: 13px; color: var(–ink); }
.user-type-sub { font-size: 11px; color: var(–muted); margin-top: 2px; }

.form-field { margin-bottom: 14px; }
.form-label { font-size: 12px; font-weight: 600; color: var(–ink2); margin-bottom: 6px; display: block; letter-spacing: 0.02em; }
.form-input, .form-textarea, .form-select {
width: 100%; padding: 10px 14px;
border: 1.5px solid var(–border); border-radius: 8px;
font-family: var(–font-body); font-size: 14px; color: var(–ink);
background: var(–bg); outline: none;
transition: border-color 0.15s, box-shadow 0.15s;
resize: vertical;
}
.form-input:focus, .form-textarea:focus, .form-select:focus { border-color: var(–accent2); box-shadow: 0 0 0 3px rgba(42,107,74,0.1); }
.form-textarea { min-height: 80px; }
.form-error { font-size: 11px; color: var(–accent); margin-top: 5px; display: none; }
.form-error.show { display: block; }

.auth-submit { width: 100%; margin-top: 20px; justify-content: center; font-size: 15px; padding: 13px; }

.auth-divider { display: flex; align-items: center; gap: 12px; margin: 16px 0; }
.auth-divider-line { flex: 1; height: 1px; background: var(–border); }
.auth-divider-text { font-size: 11px; color: var(–muted); font-weight: 500; }

.google-btn {
width: 100%; display: flex; align-items: center; justify-content: center; gap: 10px;
padding: 12px 16px; border: 1.5px solid #dadce0; border-radius: 10px;
font-family: ‘Google Sans’, var(–font-body); font-size: 14px; font-weight: 500; color: #3c4043;
background: #fff; cursor: pointer;
transition: background 0.15s, border-color 0.15s, box-shadow 0.15s;
box-shadow: 0 1px 3px rgba(0,0,0,0.08);
position: relative; overflow: hidden;
}
.google-btn::before {
content: ‘’; position: absolute; inset: 0;
background: rgba(66,133,244,0.04);
opacity: 0; transition: opacity 0.15s;
}
.google-btn:hover { border-color: #4285f4; box-shadow: 0 2px 8px rgba(66,133,244,0.18); }
.google-btn:hover::before { opacity: 1; }
.google-btn:active { box-shadow: 0 1px 2px rgba(0,0,0,0.1); transform: scale(0.99); }
.google-btn .google-btn-text { font-weight: 600; letter-spacing: 0.01em; }

/* Google account picker modal */
.google-picker-overlay {
position: fixed; inset: 0; z-index: 9500;
background: rgba(0,0,0,0.5);
display: flex; align-items: center; justify-content: center;
backdrop-filter: blur(4px);
opacity: 0; pointer-events: none;
transition: opacity 0.2s;
}
.google-picker-overlay.open { opacity: 1; pointer-events: all; }
.google-picker {
background: #fff; border-radius: 16px;
width: 100%; max-width: 400px; margin: 20px;
box-shadow: 0 24px 80px rgba(0,0,0,0.3);
overflow: hidden;
transform: scale(0.94) translateY(16px);
transition: transform 0.3s cubic-bezier(0.34,1.2,0.64,1);
}
.google-picker-overlay.open .google-picker { transform: scale(1) translateY(0); }

.google-picker-header {
padding: 24px 24px 16px;
border-bottom: 1px solid #f1f3f4;
text-align: center;
}
.google-picker-logo {
display: flex; align-items: center; justify-content: center; gap: 8px;
margin-bottom: 12px;
}
.google-picker-logo svg { width: 22px; height: 22px; }
.google-picker-logo span { font-size: 18px; font-weight: 700; color: #3c4043; letter-spacing: -0.01em; }
.google-picker-title { font-size: 20px; font-weight: 700; color: #202124; margin-bottom: 4px; font-family: ‘Google Sans’, sans-serif; }
.google-picker-sub { font-size: 13px; color: #5f6368; line-height: 1.4; }

.google-picker-accounts { padding: 8px 0; }
.google-account-row {
display: flex; align-items: center; gap: 14px;
padding: 12px 24px; cursor: pointer;
transition: background 0.12s;
-webkit-tap-highlight-color: transparent;
}
.google-account-row:hover { background: #f8f9fa; }
.google-account-row:active { background: #f1f3f4; }
.google-account-avatar {
width: 42px; height: 42px; border-radius: 50%;
display: flex; align-items: center; justify-content: center;
font-size: 16px; font-weight: 700; color: #fff;
flex-shrink: 0; position: relative;
}
.google-account-avatar .avatar-img {
width: 100%; height: 100%; border-radius: 50%; object-fit: cover;
}
.google-account-info { flex: 1; min-width: 0; }
.google-account-name { font-size: 14px; font-weight: 600; color: #202124; font-family: ‘Google Sans’, sans-serif; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.google-account-email { font-size: 12px; color: #5f6368; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.google-account-check { color: #1a73e8; font-size: 16px; }

.google-picker-divider { height: 1px; background: #f1f3f4; margin: 4px 0; }
.google-picker-add-row {
display: flex; align-items: center; gap: 14px;
padding: 12px 24px; cursor: pointer;
transition: background 0.12s; color: #1a73e8;
-webkit-tap-highlight-color: transparent;
}
.google-picker-add-row:hover { background: #f8f9fa; }
.google-picker-add-icon {
width: 42px; height: 42px; border-radius: 50%;
border: 1.5px solid #dadce0;
display: flex; align-items: center; justify-content: center;
font-size: 20px; color: #5f6368; flex-shrink: 0;
}
.google-picker-add-text { font-size: 14px; font-weight: 500; color: #1a73e8; font-family: ‘Google Sans’, sans-serif; }

.google-picker-footer {
padding: 12px 24px 16px;
border-top: 1px solid #f1f3f4;
display: flex; justify-content: flex-end; gap: 8px;
}
.google-picker-cancel {
padding: 8px 20px; border-radius: 6px;
border: none; background: none; cursor: pointer;
font-size: 13px; font-weight: 600; color: #1a73e8;
font-family: ‘Google Sans’, sans-serif;
transition: background 0.12s;
}
.google-picker-cancel:hover { background: rgba(26,115,232,0.06); }

/* Connected badge in profile */
.google-connected-badge {
display: inline-flex; align-items: center; gap: 6px;
background: #e8f5e9; color: #2e7d32; border: 1px solid #c8e6c9;
border-radius: 20px; padding: 4px 12px;
font-size: 12px; font-weight: 600; font-family: var(–font-body);
}
.google-connect-prompt {
display: flex; align-items: center; justify-content: space-between;
background: #f8f9ff; border: 1px solid #e3e8f8;
border-radius: 10px; padding: 14px 16px; margin-top: 16px;
gap: 12px; flex-wrap: wrap;
}
.google-connect-left { display: flex; align-items: center; gap: 10px; }
.google-connect-info strong { font-size: 13px; color: var(–ink); display: block; }
.google-connect-info span { font-size: 12px; color: var(–muted); }

/* Loading state on Google button */
.google-btn.loading { opacity: 0.7; pointer-events: none; }
.google-btn.loading .google-btn-text::after {
content: ‘…’; animation: ellipsis 1.2s infinite;
}
@keyframes ellipsis { 0%,100% { content: ‘…’; } 33% { content: ‘.’; } 66% { content: ‘..’; } }

.auth-switch { text-align: center; margin-top: 20px; font-size: 13px; color: var(–muted); }
.auth-switch a { color: var(–accent); font-weight: 600; cursor: pointer; text-decoration: none; }
.auth-switch a:hover { text-decoration: underline; }

.auth-modal-close { position: absolute; top: 20px; right: 20px; background: none; border: none; font-size: 20px; cursor: pointer; color: var(–muted); line-height: 1; padding: 4px; border-radius: 4px; transition: color 0.1s; }
.auth-modal-close:hover { color: var(–ink); }

/* ═══════════════════════════════════
SUBMIT OPPORTUNITY MODAL
═══════════════════════════════════ */
.submit-modal {
background: var(–surface);
border-radius: 20px;
width: 100%;
max-width: 680px;
margin: 20px;
box-shadow: 0 24px 80px rgba(28,24,20,0.3);
max-height: 90vh;
overflow-y: auto;
transform: translateY(20px) scale(0.97);
transition: transform 0.25s ease;
}
.modal-overlay.open .submit-modal { transform: translateY(0) scale(1); }

.submit-modal-header {
padding: 32px 36px 24px;
border-bottom: 1px solid var(–border);
position: sticky; top: 0;
background: var(–surface);
z-index: 10;
display: flex; justify-content: space-between; align-items: flex-start;
}
.submit-modal-header h2 { font-family: var(–font-display); font-size: 22px; font-weight: 800; color: var(–ink); letter-spacing: -0.02em; }
.submit-modal-header p { font-size: 13px; color: var(–muted); margin-top: 4px; }
.submit-modal-body { padding: 32px 36px; }

.form-section-title {
font-family: var(–font-display);
font-size: 11px; font-weight: 700;
letter-spacing: 0.1em; text-transform: uppercase;
color: var(–muted); margin-bottom: 16px;
padding-bottom: 8px;
border-bottom: 1px solid var(–border);
}

.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; }

.char-counter { font-size: 11px; color: var(–muted); text-align: right; margin-top: 4px; }
.char-counter.warn { color: var(–accent); }

/* Stage chips */
.stage-chips { display: flex; gap: 8px; flex-wrap: wrap; }
.stage-chip {
padding: 5px 12px;
border: 1.5px solid var(–border);
border-radius: 20px;
font-size: 12px; font-weight: 500;
cursor: pointer; transition: all 0.12s;
background: var(–surface); color: var(–ink2);
}
.stage-chip.selected { border-color: var(–accent2); background: rgba(42,107,74,0.08); color: var(–accent2); font-weight: 600; }

/* Eligibility builder */
.elig-builder { display: flex; flex-direction: column; gap: 8px; }
.elig-row { display: flex; gap: 8px; align-items: center; }
.elig-type-toggle { display: flex; border: 1px solid var(–border); border-radius: 6px; overflow: hidden; flex-shrink: 0; }
.elig-type-btn { padding: 8px 10px; font-size: 13px; font-weight: 700; border: none; background: none; cursor: pointer; transition: background 0.1s; color: var(–muted); }
.elig-type-btn.check.active { background: rgba(42,107,74,0.1); color: var(–accent2); }
.elig-type-btn.cross.active { background: rgba(51,181,12,0.1); color: var(–accent); }
.elig-input { flex: 1; padding: 8px 12px; border: 1.5px solid var(–border); border-radius: 6px; font-family: var(–font-body); font-size: 13px; outline: none; background: var(–bg); }
.elig-input:focus { border-color: var(–accent2); }
.elig-remove { background: none; border: none; color: var(–muted); cursor: pointer; font-size: 16px; padding: 4px; flex-shrink: 0; }
.elig-remove:hover { color: var(–accent); }

.submit-modal-footer { padding: 24px 36px; border-top: 1px solid var(–border); display: flex; gap: 12px; justify-content: flex-end; position: sticky; bottom: 0; background: var(–surface); }

/* ═══════════════════════════════════
LANDING
═══════════════════════════════════ */
.hero { padding: 100px 0 80px; position: relative; overflow: hidden; }

.hero-eyebrow {
display: inline-flex; align-items: center; gap: 8px;
font-size: 12px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase;
color: #33B50C; margin-bottom: 24px;
border: 1px solid rgba(51,181,12,0.45); padding: 5px 14px; border-radius: 20px;
background: linear-gradient(90deg, rgba(51,181,12,0.18) 0%, rgba(51,181,12,0.04) 80%);
position: relative; overflow: hidden;
box-shadow: 0 0 0 3px rgba(51,181,12,0.06), inset 0 1px 0 rgba(51,181,12,0.15);
}
.hero-eyebrow::before { content: ‘’; position: absolute; left: 0; top: 0; width: 80%; height: 100%; background: linear-gradient(90deg, rgba(51,181,12,0.13) 0%, rgba(51,181,12,0) 100%); border-radius: 20px; pointer-events: none; }

.hero-title { font-family: var(–font-display); font-size: clamp(52px, 7vw, 84px); font-weight: 800; line-height: 1.0; letter-spacing: -0.03em; color: var(–ink); margin-bottom: 28px; max-width: 700px; }
.hero-title em { font-style: italic; color: var(–accent); font-family: var(–font-serif); font-weight: 400; }
.hero-sub { font-size: 18px; color: var(–muted); max-width: 480px; line-height: 1.65; margin-bottom: 40px; }
.hero-actions { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }

.hero-trust { margin-top: 60px; display: flex; align-items: center; gap: 24px; flex-wrap: wrap; }
.trust-stat { display: flex; flex-direction: column; }
.trust-num { font-family: var(–font-display); font-size: 28px; font-weight: 800; color: var(–ink); letter-spacing: -0.02em; }
.trust-label { font-size: 12px; color: var(–muted); }
.trust-divider { width: 1px; height: 40px; background: var(–border); }

.hero-visual { position: absolute; right: -40px; top: 60px; width: 480px; pointer-events: none; animation: floatIn 0.8s 0.3s ease both; }
@keyframes floatIn { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }

.mini-card { background: var(–surface); border: 1px solid var(–border); border-radius: 12px; padding: 16px 20px; box-shadow: var(–shadow-lg); margin-bottom: 12px; opacity: 0; animation: cardFloat 0.5s ease both; }
.mini-card:nth-child(1) { animation-delay: 0.5s; margin-left: 0; }
.mini-card:nth-child(2) { animation-delay: 0.7s; margin-left: 40px; }
.mini-card:nth-child(3) { animation-delay: 0.9s; margin-left: 20px; }
@keyframes cardFloat { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

.mini-card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
.mini-card-name { font-family: var(–font-display); font-weight: 700; font-size: 14px; color: var(–ink); }
.mini-card-org { font-size: 12px; color: var(–muted); margin-top: 2px; }
.mini-card-amount { font-family: var(–font-display); font-size: 15px; font-weight: 700; color: var(–accent2); }
.mini-card-footer { display: flex; gap: 6px; margin-top: 10px; flex-wrap: wrap; }

.how-it-works { padding: 80px 0; }
.section-label { font-family: var(–font-display); font-size: 11px; font-weight: 600; letter-spacing: 0.12em; text-transform: uppercase; color: var(–muted); margin-bottom: 16px; }
.section-title { font-family: var(–font-display); font-size: clamp(28px, 3.5vw, 40px); font-weight: 800; letter-spacing: -0.02em; color: var(–ink); line-height: 1.15; margin-bottom: 48px; }

.steps-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1px; background: var(–border); border: 1px solid var(–border); border-radius: 12px; overflow: hidden; }
.step-card { background: var(–surface); padding: 36px 28px; transition: background 0.2s; }
.step-card:hover { background: var(–surface2); }
.step-num { font-family: var(–font-display); font-size: 48px; font-weight: 800; color: var(–border); line-height: 1; margin-bottom: 16px; }
.step-icon { font-size: 28px; margin-bottom: 12px; display: block; }
.step-title { font-family: var(–font-display); font-weight: 700; font-size: 16px; color: var(–ink); margin-bottom: 8px; }
.step-desc { font-size: 13px; color: var(–muted); line-height: 1.6; }

.pain-section { padding: 80px 0; background: var(–ink); }
.pain-section .section-label { color: var(–muted); }
.pain-section .section-title { color: #fff; }
.pain-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 24px; }
.pain-card { border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 32px; background: rgba(255,255,255,0.03); transition: background 0.2s, transform 0.2s; }
.pain-card:hover { background: rgba(255,255,255,0.07); transform: translateY(-2px); }
.pain-icon { font-size: 32px; margin-bottom: 16px; display: block; }
.pain-title { font-family: var(–font-display); font-weight: 700; font-size: 17px; color: #fff; margin-bottom: 10px; }
.pain-desc { font-size: 13px; color: rgba(255,255,255,0.5); line-height: 1.65; }
.pain-quote { margin-top: 14px; font-family: var(–font-serif); font-style: italic; font-size: 13px; color: rgba(255,255,255,0.35); border-left: 2px solid var(–accent); padding-left: 12px; }

.cta-banner { padding: 80px 0; text-align: center; }
.cta-inner { background: var(–surface); border: 1px solid var(–border); border-radius: 20px; padding: 64px; max-width: 640px; margin: 0 auto; box-shadow: var(–shadow-lg); }
.cta-inner h2 { font-family: var(–font-display); font-size: 36px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); margin-bottom: 16px; }
.cta-inner p { color: var(–muted); margin-bottom: 32px; font-size: 16px; }
.cta-btns { display: flex; gap: 12px; justify-content: center; }

/* ═══════════════════════════════════
DIRECTORY
═══════════════════════════════════ */
.dir-header { padding: 48px 0 32px; border-bottom: 1px solid var(–border); background: var(–surface); }
.dir-header h1 { font-family: var(–font-display); font-size: 32px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); }
.dir-search-row { display: flex; gap: 12px; margin-top: 20px; align-items: center; }
.search-box { flex: 1; position: relative; }
.search-box input { width: 100%; height: 44px; padding: 0 44px 0 44px; border: 1.5px solid var(–border); border-radius: 8px; font-family: var(–font-body); font-size: 14px; color: var(–ink); background: var(–bg); outline: none; transition: border-color 0.15s; }
.search-box input:focus { border-color: var(–accent); }
.search-icon { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: var(–muted); font-size: 16px; pointer-events: none; }
.dir-body { display: flex; gap: 28px; padding: 32px 0; }

.filters-panel { width: 240px; flex-shrink: 0; position: sticky; top: 92px; height: fit-content; }
.filter-section { margin-bottom: 28px; }
.filter-title { font-family: var(–font-display); font-size: 11px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(–muted); margin-bottom: 10px; }
.filter-option { display: flex; align-items: center; gap: 8px; padding: 6px 0; cursor: pointer; font-size: 13px; color: var(–ink2); transition: color 0.15s; }
.filter-option:hover { color: var(–ink); }
.filter-option input[type=checkbox] { accent-color: var(–accent); width: 14px; height: 14px; }
.filter-count { margin-left: auto; font-size: 11px; color: var(–muted); background: var(–bg2); padding: 1px 6px; border-radius: 10px; }

.results-area { flex: 1; min-width: 0; }
.results-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.results-count { font-size: 14px; color: var(–muted); }
.results-count strong { color: var(–ink); }
.sort-select { font-family: var(–font-body); font-size: 13px; padding: 6px 12px; border: 1px solid var(–border); border-radius: 6px; background: var(–surface); color: var(–ink); cursor: pointer; outline: none; }

.opp-card { background: var(–surface); border: 1px solid var(–border); border-radius: 12px; padding: 24px; margin-bottom: 12px; cursor: pointer; transition: border-color 0.15s, box-shadow 0.15s, transform 0.1s; display: flex; gap: 20px; align-items: flex-start; animation: slideUp 0.3s ease both; }
.opp-card:hover { border-color: var(–accent); box-shadow: var(–shadow); transform: translateY(-1px); }
@keyframes slideUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

.opp-logo { width: 52px; height: 52px; border-radius: 10px; background: var(–bg2); display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0; border: 1px solid var(–border); }
.opp-main { flex: 1; min-width: 0; }
.opp-top { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap; }
.opp-name { font-family: var(–font-display); font-weight: 700; font-size: 16px; color: var(–ink); letter-spacing: -0.01em; }
.opp-org { font-size: 12px; color: var(–muted); margin-top: 2px; }
.opp-right { display: flex; flex-direction: column; align-items: flex-end; gap: 6px; }
.opp-amount { font-family: var(–font-display); font-weight: 700; font-size: 18px; color: var(–accent2); letter-spacing: -0.01em; white-space: nowrap; }
.opp-meta { display: flex; gap: 8px; margin: 10px 0 12px; flex-wrap: wrap; align-items: center; }
.opp-deadline { font-size: 12px; color: var(–muted); display: flex; align-items: center; gap: 4px; }
.opp-deadline.urgent { color: var(–accent); font-weight: 600; }
.opp-desc { font-size: 13px; color: var(–muted); line-height: 1.55; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.opp-footer { display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap; align-items: center; }
.match-pill { display: inline-flex; align-items: center; gap: 4px; font-family: var(–font-display); font-size: 11px; font-weight: 700; padding: 3px 9px; border-radius: 4px; background: rgba(42,107,74,0.1); color: var(–accent2); letter-spacing: 0.04em; }
.community-pill { display: inline-flex; align-items: center; gap: 4px; font-family: var(–font-display); font-size: 11px; font-weight: 700; padding: 3px 9px; border-radius: 4px; background: rgba(30,79,168,0.08); color: var(–accent3); }
.opp-type-chip { display: inline-flex; align-items: center; gap: 5px; font-size: 11px; font-weight: 600; padding: 3px 9px; border-radius: 5px; letter-spacing: 0.02em; }
.chip-accelerator { background: rgba(30,79,168,0.08); color: #1E4FA8; border: 1px solid rgba(30,79,168,0.15); }
.chip-government { background: rgba(184,134,11,0.08); color: #8a6400; border: 1px solid rgba(184,134,11,0.15); }
.chip-vc { background: rgba(51,181,12,0.07); color: #1e7a00; border: 1px solid rgba(51,181,12,0.15); }
.chip-foundation { background: rgba(139,90,147,0.08); color: #7b4f83; border: 1px solid rgba(139,90,147,0.15); }
.chip-angel { background: rgba(200,140,50,0.08); color: #8a5c00; border: 1px solid rgba(200,140,50,0.15); }

/* ═══════════════════════════════════
DETAIL
═══════════════════════════════════ */
.detail-back { display: inline-flex; align-items: center; gap: 6px; font-size: 13px; color: var(–muted); cursor: pointer; padding: 8px 0; font-family: var(–font-body); border: none; background: none; margin-bottom: 12px; transition: color 0.15s; }
.detail-back:hover { color: var(–ink); }
.detail-header { padding: 40px 0 0; background: var(–surface); border-bottom: 1px solid var(–border); }
.detail-header-inner { max-width: 800px; margin: 0 auto; padding: 0 40px 40px; }
.detail-logo { width: 72px; height: 72px; border-radius: 14px; background: var(–bg2); display: flex; align-items: center; justify-content: center; font-size: 36px; border: 1px solid var(–border); margin-bottom: 20px; }
.detail-title { font-family: var(–font-display); font-size: 36px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); margin-bottom: 6px; }
.detail-org { font-size: 15px; color: var(–muted); margin-bottom: 20px; }
.detail-badges { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 24px; }

.trust-panel { background: var(–surface); border: 1.5px solid var(–border); border-radius: 12px; padding: 24px; margin-bottom: 28px; }
.trust-panel-title { font-family: var(–font-display); font-size: 12px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(–muted); margin-bottom: 16px; }
.trust-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 16px; }
.trust-item { display: flex; flex-direction: column; gap: 4px; }
.trust-item-label { font-size: 11px; color: var(–muted); }
.trust-item-value { font-family: var(–font-display); font-size: 14px; font-weight: 700; color: var(–ink); }
.trust-stars { color: var(–gold); font-size: 14px; }

.detail-body { max-width: 800px; margin: 0 auto; padding: 40px; display: flex; flex-direction: column; gap: 40px; }
.detail-section h3 { font-family: var(–font-display); font-size: 13px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(–muted); margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid var(–border); }
.detail-section p { font-size: 15px; color: var(–ink2); line-height: 1.7; }
.eligibility-list { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.eligibility-list li { display: flex; align-items: flex-start; gap: 10px; font-size: 14px; color: var(–ink2); }
.elig-check { color: var(–accent2); font-weight: 700; flex-shrink: 0; }
.elig-cross { color: var(–accent); flex-shrink: 0; }

.review-card { background: var(–surface2); border: 1px solid var(–border); border-radius: 10px; padding: 20px; margin-bottom: 12px; }
.review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.reviewer { font-family: var(–font-display); font-weight: 600; font-size: 13px; color: var(–ink); }
.review-date { font-size: 11px; color: var(–muted); }
.review-stars { color: var(–gold); font-size: 13px; margin-bottom: 8px; }
.review-text { font-size: 13px; color: var(–ink2); line-height: 1.6; }

.apply-box { background: var(–ink); border-radius: 12px; padding: 32px; text-align: center; }
.apply-box h3 { font-family: var(–font-display); font-size: 20px; color: #fff; font-weight: 700; margin-bottom: 8px; }
.apply-box p { color: rgba(255,255,255,0.5); font-size: 13px; margin-bottom: 20px; }
.apply-btns { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }

/* ═══════════════════════════════════
FOUNDER PROFILE
═══════════════════════════════════ */
.profile-view { padding: 48px 0 80px; }
.profile-header { margin-bottom: 40px; }
.profile-header h1 { font-family: var(–font-display); font-size: 28px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); margin-bottom: 8px; }
.profile-header p { color: var(–muted); font-size: 15px; }
.progress-bar-wrap { background: var(–bg2); border-radius: 8px; height: 8px; margin: 24px 0 8px; overflow: hidden; }
.progress-bar-fill { background: linear-gradient(90deg, var(–accent2), #4CAF50); height: 100%; width: 65%; border-radius: 8px; transition: width 0.5s ease; }
.progress-label { font-size: 12px; color: var(–muted); }
.profile-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
.profile-card { background: var(–surface); border: 1px solid var(–border); border-radius: 12px; padding: 28px; }
.profile-card.full-width { grid-column: 1 / -1; }
.profile-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.profile-card-title { font-family: var(–font-display); font-weight: 700; font-size: 15px; color: var(–ink); }
.complete { color: var(–accent2); font-weight: 600; font-size: 11px; }
.incomplete { color: var(–accent); font-weight: 600; font-size: 11px; }
.traction-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.metric-box { background: var(–bg2); border-radius: 8px; padding: 16px; border: 1px solid var(–border); }
.metric-label { font-size: 11px; color: var(–muted); margin-bottom: 4px; }
.metric-value { font-family: var(–font-display); font-size: 20px; font-weight: 800; color: var(–ink); }

/* ═══════════════════════════════════
TRACKER
═══════════════════════════════════ */
.tracker-view { padding: 48px 0 80px; }
.tracker-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 32px; flex-wrap: wrap; gap: 16px; }
.tracker-header h1 { font-family: var(–font-display); font-size: 28px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); }
.stats-row { display: flex; gap: 16px; margin-bottom: 32px; flex-wrap: wrap; }
.stat-card { background: var(–surface); border: 1px solid var(–border); border-radius: 10px; padding: 20px 24px; flex: 1; min-width: 140px; }
.stat-num { font-family: var(–font-display); font-size: 32px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); }
.stat-label { font-size: 12px; color: var(–muted); margin-top: 2px; }
.kanban { display: grid; grid-template-columns: repeat(4,1fr); gap: 16px; }
.kanban-col-header { font-family: var(–font-display); font-size: 11px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(–muted); margin-bottom: 12px; display: flex; align-items: center; gap: 6px; }
.kanban-count { background: var(–bg2); color: var(–ink2); font-size: 10px; padding: 1px 6px; border-radius: 10px; }
.tracker-card { background: var(–surface); border: 1px solid var(–border); border-radius: 10px; padding: 16px; margin-bottom: 10px; cursor: pointer; transition: border-color 0.15s, box-shadow 0.15s; }
.tracker-card:hover { border-color: var(–accent); box-shadow: var(–shadow); }
.tracker-card-name { font-family: var(–font-display); font-weight: 700; font-size: 13px; color: var(–ink); margin-bottom: 4px; }
.tracker-card-org { font-size: 11px; color: var(–muted); margin-bottom: 10px; }
.tracker-card-deadline { font-size: 11px; display: flex; align-items: center; gap: 4px; color: var(–muted); }
.tracker-card-deadline.soon { color: var(–accent); font-weight: 600; }
.tracker-card-amount { font-family: var(–font-display); font-weight: 700; font-size: 14px; color: var(–accent2); margin-top: 8px; }
.tracker-card-note { font-size: 11px; color: var(–muted); margin-top: 8px; font-style: italic; background: var(–bg2); padding: 6px 8px; border-radius: 6px; }
.alert-bar { background: rgba(51,181,12,0.08); border: 1px solid rgba(51,181,12,0.2); border-radius: 8px; padding: 12px 16px; display: flex; align-items: center; gap: 10px; margin-bottom: 24px; font-size: 13px; color: var(–accent); }

/* ═══════════════════════════════════
INVESTOR DASHBOARD
═══════════════════════════════════ */
.inv-dashboard { padding: 48px 0 80px; }
.inv-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; flex-wrap: wrap; gap: 16px; }
.inv-header h1 { font-family: var(–font-display); font-size: 28px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); }
.inv-header p { color: var(–muted); font-size: 14px; margin-top: 4px; }

.inv-stats { display: flex; gap: 16px; margin-bottom: 36px; flex-wrap: wrap; }
.inv-stat { background: var(–surface); border: 1px solid var(–border); border-radius: 12px; padding: 24px 28px; flex: 1; min-width: 160px; }
.inv-stat-num { font-family: var(–font-display); font-size: 36px; font-weight: 800; letter-spacing: -0.02em; color: var(–ink); }
.inv-stat-label { font-size: 12px; color: var(–muted); margin-top: 4px; }

.inv-section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.inv-section-title { font-family: var(–font-display); font-size: 16px; font-weight: 700; color: var(–ink); }

.submission-card { background: var(–surface); border: 1px solid var(–border); border-radius: 12px; padding: 24px; margin-bottom: 12px; display: flex; gap: 20px; align-items: flex-start; transition: border-color 0.15s, box-shadow 0.15s; }
.submission-card:hover { border-color: var(–border); box-shadow: var(–shadow); }
.sub-icon { width: 48px; height: 48px; border-radius: 10px; background: var(–bg2); display: flex; align-items: center; justify-content: center; font-size: 22px; flex-shrink: 0; border: 1px solid var(–border); }
.sub-main { flex: 1; min-width: 0; }
.sub-top { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap; margin-bottom: 6px; }
.sub-name { font-family: var(–font-display); font-weight: 700; font-size: 15px; color: var(–ink); }
.sub-org { font-size: 12px; color: var(–muted); }
.sub-meta { display: flex; gap: 12px; margin-top: 10px; flex-wrap: wrap; }
.sub-meta-item { font-size: 12px; color: var(–muted); display: flex; align-items: center; gap: 4px; }
.sub-right { display: flex; flex-direction: column; align-items: flex-end; gap: 8px; flex-shrink: 0; }
.sub-views { font-size: 12px; color: var(–muted); display: flex; align-items: center; gap: 4px; }

.inv-empty { text-align: center; padding: 80px 20px; }
.inv-empty-icon { font-size: 56px; margin-bottom: 20px; opacity: 0.4; }
.inv-empty h3 { font-family: var(–font-display); font-size: 20px; font-weight: 700; color: var(–ink); margin-bottom: 8px; }
.inv-empty p { color: var(–muted); font-size: 14px; margin-bottom: 24px; }

/* Tips panel */
.tips-panel { background: rgba(30,79,168,0.04); border: 1px solid rgba(30,79,168,0.12); border-radius: 12px; padding: 24px; margin-top: 32px; }
.tips-panel-title { font-family: var(–font-display); font-size: 12px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(–accent3); margin-bottom: 12px; }
.tips-list { list-style: none; display: flex; flex-direction: column; gap: 8px; }
.tips-list li { font-size: 13px; color: var(–ink2); display: flex; gap: 8px; align-items: flex-start; }
.tips-list li::before { content: ‘→’; color: var(–accent3); font-weight: 700; flex-shrink: 0; }

/* ── TOAST ── */
.toast { position: fixed; bottom: 24px; right: 24px; background: var(–ink); color: #fff; padding: 14px 22px; border-radius: 10px; box-shadow: 0 8px 32px rgba(0,0,0,0.28); z-index: 9999; transform: translateX(120px); opacity: 0; transition: transform 0.3s cubic-bezier(0.34,1.2,0.64,1), opacity 0.25s ease; font-size: 14px; max-width: 320px; line-height: 1.4; border-left: 3px solid rgba(255,255,255,0.2); }
.toast.show { transform: translateX(0); opacity: 1; }
.toast.success { background: #1a5c0a; border-left-color: #33B50C; }
.toast.error   { background: #7a1a0a; border-left-color: #e05533; }

/* ── FOOTER ── */
.footer-nav { background: var(–ink); padding: 32px 40px; display: flex; justify-content: space-between; align-items: center; margin-top: 60px; }
.footer-logo { font-family: var(–font-display); font-weight: 800; font-size: 18px; color: #fff; }
.footer-logo span { color: var(–accent); }
.footer-text { font-size: 12px; color: rgba(255,255,255,0.3); }

@keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
.fade-in { animation: fadeIn 0.4s ease both; }

.empty-state { text-align: center; padding: 60px 20px; color: var(–muted); }
.empty-state-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.5; }
.empty-state h3 { font-family: var(–font-display); font-size: 18px; color: var(–ink); margin-bottom: 8px; }

/* ═══════════════════════════════════════════
ONBOARDING FLOW
═══════════════════════════════════════════ */
.onboarding-overlay {
position: fixed; inset: 0; z-index: 8000;
background: rgba(10,10,10,0.82);
backdrop-filter: blur(8px);
display: flex; align-items: center; justify-content: center;
opacity: 0; pointer-events: none;
transition: opacity 0.3s ease;
}
.onboarding-overlay.open { opacity: 1; pointer-events: all; }
.onboarding-modal {
background: #fff; border-radius: 24px;
width: 100%; max-width: 520px; margin: 20px;
box-shadow: 0 32px 100px rgba(0,0,0,0.35); overflow: hidden;
transform: scale(0.94) translateY(20px);
transition: transform 0.35s cubic-bezier(0.34,1.2,0.64,1);
}
.onboarding-overlay.open .onboarding-modal { transform: scale(1) translateY(0); }
.onboarding-header {
background: linear-gradient(135deg, #0D0D0D 0%, #1a2a12 100%);
padding: 32px 36px 24px; position: relative; overflow: hidden;
}
.onboarding-header::after {
content: ‘’; position: absolute; top: -40px; right: -40px;
width: 180px; height: 180px;
background: radial-gradient(circle, rgba(51,181,12,0.2) 0%, transparent 70%);
}
.onboarding-step-dots { display: flex; gap: 6px; margin-bottom: 18px; }
.onboarding-step-dot {
height: 4px; border-radius: 2px;
background: rgba(255,255,255,0.15);
transition: background 0.3s, width 0.3s;
width: 24px;
}
.onboarding-step-dot.active { background: #33B50C; width: 36px; }
.onboarding-step-dot.done  { background: rgba(51,181,12,0.4); }
.onboarding-header h2 {
font-family: var(–font-display); font-size: 22px; font-weight: 800;
color: #fff; letter-spacing: -0.02em; margin-bottom: 6px; line-height: 1.2;
}
.onboarding-header p { font-size: 13px; color: rgba(255,255,255,0.5); line-height: 1.5; }
.onboarding-progress-bar {
height: 3px; background: var(–bg2); margin: 20px 36px 0; border-radius: 2px; overflow: hidden;
}
.onboarding-progress-fill {
height: 100%; background: #33B50C; border-radius: 2px;
transition: width 0.4s cubic-bezier(0.4,0,0.2,1);
}
.onboarding-body { padding: 28px 36px 8px; }
.onboarding-step { display: none; }
.onboarding-step.active { display: block; animation: stepIn 0.28s ease both; }
@keyframes stepIn { from { opacity:0; transform:translateX(14px); } to { opacity:1; transform:translateX(0); } }
.onboarding-question {
font-family: var(–font-display); font-size: 15px; font-weight: 700;
color: var(–ink); margin-bottom: 14px;
}
.onboarding-hint { font-size: 12px; color: var(–muted); margin-bottom: 14px; margin-top: -10px; }
.onboarding-chips { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 8px; }
.onboarding-chip {
padding: 8px 16px; border-radius: 100px;
border: 1.5px solid var(–border); background: var(–surface);
font-family: var(–font-body); font-size: 13px; font-weight: 500;
color: var(–ink2); cursor: pointer; transition: all 0.15s;
-webkit-tap-highlight-color: transparent; user-select: none;
}
.onboarding-chip:hover { border-color: #33B50C; color: #1e7a00; background: rgba(51,181,12,0.05); }
.onboarding-chip.selected { background: #33B50C; border-color: #33B50C; color: #fff; font-weight: 600; }
.onboarding-footer {
padding: 16px 36px 28px;
display: flex; justify-content: space-between; align-items: center; gap: 12px;
}
.onboarding-skip {
font-size: 12px; color: var(–muted); cursor: pointer;
background: none; border: none; font-family: var(–font-body);
text-decoration: underline; text-underline-offset: 3px;
}
.onboarding-welcome-screen { padding: 8px 0 4px; }
.onboarding-welcome-emoji { font-size: 48px; margin-bottom: 8px; display: block; }
.onboarding-welcome-list {
list-style: none; padding: 0; margin: 16px 0 0;
display: flex; flex-direction: column; gap: 8px;
}
.onboarding-welcome-list li {
display: flex; align-items: center; gap: 10px;
font-size: 13px; color: var(–ink2);
}
.onboarding-welcome-list .wl-icon {
width: 28px; height: 28px; border-radius: 7px;
background: var(–bg2); display: flex; align-items: center;
justify-content: center; font-size: 14px; flex-shrink: 0;
}

/* ═══════════════════════════════════════════
MATCH SCORE TOOLTIP
═══════════════════════════════════════════ */
.match-pill-wrap { position: relative; display: inline-flex; }
.match-tooltip {
position: absolute; bottom: calc(100% + 8px); left: 50%;
transform: translateX(-50%) translateY(4px);
background: #1a1a1a; color: #fff;
border-radius: 10px; padding: 10px 14px;
font-size: 12px; width: 210px;
box-shadow: 0 8px 28px rgba(0,0,0,0.25);
pointer-events: none; opacity: 0;
transition: opacity 0.18s, transform 0.18s;
z-index: 200; white-space: normal; line-height: 1.5;
}
.match-tooltip::after {
content: ‘’; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
border: 5px solid transparent; border-top-color: #1a1a1a;
}
.match-pill-wrap:hover .match-tooltip { opacity: 1; transform: translateX(-50%) translateY(0); }
.match-tooltip-title {
font-size: 9px; font-weight: 800; letter-spacing: 0.08em;
text-transform: uppercase; color: rgba(255,255,255,0.35); margin-bottom: 7px;
}
.match-tooltip-row {
display: flex; align-items: center; gap: 7px;
padding: 2px 0; font-size: 11px; color: rgba(255,255,255,0.8);
}
.mtr-icon { font-size: 12px; width: 14px; flex-shrink: 0; }
.match-tooltip-score {
font-size: 18px; font-weight: 800; color: #33B50C;
font-family: var(–font-display); margin-bottom: 4px;
}

/* ═══════════════════════════════════════════
TRACKER EMPTY STATE
═══════════════════════════════════════════ */
.tracker-empty-state {
text-align: center; padding: 64px 20px; max-width: 440px; margin: 0 auto;
}
.tracker-empty-icon {
width: 72px; height: 72px; border-radius: 18px;
background: linear-gradient(135deg, var(–bg2), var(–border));
display: flex; align-items: center; justify-content: center;
font-size: 32px; margin: 0 auto 20px;
}
.tracker-empty-title {
font-family: var(–font-display); font-size: 22px; font-weight: 800;
color: var(–ink); margin-bottom: 10px; letter-spacing: -0.01em;
}
.tracker-empty-sub { font-size: 14px; color: var(–muted); line-height: 1.6; margin-bottom: 28px; }
.tracker-empty-steps { display: flex; flex-direction: column; gap: 10px; text-align: left; margin-bottom: 24px; }
.tracker-empty-step {
display: flex; align-items: flex-start; gap: 12px;
background: var(–surface); border: 1px solid var(–border);
border-radius: 10px; padding: 12px 14px;
}
.tes-num {
width: 22px; height: 22px; border-radius: 50%;
background: #33B50C; color: #fff;
font-family: var(–font-display); font-size: 11px; font-weight: 800;
display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 1px;
}
.tes-text { font-size: 13px; color: var(–ink2); line-height: 1.4; }
.tes-text strong { color: var(–ink); display: block; margin-bottom: 2px; }
.tracker-demo-card {
background: linear-gradient(135deg, #f2fce9, #e6f4df);
border: 1.5px dashed #33B50C; border-radius: 12px;
padding: 16px 16px 12px; text-align: left; margin-bottom: 8px;
cursor: pointer; transition: all 0.18s; position: relative;
}
.tracker-demo-card:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(51,181,12,0.15); }
.tracker-demo-label {
position: absolute; top: -10px; left: 14px;
background: #33B50C; color: #fff; font-size: 9px; font-weight: 800;
letter-spacing: 0.08em; padding: 2px 8px; border-radius: 10px; text-transform: uppercase;
}
.tracker-demo-name { font-family: var(–font-display); font-size: 14px; font-weight: 700; color: var(–ink); margin-bottom: 3px; }
.tracker-demo-org { font-size: 12px; color: var(–muted); margin-bottom: 8px; }
.tracker-demo-footer { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }

/* ═══════════════════════════════════════════════════
RESPONSIVE — Mobile-First Breakpoints
═══════════════════════════════════════════════════ */

/* Mobile bottom tab bar */
.mobile-tab-bar {
display: none;
position: fixed;
bottom: 0; left: 0; right: 0;
background: #000;
border-top: 1px solid rgba(255,255,255,0.1);
z-index: 400;
padding: 0 0 env(safe-area-inset-bottom);
}
.mobile-tab-bar-inner {
display: flex;
align-items: stretch;
height: 56px;
}
.mobile-tab-btn {
flex: 1;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
gap: 3px;
background: none;
border: none;
cursor: pointer;
padding: 0;
color: rgba(255,255,255,0.45);
font-family: var(–font-body);
font-size: 10px;
font-weight: 500;
transition: color 0.15s;
-webkit-tap-highlight-color: transparent;
}
.mobile-tab-btn .tab-icon { font-size: 20px; line-height: 1; }
.mobile-tab-btn.active { color: #33B50C; }
.mobile-tab-btn:active { opacity: 0.7; }

/* Hamburger button */
.nav-hamburger {
display: none;
flex-direction: column;
gap: 5px;
padding: 8px;
background: none;
border: none;
cursor: pointer;
-webkit-tap-highlight-color: transparent;
border-radius: 6px;
transition: background 0.15s;
}
.nav-hamburger:active { background: rgba(255,255,255,0.1); }
.nav-hamburger span {
display: block;
width: 22px; height: 2px;
background: rgba(255,255,255,0.8);
border-radius: 2px;
transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
}
.nav-hamburger.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
.nav-hamburger.open span:nth-child(2) { opacity: 0; transform: scaleX(0); }
.nav-hamburger.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

/* Mobile drawer */
.mobile-drawer {
display: none;
position: fixed;
inset: 0;
z-index: 350;
pointer-events: none;
}
.mobile-drawer-backdrop {
position: absolute; inset: 0;
background: rgba(0,0,0,0.6);
opacity: 0;
transition: opacity 0.3s;
backdrop-filter: blur(4px);
}
.mobile-drawer-panel {
position: absolute;
top: 0; right: 0; bottom: 0;
width: min(320px, 88vw);
background: #0a0a0a;
border-left: 1px solid rgba(255,255,255,0.08);
transform: translateX(100%);
transition: transform 0.32s cubic-bezier(0.4,0,0.2,1);
overflow-y: auto;
padding-bottom: env(safe-area-inset-bottom);
}
.mobile-drawer.open { pointer-events: all; }
.mobile-drawer.open .mobile-drawer-backdrop { opacity: 1; }
.mobile-drawer.open .mobile-drawer-panel { transform: translateX(0); }

.mobile-drawer-header {
padding: 20px 20px 16px;
border-bottom: 1px solid rgba(255,255,255,0.07);
display: flex; align-items: center; justify-content: space-between;
}
.mobile-drawer-logo { font-family: var(–font-display); font-size: 18px; font-weight: 800; color: #fff; }
.mobile-drawer-logo span { color: #33B50C; }
.mobile-drawer-close {
width: 32px; height: 32px; border-radius: 6px;
background: rgba(255,255,255,0.06);
border: none; color: rgba(255,255,255,0.6);
cursor: pointer; font-size: 18px;
display: flex; align-items: center; justify-content: center;
-webkit-tap-highlight-color: transparent;
}
.mobile-drawer-user {
padding: 16px 20px;
border-bottom: 1px solid rgba(255,255,255,0.07);
display: flex; align-items: center; gap: 12px;
}
.mobile-drawer-avatar {
width: 40px; height: 40px; border-radius: 10px;
background: linear-gradient(135deg, #33B50C, #28920A);
display: flex; align-items: center; justify-content: center;
font-family: var(–font-display); font-weight: 800; font-size: 14px; color: #fff;
flex-shrink: 0;
}
.mobile-drawer-user-name { font-size: 14px; font-weight: 600; color: #fff; }
.mobile-drawer-user-type { font-size: 11px; color: rgba(255,255,255,0.4); margin-top: 2px; }

.drawer-nav-section { padding: 12px 12px 4px; }
.drawer-nav-label {
font-size: 10px; font-weight: 700; letter-spacing: 0.1em;
text-transform: uppercase; color: rgba(255,255,255,0.2);
padding: 0 8px; margin-bottom: 6px;
}
.drawer-nav-item {
display: flex; align-items: center; gap: 12px;
width: 100%; padding: 12px 12px;
border-radius: 8px;
background: none; border: none;
color: rgba(255,255,255,0.7); font-family: var(–font-body);
font-size: 14px; font-weight: 500;
cursor: pointer; text-align: left;
transition: background 0.1s, color 0.1s;
-webkit-tap-highlight-color: transparent;
}
.drawer-nav-item:hover, .drawer-nav-item:active { background: rgba(255,255,255,0.06); color: #fff; }
.drawer-nav-item .dni-icon { font-size: 18px; width: 24px; text-align: center; }
.drawer-nav-item.danger { color: rgba(220,80,60,0.8); }
.drawer-nav-item.danger:hover { background: rgba(220,80,60,0.08); color: #e05533; }

/* ── TABLET: 800px ── */
@media (max-width: 900px) {
.nav { padding: 0 20px; }
.container, .container-sm { padding: 0 20px; }
.nav-links { display: none; }
.nav-hamburger { display: flex; }
.mobile-drawer { display: block; }

/* Hero */
.hero { padding: 72px 0 56px; }
.hero-title { font-size: clamp(38px, 8vw, 56px); }
.hero-visual { display: none; }
.hero-trust { gap: 16px; flex-wrap: wrap; }
.trust-divider { display: none; }

/* How it works */
.steps-grid { grid-template-columns: 1fr 1fr; }

/* Landing sections */
.pain-grid { grid-template-columns: 1fr; }
.traction-metrics { grid-template-columns: 1fr 1fr; }

/* Directory */
.dir-body { flex-direction: column; }
.filters-panel { width: 100%; position: static; border-right: none; border-bottom: 1px solid var(–border); padding-bottom: 20px; }
.filters-scroll { display: flex; flex-wrap: wrap; flex-direction: row; gap: 16px; }
.filter-group { min-width: 140px; flex: 1; }

/* Detail */
.trust-grid { grid-template-columns: 1fr 1fr; }
.detail-header-inner { padding: 0 20px 28px; }
.detail-title { font-size: 28px; }
.detail-body { padding: 20px; gap: 20px; }
.apply-box { position: static; margin-top: 20px; }

/* Tracker */
.kanban { grid-template-columns: 1fr 1fr; gap: 12px; }

/* Profile */
.profile-grid { grid-template-columns: 1fr; }

/* Investor */
.inv-stats { flex-wrap: wrap; gap: 12px; }
.inv-stat { min-width: 140px; }

/* Forms */
.form-row, .form-row-3 { grid-template-columns: 1fr; }
.auth-modal, .submit-modal { margin: 12px; border-radius: 14px; }
.submit-modal-body { padding: 20px; }
.submit-modal-footer { padding: 16px 20px; }

/* Admin */
.admin-sidebar { width: 200px; }
.admin-kpi-row { grid-template-columns: 1fr 1fr 1fr; }
}

/* ── MOBILE: 600px ── */
@media (max-width: 600px) {
.nav { padding: 0 16px; height: 54px; }
.container, .container-sm { padding: 0 16px; }

/* Add bottom padding for tab bar */
.view { padding-bottom: 64px; }
.mobile-tab-bar { display: flex; }

/* Hero */
.hero { padding: 48px 0 40px; }
.hero-title { font-size: clamp(32px, 9vw, 48px); line-height: 1.08; }
.hero-sub { font-size: 15px; }
.hero-actions { flex-direction: column; gap: 10px; }
.hero-actions .btn { width: 100%; text-align: center; justify-content: center; }
.hero-eyebrow { font-size: 11px; }
.hero-trust { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.trust-stat { text-align: center; }
.trust-divider { display: none; }

/* Steps */
.steps-grid { grid-template-columns: 1fr; }
.step-card { padding: 20px 16px; }

/* Pain */
.pain-section { padding: 48px 0; }
.pain-grid { grid-template-columns: 1fr; gap: 12px; }

/* Traction */
.traction-metrics { grid-template-columns: 1fr 1fr; gap: 12px; }

/* Directory filters */
.dir-header { flex-direction: column; gap: 10px; align-items: stretch; }
.search-bar-wrap { width: 100%; }
.dir-controls { flex-wrap: wrap; gap: 8px; }
.filters-scroll { flex-direction: column; }
.filter-group { width: 100%; }

/* Opp cards */
.opp-card > div:first-of-type { padding: 14px 16px 10px; }

/* Kanban — horizontal scroll on mobile */
.kanban {
grid-template-columns: none;
display: flex;
overflow-x: auto;
gap: 12px;
padding-bottom: 12px;
-webkit-overflow-scrolling: touch;
scroll-snap-type: x mandatory;
}
.kanban-col {
min-width: 260px;
scroll-snap-align: start;
flex-shrink: 0;
}

/* Tracker header */
.tracker-header { flex-direction: column; gap: 12px; align-items: flex-start; }
.stats-row { grid-template-columns: 1fr 1fr; gap: 10px; }

/* Profile */
.profile-grid { grid-template-columns: 1fr; }
.profile-sidebar { position: static; }

/* Admin */
.admin-layout { flex-direction: column; }
.admin-sidebar {
width: 100%; height: auto;
position: static;
border-right: none;
border-bottom: 1px solid rgba(255,255,255,0.06);
padding: 16px 0;
}
.admin-sidebar-section { display: flex; flex-wrap: wrap; gap: 4px; padding: 0 12px; margin-bottom: 12px; }
.admin-sidebar-label { width: 100%; }
.admin-nav-item { padding: 6px 12px; font-size: 12px; }
.admin-kpi-row { grid-template-columns: 1fr 1fr; gap: 10px; }
.admin-main { padding: 16px; }

/* Detail */
.detail-title { font-size: 22px; }
.detail-badges { gap: 6px; }
.trust-grid { grid-template-columns: 1fr 1fr; }
.reviews-grid { grid-template-columns: 1fr; }

/* Modals */
.auth-modal { margin: 0; border-radius: 20px 20px 0 0; margin-top: auto; align-self: flex-end; width: 100%; max-width: 100%; }
.modal-overlay { align-items: flex-end; }
.submit-modal { margin: 0; border-radius: 20px 20px 0 0; max-height: 90vh; width: 100%; }
.submit-modal-body { max-height: 60vh; }
.reject-modal { margin: 0; border-radius: 20px 20px 0 0; width: 100%; }

/* Nav sign in */
.user-dropdown { right: -8px; min-width: 280px; }

/* Toast */
.toast { bottom: 76px; right: 12px; left: 12px; max-width: none; }
}

/* ── SMALL MOBILE: 380px ── */
@media (max-width: 380px) {
.hero-title { font-size: 30px; }
.hero-trust { grid-template-columns: 1fr; }
.traction-metrics { grid-template-columns: 1fr; }
.stats-row { grid-template-columns: 1fr; }
.admin-kpi-row { grid-template-columns: 1fr; }
.nav-logo { font-size: 17px; }
}

/* ═══════════════════════════════════════════════════
ADMIN PANEL — Dark Control Room Aesthetic
═══════════════════════════════════════════════════ */
#view-admin {
background: #0E0F11;
min-height: 100vh;
color: #E8E6E1;
font-family: var(–font-body);
}

.admin-layout {
display: flex;
min-height: calc(100vh - 60px);
}

/* Sidebar */
.admin-sidebar {
width: 220px;
flex-shrink: 0;
background: #0A0B0D;
border-right: 1px solid rgba(255,255,255,0.06);
padding: 28px 0;
position: sticky;
top: 60px;
height: calc(100vh - 60px);
overflow-y: auto;
}

.admin-sidebar-section {
margin-bottom: 28px;
padding: 0 16px;
}

.admin-sidebar-label {
font-family: var(–font-display);
font-size: 10px;
font-weight: 700;
letter-spacing: 0.14em;
text-transform: uppercase;
color: rgba(255,255,255,0.2);
margin-bottom: 8px;
padding-left: 8px;
}

.admin-nav-item {
display: flex;
align-items: center;
gap: 10px;
padding: 9px 12px;
border-radius: 8px;
cursor: pointer;
font-size: 13px;
font-weight: 500;
color: rgba(255,255,255,0.45);
transition: all 0.12s;
border: none;
background: none;
width: 100%;
text-align: left;
margin-bottom: 2px;
}
.admin-nav-item:hover { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.8); }
.admin-nav-item.active { background: rgba(255,255,255,0.08); color: #fff; }
.admin-nav-item .nav-icon { font-size: 15px; width: 20px; text-align: center; }
.admin-nav-badge {
margin-left: auto;
background: var(–accent);
color: #fff;
font-size: 10px;
font-weight: 700;
padding: 1px 6px;
border-radius: 10px;
font-family: var(–font-display);
}
.admin-nav-badge.gold { background: var(–gold); }
.admin-nav-badge.green { background: var(–accent2); }

/* Main content */
.admin-main {
flex: 1;
min-width: 0;
padding: 36px 40px;
}

/* Admin panels (tabs within admin) */
.admin-panel { display: none; }
.admin-panel.active { display: block; }

/* Admin page header */
.admin-page-header {
display: flex;
justify-content: space-between;
align-items: flex-start;
margin-bottom: 28px;
flex-wrap: wrap;
gap: 16px;
}
.admin-page-title {
font-family: var(–font-display);
font-size: 22px;
font-weight: 800;
color: #fff;
letter-spacing: -0.02em;
}
.admin-page-sub { font-size: 13px; color: rgba(255,255,255,0.35); margin-top: 4px; }

/* KPI row */
.admin-kpi-row {
display: grid;
grid-template-columns: repeat(5, 1fr);
gap: 12px;
margin-bottom: 32px;
}
.admin-kpi {
background: #161719;
border: 1px solid rgba(255,255,255,0.07);
border-radius: 10px;
padding: 18px 20px;
transition: border-color 0.15s;
}
.admin-kpi:hover { border-color: rgba(255,255,255,0.14); }
.admin-kpi-num {
font-family: var(–font-display);
font-size: 28px;
font-weight: 800;
color: #fff;
letter-spacing: -0.02em;
line-height: 1;
}
.admin-kpi-label { font-size: 11px; color: rgba(255,255,255,0.35); margin-top: 6px; }
.admin-kpi-delta { font-size: 11px; font-weight: 600; margin-top: 4px; }
.admin-kpi-delta.up { color: #33B50C; }
.admin-kpi-delta.warn { color: var(–gold); }
.admin-kpi-delta.down { color: var(–accent); }

/* Submission review queue */
.admin-queue-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 16px;
flex-wrap: wrap;
gap: 12px;
}
.admin-queue-title {
font-family: var(–font-display);
font-size: 14px;
font-weight: 700;
color: #fff;
}
.admin-filter-pills { display: flex; gap: 6px; flex-wrap: wrap; }
.admin-filter-pill {
padding: 4px 12px;
border-radius: 20px;
font-size: 11px;
font-weight: 600;
border: 1px solid rgba(255,255,255,0.1);
color: rgba(255,255,255,0.4);
cursor: pointer;
background: none;
transition: all 0.12s;
font-family: var(–font-display);
letter-spacing: 0.03em;
}
.admin-filter-pill:hover { border-color: rgba(255,255,255,0.25); color: rgba(255,255,255,0.7); }
.admin-filter-pill.active { border-color: rgba(255,255,255,0.5); color: #fff; background: rgba(255,255,255,0.08); }

/* Review card */
.review-queue-card {
background: #161719;
border: 1px solid rgba(255,255,255,0.07);
border-radius: 12px;
padding: 22px 24px;
margin-bottom: 10px;
transition: border-color 0.15s;
animation: fadeInCard 0.25s ease both;
}
.review-queue-card:hover { border-color: rgba(255,255,255,0.14); }

@keyframes fadeInCard {
from { opacity: 0; transform: translateY(6px); }
to { opacity: 1; transform: translateY(0); }
}

.rqc-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 16px; margin-bottom: 12px; flex-wrap: wrap; }
.rqc-left { flex: 1; min-width: 0; }
.rqc-name { font-family: var(–font-display); font-weight: 700; font-size: 15px; color: #fff; margin-bottom: 3px; }
.rqc-org { font-size: 12px; color: rgba(255,255,255,0.4); }
.rqc-right { display: flex; align-items: center; gap: 10px; flex-shrink: 0; }

.rqc-meta { display: flex; gap: 16px; margin-bottom: 12px; flex-wrap: wrap; }
.rqc-meta-item { font-size: 12px; color: rgba(255,255,255,0.35); display: flex; align-items: center; gap: 5px; }
.rqc-meta-item strong { color: rgba(255,255,255,0.65); }

.rqc-desc { font-size: 13px; color: rgba(255,255,255,0.45); line-height: 1.6; margin-bottom: 14px; border-left: 2px solid rgba(255,255,255,0.08); padding-left: 12px; }

.rqc-eligibility { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 14px; }
.rqc-elig-chip {
font-size: 11px;
padding: 3px 8px;
border-radius: 4px;
display: flex; align-items: center; gap: 4px;
}
.rqc-elig-chip.ok { background: rgba(42,107,74,0.15); color: #4ade80; border: 1px solid rgba(42,107,74,0.2); }
.rqc-elig-chip.no { background: rgba(51,181,12,0.12); color: #f87171; border: 1px solid rgba(51,181,12,0.2); }

.rqc-submitter {
display: flex;
align-items: center;
gap: 8px;
font-size: 12px;
color: rgba(255,255,255,0.3);
padding-top: 12px;
border-top: 1px solid rgba(255,255,255,0.05);
flex-wrap: wrap;
}

/* Action buttons */
.action-btn {
display: inline-flex;
align-items: center;
gap: 6px;
font-family: var(–font-display);
font-size: 12px;
font-weight: 600;
padding: 7px 14px;
border-radius: 6px;
border: none;
cursor: pointer;
transition: all 0.12s;
letter-spacing: 0.02em;
}
.action-btn-approve { background: rgba(42,107,74,0.2); color: #4ade80; border: 1px solid rgba(42,107,74,0.3); }
.action-btn-approve:hover { background: rgba(42,107,74,0.35); transform: translateY(-1px); }
.action-btn-reject { background: rgba(51,181,12,0.15); color: #f87171; border: 1px solid rgba(51,181,12,0.25); }
.action-btn-reject:hover { background: rgba(51,181,12,0.28); transform: translateY(-1px); }
.action-btn-flag { background: rgba(184,134,11,0.12); color: #fbbf24; border: 1px solid rgba(184,134,11,0.2); }
.action-btn-flag:hover { background: rgba(184,134,11,0.22); transform: translateY(-1px); }
.action-btn-view { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.6); border: 1px solid rgba(255,255,255,0.1); }
.action-btn-view:hover { background: rgba(255,255,255,0.1); color: #fff; }

/* Admin badge */
.admin-status-badge {
display: inline-flex;
align-items: center;
gap: 5px;
font-family: var(–font-display);
font-size: 10px;
font-weight: 700;
letter-spacing: 0.06em;
text-transform: uppercase;
padding: 3px 8px;
border-radius: 4px;
}
.asb-pending { background: rgba(184,134,11,0.15); color: #fbbf24; border: 1px solid rgba(184,134,11,0.2); }
.asb-live { background: rgba(42,107,74,0.15); color: #4ade80; border: 1px solid rgba(42,107,74,0.2); }
.asb-rejected { background: rgba(51,181,12,0.12); color: #f87171; border: 1px solid rgba(51,181,12,0.2); }
.asb-flagged { background: rgba(239,68,68,0.15); color: #fca5a5; border: 1px solid rgba(239,68,68,0.25); }

/* Users table */
.admin-table {
width: 100%;
border-collapse: collapse;
font-size: 13px;
}
.admin-table th {
text-align: left;
font-family: var(–font-display);
font-size: 10px;
font-weight: 700;
letter-spacing: 0.1em;
text-transform: uppercase;
color: rgba(255,255,255,0.25);
padding: 10px 14px;
border-bottom: 1px solid rgba(255,255,255,0.06);
}
.admin-table td {
padding: 14px;
border-bottom: 1px solid rgba(255,255,255,0.04);
color: rgba(255,255,255,0.6);
vertical-align: middle;
}
.admin-table tr:hover td { background: rgba(255,255,255,0.02); }
.admin-table .td-name { color: #fff; font-weight: 500; }
.admin-table .td-type-badge {
display: inline-flex;
align-items: center;
gap: 4px;
font-size: 11px;
font-weight: 600;
padding: 2px 8px;
border-radius: 4px;
}
.td-type-founder { background: rgba(42,107,74,0.12); color: #4ade80; }
.td-type-investor { background: rgba(30,79,168,0.15); color: #93c5fd; }
.td-type-admin { background: rgba(51,181,12,0.15); color: #fca5a5; }

/* Activity feed */
.activity-feed { display: flex; flex-direction: column; gap: 0; }
.activity-item {
display: flex;
gap: 14px;
align-items: flex-start;
padding: 14px 0;
border-bottom: 1px solid rgba(255,255,255,0.04);
}
.activity-item:last-child { border-bottom: none; }
.activity-dot {
width: 28px;
height: 28px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-size: 12px;
flex-shrink: 0;
margin-top: 2px;
}
.ad-green { background: rgba(42,107,74,0.2); }
.ad-red { background: rgba(51,181,12,0.15); }
.ad-gold { background: rgba(184,134,11,0.15); }
.ad-blue { background: rgba(30,79,168,0.15); }
.activity-content { flex: 1; }
.activity-text { font-size: 13px; color: rgba(255,255,255,0.6); line-height: 1.5; }
.activity-text strong { color: rgba(255,255,255,0.85); }
.activity-time { font-size: 11px; color: rgba(255,255,255,0.2); margin-top: 3px; }

/* Rejection modal */
.reject-modal {
background: #161719;
border: 1px solid rgba(255,255,255,0.1);
border-radius: 16px;
width: 100%;
max-width: 440px;
margin: 20px;
box-shadow: 0 24px 80px rgba(0,0,0,0.7);
transform: translateY(20px) scale(0.97);
transition: transform 0.25s ease;
overflow: hidden;
}
.modal-overlay.open .reject-modal { transform: translateY(0) scale(1); }
.reject-modal-header { padding: 24px 28px 0; }
.reject-modal-header h3 { font-family: var(–font-display); font-size: 18px; font-weight: 800; color: #fff; margin-bottom: 6px; }
.reject-modal-header p { font-size: 13px; color: rgba(255,255,255,0.4); }
.reject-modal-body { padding: 20px 28px; }
.reject-reason-btn {
display: block;
width: 100%;
text-align: left;
padding: 12px 14px;
border-radius: 8px;
font-size: 13px;
color: rgba(255,255,255,0.6);
background: rgba(255,255,255,0.04);
border: 1px solid rgba(255,255,255,0.06);
cursor: pointer;
margin-bottom: 8px;
transition: all 0.12s;
}
.reject-reason-btn:hover { background: rgba(255,255,255,0.08); color: #fff; border-color: rgba(255,255,255,0.12); }
.reject-reason-btn.selected { background: rgba(51,181,12,0.15); color: #f87171; border-color: rgba(51,181,12,0.3); }
.reject-modal-footer { padding: 16px 28px 24px; display: flex; gap: 10px; justify-content: flex-end; }

/* Admin empty state */
.admin-empty {
text-align: center;
padding: 60px 20px;
}
.admin-empty-icon { font-size: 44px; margin-bottom: 16px; opacity: 0.3; }
.admin-empty h3 { font-family: var(–font-display); font-size: 18px; color: rgba(255,255,255,0.5); margin-bottom: 8px; }
.admin-empty p { font-size: 13px; color: rgba(255,255,255,0.25); }

/* Admin search */
.admin-search {
background: rgba(255,255,255,0.05);
border: 1px solid rgba(255,255,255,0.08);
border-radius: 8px;
padding: 9px 14px;
font-family: var(–font-body);
font-size: 13px;
color: #fff;
outline: none;
width: 240px;
transition: border-color 0.15s;
}
.admin-search::placeholder { color: rgba(255,255,255,0.25); }
.admin-search:focus { border-color: rgba(255,255,255,0.2); background: rgba(255,255,255,0.07); }

/* Scrollable table wrapper */
.admin-table-wrap {
background: #161719;
border: 1px solid rgba(255,255,255,0.07);
border-radius: 12px;
overflow: hidden;
}

/* Section cards */
.admin-card {
background: #161719;
border: 1px solid rgba(255,255,255,0.07);
border-radius: 12px;
overflow: hidden;
margin-bottom: 20px;
}
.admin-card-header {
padding: 16px 20px;
border-bottom: 1px solid rgba(255,255,255,0.06);
display: flex;
justify-content: space-between;
align-items: center;
}
.admin-card-title { font-family: var(–font-display); font-size: 13px; font-weight: 700; color: rgba(255,255,255,0.6); letter-spacing: 0.04em; }
.admin-card-body { padding: 20px; }

/* Nav admin indicator */
.nav-admin-badge {
display: inline-block;
background: var(–accent);
color: #fff;
font-size: 9px;
font-weight: 800;
padding: 1px 5px;
border-radius: 3px;
vertical-align: middle;
margin-left: 4px;
letter-spacing: 0.05em;
font-family: var(–font-display);
}
</style>

</head>
<body>

<!-- ══ TOAST ══ -->

<div class="toast" id="toast"></div>

<!-- ══ AUTH MODAL ══ -->

<div class="modal-overlay" id="authModal">
  <div class="auth-modal" style="position:relative">
    <button class="auth-modal-close" onclick="closeModal('authModal')">✕</button>
    <div class="auth-modal-header">
      <div class="auth-modal-logo">Cap<span>Stack</span></div>
      <div class="auth-tabs">
        <button class="auth-tab active" id="tab-signin" onclick="switchAuthTab('signin')">Sign In</button>
        <button class="auth-tab" id="tab-signup" onclick="switchAuthTab('signup')">Sign Up</button>
      </div>
    </div>
    <div class="auth-modal-body">

```
  <!-- SIGN IN FORM -->
  <div class="auth-form active" id="form-signin">
    <button class="google-btn" id="google-signin-btn" onclick="handleGoogleAuth('signin')">
      <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 002.38-5.88c0-.57-.05-.66-.15-1.18z"/><path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 01-7.18-2.54H1.83v2.07A8 8 0 008.98 17z"/><path fill="#FBBC05" d="M4.5 10.52a4.8 4.8 0 010-3.04V5.41H1.83a8 8 0 000 7.18l2.67-2.07z"/><path fill="#EA4335" d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 001.83 5.4L4.5 7.49a4.77 4.77 0 014.48-3.3z"/></svg>
      <span class="google-btn-text">Continue with Google</span>
    </button>
    <div class="auth-divider"><div class="auth-divider-line"></div><div class="auth-divider-text">or</div><div class="auth-divider-line"></div></div>
    <div class="form-field">
      <label class="form-label">Email address</label>
      <input class="form-input" type="email" id="signin-email" placeholder="you@example.com">
      <div class="form-error" id="signin-email-error">Please enter a valid email</div>
    </div>
    <div class="form-field">
      <label class="form-label">Password</label>
      <input class="form-input" type="password" id="signin-password" placeholder="••••••••">
      <div class="form-error" id="signin-error">Incorrect email or password</div>
    </div>
    <button class="btn btn-primary auth-submit" onclick="handleSignIn()">Sign In →</button>
    <div class="auth-switch">Don't have an account? <a onclick="switchAuthTab('signup')">Sign up free</a></div>
  </div>

  <!-- SIGN UP FORM -->
  <div class="auth-form" id="form-signup">
    <div class="form-field">
      <label class="form-label">I am a...</label>
      <div class="user-type-selector">
        <div class="user-type-btn founder selected" id="type-founder" onclick="selectUserType('founder')">
          <div class="user-type-icon">🚀</div>
          <div class="user-type-label">Founder</div>
          <div class="user-type-sub">Find & track funding</div>
        </div>
        <div class="user-type-btn investor" id="type-investor" onclick="selectUserType('investor')">
          <div class="user-type-icon">🏦</div>
          <div class="user-type-label">Investor / Funder</div>
          <div class="user-type-sub">Submit opportunities</div>
        </div>
      </div>
    </div>
    <button class="google-btn" id="google-signup-btn" onclick="handleGoogleAuth('signup')">
      <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 002.38-5.88c0-.57-.05-.66-.15-1.18z"/><path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 01-7.18-2.54H1.83v2.07A8 8 0 008.98 17z"/><path fill="#FBBC05" d="M4.5 10.52a4.8 4.8 0 010-3.04V5.41H1.83a8 8 0 000 7.18l2.67-2.07z"/><path fill="#EA4335" d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 001.83 5.4L4.5 7.49a4.77 4.77 0 014.48-3.3z"/></svg>
      <span class="google-btn-text">Continue with Google</span>
    </button>
    <div class="auth-divider"><div class="auth-divider-line"></div><div class="auth-divider-text">or</div><div class="auth-divider-line"></div></div>
    <div class="form-row">
      <div class="form-field">
        <label class="form-label">First name</label>
        <input class="form-input" type="text" id="signup-fname" placeholder="Jane">
      </div>
      <div class="form-field">
        <label class="form-label">Last name</label>
        <input class="form-input" type="text" id="signup-lname" placeholder="Smith">
      </div>
    </div>
    <div class="form-field">
      <label class="form-label">Email address</label>
      <input class="form-input" type="email" id="signup-email" placeholder="you@example.com">
      <div class="form-error" id="signup-email-error">Please enter a valid email</div>
    </div>
    <div class="form-field">
      <label class="form-label">Password</label>
      <input class="form-input" type="password" id="signup-password" placeholder="Min. 8 characters">
      <div class="form-error" id="signup-pass-error">Password must be at least 8 characters</div>
    </div>
    <div class="form-error" id="signup-exists-error">An account with this email already exists</div>
    <button class="btn btn-primary auth-submit" onclick="handleSignUp()">Create Account →</button>
    <div class="auth-switch">Already have an account? <a onclick="switchAuthTab('signin')">Sign in</a></div>
  </div>

</div>
```

  </div>
</div>

<!-- ══ SUBMIT OPPORTUNITY MODAL ══ -->

<div class="modal-overlay" id="submitModal">
  <div class="submit-modal">
    <div class="submit-modal-header">
      <div>
        <h2>Submit an Opportunity</h2>
        <p>We'll review your submission within 48 hours before it goes live.</p>
      </div>
      <button class="auth-modal-close" style="position:static;margin-left:16px" onclick="closeModal('submitModal')">✕</button>
    </div>
    <div class="submit-modal-body">

```
  <!-- Basic Info -->
  <div class="form-section-title">Programme Details</div>
  <div class="form-row">
    <div class="form-field">
      <label class="form-label">Organisation Name *</label>
      <input class="form-input" id="sub-org" placeholder="e.g. European Innovation Council">
    </div>
    <div class="form-field">
      <label class="form-label">Programme Name *</label>
      <input class="form-input" id="sub-name" placeholder="e.g. EIC Accelerator 2027">
    </div>
  </div>
  <div class="form-row">
    <div class="form-field">
      <label class="form-label">Funding Type *</label>
      <select class="form-select" id="sub-type">
        <option value="">Select type...</option>
        <option>Accelerator</option>
        <option>Government Grant</option>
        <option>VC / Angel</option>
        <option>Foundation</option>
        <option>Competition</option>
        <option>Fellowship</option>
        <option>Loan / Revenue Share</option>
      </select>
    </div>
    <div class="form-field">
      <label class="form-label">Geography *</label>
      <select class="form-select" id="sub-geo">
        <option value="">Select geography...</option>
        <option>Global</option>
        <option>USA</option>
        <option>Europe</option>
        <option>UK</option>
        <option>Asia</option>
        <option>Africa</option>
        <option>Latin America</option>
        <option>Middle East</option>
      </select>
    </div>
  </div>
  <div class="form-row">
    <div class="form-field">
      <label class="form-label">Funding Amount *</label>
      <input class="form-input" id="sub-amount" placeholder="e.g. Up to €2.5M or $50K–$500K">
    </div>
    <div class="form-field">
      <label class="form-label">Application Deadline *</label>
      <input class="form-input" type="date" id="sub-deadline">
    </div>
  </div>
  <div class="form-field">
    <label class="form-label">Application URL *</label>
    <input class="form-input" id="sub-url" placeholder="https://...">
  </div>

  <!-- Stage -->
  <div class="form-field" style="margin-top:8px">
    <label class="form-label">Eligible Stages *</label>
    <div class="stage-chips" id="stageChips">
      <div class="stage-chip selected" data-stage="Pre-seed" onclick="toggleStage(this)">Pre-seed</div>
      <div class="stage-chip selected" data-stage="Seed" onclick="toggleStage(this)">Seed</div>
      <div class="stage-chip" data-stage="Series A" onclick="toggleStage(this)">Series A</div>
      <div class="stage-chip" data-stage="Series B+" onclick="toggleStage(this)">Series B+</div>
      <div class="stage-chip" data-stage="Any" onclick="toggleStage(this)">Any stage</div>
    </div>
  </div>

  <!-- Descriptions -->
  <div class="form-section-title" style="margin-top:28px">Description</div>
  <div class="form-field">
    <label class="form-label">Short Description * <span style="font-weight:400;color:var(--muted)">(shown in directory listing)</span></label>
    <textarea class="form-textarea" id="sub-short-desc" placeholder="One compelling paragraph — what is this, and why should founders care?" maxlength="280" oninput="updateCharCount(this,'short-counter',280)" style="min-height:70px"></textarea>
    <div class="char-counter" id="short-counter">0 / 280</div>
  </div>
  <div class="form-field">
    <label class="form-label">Full Description</label>
    <textarea class="form-textarea" id="sub-full-desc" placeholder="Detailed description, process, timeline, what makes this opportunity unique..." style="min-height:120px"></textarea>
  </div>

  <!-- Eligibility -->
  <div class="form-section-title" style="margin-top:28px">Eligibility Criteria</div>
  <p style="font-size:13px;color:var(--muted);margin-bottom:16px">Add criteria with ✓ for requirements and ✗ for exclusions. This helps founders quickly self-qualify.</p>
  <div class="elig-builder" id="eligBuilder"></div>
  <button class="btn btn-ghost btn-sm" style="margin-top:10px" onclick="addEligRow()">+ Add Criterion</button>

  <!-- Optional -->
  <div class="form-section-title" style="margin-top:28px">Contact & Discovery (Optional)</div>
  <div class="form-row">
    <div class="form-field">
      <label class="form-label">Contact Email</label>
      <input class="form-input" id="sub-contact" placeholder="applications@yourorg.com">
    </div>
    <div class="form-field">
      <label class="form-label">Organisation Website</label>
      <input class="form-input" id="sub-website" placeholder="https://yourorg.com">
    </div>
  </div>
  <div class="form-field">
    <label class="form-label">Tags <span style="font-weight:400;color:var(--muted)">(comma-separated)</span></label>
    <input class="form-input" id="sub-tags" placeholder="e.g. Deep Tech, Climate, Non-dilutive">
  </div>

  <div id="submit-form-error" class="form-error" style="margin-top:12px;font-size:13px">Please fill in all required fields.</div>

</div>
<div class="submit-modal-footer">
  <button class="btn btn-ghost" onclick="closeModal('submitModal')">Cancel</button>
  <button class="btn btn-blue" onclick="handleSubmitOpportunity()">Submit for Review →</button>
</div>
```

  </div>
</div>

<!-- ══════════════ NAVBAR ══════════════ -->

<nav class="nav" id="mainNav">
  <div class="nav-logo" onclick="showView('landing')">Cap<span>Stack</span></div>
  <div class="nav-links">
    <button class="nav-link" id="nav-directory" onclick="showView('directory')">Opportunities</button>
    <button class="nav-link hidden" id="nav-profile" onclick="showView('profile')">My Profile</button>
    <button class="nav-link hidden" id="nav-tracker" onclick="showView('tracker')">Tracker</button>
    <button class="nav-link hidden" id="nav-investor" onclick="showView('investor')">Dashboard</button>
    <button class="nav-link hidden" id="nav-admin" onclick="showView('admin')" style="color:var(--accent)">⚡ Admin<span class="nav-admin-badge">SUPER</span></button>
  </div>
  <div id="nav-right" style="display:flex;align-items:center;gap:10px">
    <button class="nav-auth-btn" id="nav-signin-btn" onclick="openModal('authModal')">Sign In →</button>
    <div class="user-menu hidden" id="user-menu">
      <button class="user-avatar" id="user-avatar-btn" onclick="toggleUserMenu()">
        <span class="user-avatar-initials" id="user-avatar-initials"></span>
        <span class="user-avatar-name" id="user-avatar-name"></span>
        <span class="user-avatar-chevron">▾</span>
      </button>
      <div class="user-dropdown" id="user-dropdown">
        <div class="dropdown-header">
          <div class="dropdown-avatar-large" id="dropdown-avatar-large"></div>
          <div class="dropdown-header-text">
            <div class="dropdown-name" id="dropdown-name"></div>
            <div class="dropdown-email" id="dropdown-email"></div>
            <span class="dropdown-type" id="dropdown-type"></span>
          </div>
        </div>
        <div class="dropdown-section">
          <button class="dropdown-item" id="dropdown-nav-profile" onclick="showView('profile');toggleUserMenu()">
            <span class="di-icon">📋</span><span class="di-label">My Profile</span>
          </button>
          <button class="dropdown-item" id="dropdown-nav-tracker" onclick="showView('tracker');toggleUserMenu()">
            <span class="di-icon">📊</span><span class="di-label">Application Tracker</span>
          </button>
          <button class="dropdown-item" id="dropdown-nav-investor" onclick="showView('investor');toggleUserMenu()" style="display:none">
            <span class="di-icon">🏦</span><span class="di-label">Investor Dashboard</span>
          </button>
          <button class="dropdown-item" id="dropdown-nav-admin" onclick="showView('admin');toggleUserMenu()" style="display:none">
            <span class="di-icon">⚡</span><span class="di-label">Admin Panel</span><span class="di-badge">SUPER</span>
          </button>
        </div>
        <div class="dropdown-section">
          <button class="dropdown-item" onclick="showView('directory');toggleUserMenu()">
            <span class="di-icon">🔍</span><span class="di-label">Browse Opportunities</span>
          </button>
          <button class="dropdown-item" onclick="showToast('Settings coming soon');toggleUserMenu()">
            <span class="di-icon">⚙️</span><span class="di-label">Settings</span>
          </button>
        </div>
        <div class="dropdown-section">
          <button class="dropdown-item danger" onclick="handleLogout()">
            <span class="di-icon">→</span><span class="di-label">Sign Out</span>
          </button>
        </div>
      </div>
    </div>
    <button class="nav-hamburger" id="nav-hamburger" onclick="toggleMobileDrawer()" aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
  </div>
</nav>

<!-- ══════════════ MOBILE DRAWER ══════════════ -->

<div class="mobile-drawer" id="mobile-drawer">
  <div class="mobile-drawer-backdrop" onclick="closeMobileDrawer()"></div>
  <div class="mobile-drawer-panel">
    <div class="mobile-drawer-header">
      <div class="mobile-drawer-logo">Cap<span>Stack</span></div>
      <button class="mobile-drawer-close" onclick="closeMobileDrawer()">✕</button>
    </div>
    <div class="mobile-drawer-user hidden" id="mobile-drawer-user">
      <div class="mobile-drawer-avatar" id="mobile-drawer-avatar"></div>
      <div>
        <div class="mobile-drawer-user-name" id="mobile-drawer-name"></div>
        <div class="mobile-drawer-user-type" id="mobile-drawer-type"></div>
      </div>
    </div>
    <div class="drawer-nav-section">
      <div class="drawer-nav-label">Explore</div>
      <button class="drawer-nav-item" onclick="showView('directory');closeMobileDrawer()"><span class="dni-icon">🔍</span>Browse Opportunities</button>
      <button class="drawer-nav-item" onclick="showView('landing');closeMobileDrawer()"><span class="dni-icon">🏠</span>Home</button>
    </div>
    <div class="drawer-nav-section" id="drawer-founder-section" style="display:none">
      <div class="drawer-nav-label">Founder</div>
      <button class="drawer-nav-item" onclick="showView('profile');closeMobileDrawer()"><span class="dni-icon">📋</span>My Profile</button>
      <button class="drawer-nav-item" onclick="showView('tracker');closeMobileDrawer()"><span class="dni-icon">📊</span>Application Tracker</button>
    </div>
    <div class="drawer-nav-section" id="drawer-investor-section" style="display:none">
      <div class="drawer-nav-label">Investor</div>
      <button class="drawer-nav-item" onclick="showView('investor');closeMobileDrawer()"><span class="dni-icon">🏦</span>Investor Dashboard</button>
    </div>
    <div class="drawer-nav-section" id="drawer-admin-section" style="display:none">
      <div class="drawer-nav-label">Admin</div>
      <button class="drawer-nav-item" onclick="showView('admin');closeMobileDrawer()"><span class="dni-icon">⚡</span>Admin Panel</button>
    </div>
    <div class="drawer-nav-section" id="drawer-auth-section">
      <div class="drawer-nav-label">Account</div>
      <button class="drawer-nav-item" id="drawer-signin-btn" onclick="openModal('authModal');closeMobileDrawer()"><span class="dni-icon">→</span>Sign In / Sign Up</button>
      <button class="drawer-nav-item danger hidden" id="drawer-signout-btn" onclick="handleLogout();closeMobileDrawer()"><span class="dni-icon">←</span>Sign Out</button>
    </div>
  </div>
</div>

<!-- ══════════════ MOBILE TAB BAR ══════════════ -->

<div class="mobile-tab-bar" id="mobile-tab-bar">
  <div class="mobile-tab-bar-inner">
    <button class="mobile-tab-btn active" id="tab-home" onclick="showView('landing');setActiveTab('home')">
      <span class="tab-icon">🏠</span><span>Home</span>
    </button>
    <button class="mobile-tab-btn" id="tab-directory" onclick="showView('directory');setActiveTab('directory')">
      <span class="tab-icon">🔍</span><span>Browse</span>
    </button>
    <button class="mobile-tab-btn" id="tab-tracker" onclick="handleTrackerTab()">
      <span class="tab-icon">📊</span><span>Tracker</span>
    </button>
    <button class="mobile-tab-btn" id="tab-profile" onclick="handleProfileTab()">
      <span class="tab-icon">👤</span><span>Profile</span>
    </button>
  </div>
</div>

<!-- ═══════════════════════════════════
     VIEW: LANDING
═══════════════════════════════════ -->

<div class="view active" id="view-landing">
  <section class="hero">
    <div class="container" style="position:relative">
      <div class="hero-eyebrow"><span>✦</span><span>2,400+ verified opportunities</span></div>
      <h1 class="hero-title">Stop wasting time.<br>Start <em>finding</em> real funding.</h1>
      <p class="hero-sub">The only funding aggregator built around trust. Every opportunity is verified, dated, and reviewed by founders who've been there.</p>
      <div class="hero-actions">
        <button class="btn btn-primary btn-lg" onclick="showView('directory')">Browse Opportunities →</button>
        <button class="btn btn-secondary btn-lg" onclick="openModal('authModal')">Create Free Account</button>
      </div>
      <div class="hero-trust">
        <div class="trust-stat"><span class="trust-num">2,400+</span><span class="trust-label">Verified opportunities</span></div>
        <div class="trust-divider"></div>
        <div class="trust-stat"><span class="trust-num">94%</span><span class="trust-label">Active & up-to-date</span></div>
        <div class="trust-divider"></div>
        <div class="trust-stat"><span class="trust-num">8h</span><span class="trust-label">Saved per founder / week</span></div>
        <div class="trust-divider"></div>
        <div class="trust-stat"><span class="trust-num">12K+</span><span class="trust-label">Founders using CapStack</span></div>
      </div>
      <div class="hero-visual">
        <div class="mini-card">
          <div class="mini-card-header"><div><div class="mini-card-name">Horizon Europe — EIC Accelerator</div><div class="mini-card-org">European Innovation Council</div></div><div class="mini-card-amount">€2.5M</div></div>
          <div class="mini-card-footer"><span class="badge badge-active">● Active</span><span class="tag">Deep Tech</span><span class="tag">EU</span></div>
        </div>
        <div class="mini-card">
          <div class="mini-card-header"><div><div class="mini-card-name">Y Combinator W26</div><div class="mini-card-org">Y Combinator</div></div><div class="mini-card-amount">$500K</div></div>
          <div class="mini-card-footer"><span class="badge badge-active">● Active</span><span class="tag">Accelerator</span><span class="tag">Global</span></div>
        </div>
        <div class="mini-card">
          <div class="mini-card-header"><div><div class="mini-card-name">SBIR Phase I Grant</div><div class="mini-card-org">US Department of Commerce</div></div><div class="mini-card-amount">$275K</div></div>
          <div class="mini-card-footer"><span class="badge badge-active">● Active</span><span class="tag">Government</span><span class="tag">USA</span></div>
        </div>
      </div>
    </div>
  </section>

  <section class="pain-section">
    <div class="container">
      <div class="section-label">The Problem We're Solving</div>
      <h2 class="section-title">Founders lose weeks.<br>Not hours — weeks.</h2>
      <div class="pain-grid">
        <div class="pain-card"><span class="pain-icon">🕳️</span><div class="pain-title">The Legitimacy Black Hole</div><div class="pain-desc">You spend 3 hours researching a grant, write the application, then discover it's invite-only. Or it closed two years ago. Or it never existed properly at all.</div><div class="pain-quote">"I applied to something I spent a week on. Turned out it was a dead programme." — Maya, SaaS Founder</div></div>
        <div class="pain-card"><span class="pain-icon">🔄</span><div class="pain-title">The Re-entry Trap</div><div class="pain-desc">Every application is a fresh copy-paste marathon. Company description. Team bios. Revenue metrics. Pitch summary. Over and over, for every programme you apply to.</div><div class="pain-quote">"I've written my company description 40 times this year. It's demoralising." — Tom, Fintech Founder</div></div>
        <div class="pain-card"><span class="pain-icon">🗂️</span><div class="pain-title">The Spreadsheet Chaos</div><div class="pain-desc">Tracking 10+ applications across bookmarks, email threads, and a spreadsheet that's already out of date. Deadlines get missed. Follow-ups fall through the cracks.</div><div class="pain-quote">"I genuinely forgot I'd applied to one accelerator. Found the rejection email 3 months later." — Priya, Deep Tech Founder</div></div>
      </div>
    </div>
  </section>

  <section class="how-it-works">
    <div class="container">
      <div class="section-label">How CapStack Works</div>
      <h2 class="section-title">Research once. Apply faster.</h2>
      <div class="steps-grid">
        <div class="step-card"><div class="step-num">01</div><span class="step-icon">📋</span><div class="step-title">Build your profile once</div><div class="step-desc">Enter your startup details, team, traction, and pitch. It lives here permanently and powers everything else.</div></div>
        <div class="step-card"><div class="step-num">02</div><span class="step-icon">🔍</span><div class="step-title">Discover verified opportunities</div><div class="step-desc">Search 2,400+ opportunities filtered to your stage, sector, and geography. Every listing is verified and dated.</div></div>
        <div class="step-card"><div class="step-num">03</div><span class="step-icon">✅</span><div class="step-title">Trust the signal</div><div class="step-desc">See verification badges, last-checked dates, and founder reviews before investing a single minute in an application.</div></div>
        <div class="step-card"><div class="step-num">04</div><span class="step-icon">📬</span><div class="step-title">Apply with pre-filled data</div><div class="step-desc">Click Apply and your profile data auto-populates the form. Track applications in one dashboard with deadline alerts.</div></div>
      </div>
    </div>
  </section>

  <section class="cta-banner">
    <div class="container">
      <div class="cta-inner">
        <h2>Stop researching. Start applying.</h2>
        <p>Join 12,000+ founders who use CapStack to cut their funding research time by 8 hours a week.</p>
        <div class="cta-btns">
          <button class="btn btn-primary btn-lg" onclick="openModal('authModal')">Create Free Account →</button>
          <button class="btn btn-ghost btn-lg" onclick="showView('directory')">Browse Opportunities</button>
        </div>
      </div>
    </div>
  </section>

  <div class="footer-nav"><div class="footer-logo">Cap<span>Stack</span></div><div class="footer-text">© 2026 CapStack · Find. Verify. Apply.</div></div>
</div>

<!-- ═══════════════════════════════════
     VIEW: DIRECTORY
═══════════════════════════════════ -->

<div class="view" id="view-directory">
  <div class="dir-header">
    <div class="container">
      <h1>Find Funding</h1>
      <div class="dir-search-row">
        <div class="search-box"><span class="search-icon">🔍</span><input type="text" placeholder="Search by name, organisation, keyword..." id="searchInput" oninput="filterOpps()"></div>
        <button class="btn btn-primary btn-sm" onclick="showView('profile')">✦ Match to my profile</button>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="dir-body">
      <aside class="filters-panel">
        <div class="filter-section">
          <div class="filter-title">Status</div>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Active <span class="filter-count">1,842</span></label>
          <label class="filter-option"><input type="checkbox" onchange="filterOpps()"> Closing soon <span class="filter-count">94</span></label>
          <label class="filter-option"><input type="checkbox" onchange="filterOpps()"> Closed <span class="filter-count">386</span></label>
        </div>
        <div class="filter-section">
          <div class="filter-title">Type</div>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Accelerator <span class="filter-count">412</span></label>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Government Grant <span class="filter-count">634</span></label>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> VC / Angel <span class="filter-count">548</span></label>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Foundation <span class="filter-count">219</span></label>
        </div>
        <div class="filter-section">
          <div class="filter-title">Stage</div>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Pre-seed <span class="filter-count">723</span></label>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Seed <span class="filter-count">891</span></label>
          <label class="filter-option"><input type="checkbox" onchange="filterOpps()"> Series A <span class="filter-count">334</span></label>
        </div>
        <div class="filter-section">
          <div class="filter-title">Geography</div>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Global <span class="filter-count">398</span></label>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> USA <span class="filter-count">512</span></label>
          <label class="filter-option"><input type="checkbox" checked onchange="filterOpps()"> Europe <span class="filter-count">487</span></label>
          <label class="filter-option"><input type="checkbox" onchange="filterOpps()"> UK <span class="filter-count">203</span></label>
        </div>
      </aside>
      <div class="results-area">
        <div class="results-meta">
          <div class="results-count" id="resultsCount"><strong>2,400+</strong> opportunities found</div>
          <select class="sort-select" onchange="sortOpps(this.value)">
            <option value="match">Sort: Best Match</option>
            <option value="deadline">Sort: Deadline (soonest)</option>
            <option value="amount">Sort: Amount (highest)</option>
          </select>
        </div>
        <div id="oppsList"></div>
      </div>
    </div>
  </div>
</div>

<!-- ═══════════════════════════════════
     VIEW: DETAIL
═══════════════════════════════════ -->

<div class="view" id="view-detail">
  <div class="detail-header">
    <div class="detail-header-inner">
      <button class="detail-back" onclick="showView('directory')">← Back to opportunities</button>
      <div id="detailContent"></div>
    </div>
  </div>
  <div class="detail-body" id="detailBody"></div>
</div>

<!-- ═══════════════════════════════════
     VIEW: PROFILE (FOUNDER)
═══════════════════════════════════ -->

<div class="view" id="view-profile">
  <div class="container-sm profile-view fade-in">
    <div class="profile-header">
      <h1>Founder Profile <span class="badge badge-pro" style="font-size:11px;vertical-align:middle;margin-left:8px">PRO</span></h1>
      <p>Enter your startup details once. CapStack uses this to match opportunities and pre-fill applications.</p>
      <div class="progress-bar-wrap"><div class="progress-bar-fill" id="profileProgress"></div></div>
      <div class="progress-label" id="progressLabel">Profile 65% complete</div>
    </div>

```
<!-- Google Connection Status — shown dynamically by JS -->
<div id="google-connection-section" style="margin-bottom:20px"></div>

<div class="profile-grid">
  <div class="profile-card full-width">
    <div class="profile-card-header"><div class="profile-card-title">🏢 Company Basics</div><div class="complete">✓ Complete</div></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
      <div class="form-field"><label class="form-label">Company Name</label><input class="form-input" value="Luminary Labs" oninput="updateProgress()"></div>
      <div class="form-field"><label class="form-label">Website</label><input class="form-input" value="luminarylabs.io" oninput="updateProgress()"></div>
      <div class="form-field" style="grid-column:1/-1"><label class="form-label">One-line Description</label><input class="form-input" value="AI-powered supply chain resilience for mid-market manufacturers" oninput="updateProgress()"></div>
      <div class="form-field"><label class="form-label">Stage</label><select class="form-select"><option>Pre-seed</option><option selected>Seed</option><option>Series A</option></select></div>
      <div class="form-field"><label class="form-label">Primary Sector</label><select class="form-select"><option>B2B SaaS</option><option selected>Supply Chain / Logistics</option><option>Deep Tech</option></select></div>
    </div>
  </div>
  <div class="profile-card">
    <div class="profile-card-header"><div class="profile-card-title">📈 Traction</div><div class="incomplete" id="tractionStatus">⚠ Incomplete</div></div>
    <div class="traction-metrics">
      <div class="metric-box"><div class="metric-label">Monthly Revenue</div><div class="metric-value" contenteditable="true">$28K</div></div>
      <div class="metric-box"><div class="metric-label">MoM Growth</div><div class="metric-value" contenteditable="true">+22%</div></div>
      <div class="metric-box"><div class="metric-label">Customers</div><div class="metric-value" contenteditable="true">14</div></div>
      <div class="metric-box"><div class="metric-label">Team Size</div><div class="metric-value" contenteditable="true">6</div></div>
    </div>
  </div>
  <div class="profile-card">
    <div class="profile-card-header"><div class="profile-card-title">💰 Funding Ask</div><div class="incomplete">⚠ Incomplete</div></div>
    <div class="form-field"><label class="form-label">Raising Amount</label><input class="form-input" value="$1.2M"></div>
    <div class="form-field"><label class="form-label">Round Type</label><select class="form-select"><option selected>Seed</option><option>Pre-seed</option><option>Series A</option></select></div>
    <div class="form-field"><label class="form-label">Use of Funds</label><textarea class="form-textarea" placeholder="e.g. 60% engineering hires..." style="min-height:60px"></textarea></div>
  </div>
  <div class="profile-card full-width">
    <div class="profile-card-header"><div class="profile-card-title">👥 Team</div><div class="complete">✓ Complete</div></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
      <div style="background:var(--bg2);border-radius:8px;padding:16px;border:1px solid var(--border)"><div style="font-weight:600;font-size:14px;margin-bottom:4px">Aisha Reyes</div><div style="font-size:12px;color:var(--muted)">CEO & Co-founder · Ex-McKinsey, MBA Wharton</div></div>
      <div style="background:var(--bg2);border-radius:8px;padding:16px;border:1px solid var(--border)"><div style="font-weight:600;font-size:14px;margin-bottom:4px">Marcus Chen</div><div style="font-size:12px;color:var(--muted)">CTO & Co-founder · 10 yrs ML, ex-Amazon Logistics</div></div>
    </div>
  </div>
</div>
<div style="display:flex;gap:12px;margin-top:28px;justify-content:flex-end">
  <button class="btn btn-ghost" onclick="showToast('Draft saved')">Save Draft</button>
  <button class="btn btn-primary" onclick="showToast('Profile saved! Finding matches...','success');setTimeout(()=>showView('directory'),900)">Save & Find Matches →</button>
</div>
```

  </div>
</div>

<!-- ═══════════════════════════════════
     VIEW: TRACKER
═══════════════════════════════════ -->

<div class="view" id="view-tracker">
  <div class="container tracker-view fade-in">
    <div class="tracker-header">
      <div><h1>Application Tracker</h1><p style="color:var(--muted);margin-top:4px;font-size:14px">Track every application. Never miss a deadline.</p></div>
      <button class="btn btn-primary btn-sm" onclick="showView('directory')">+ Browse Funding</button>
    </div>
    <div id="tracker-content"></div>
  </div>
</div>

<!-- ═══════════════════════════════════
     VIEW: INVESTOR DASHBOARD
═══════════════════════════════════ -->

<div class="view" id="view-investor">
  <div class="container inv-dashboard fade-in">
    <div class="inv-header">
      <div>
        <h1>Investor Dashboard</h1>
        <p>Manage your submitted funding opportunities and reach thousands of qualified founders.</p>
      </div>
      <button class="btn btn-blue" onclick="openSubmitModal()">+ Submit New Opportunity</button>
    </div>

```
<div class="inv-stats" id="invStats">
  <div class="inv-stat"><div class="inv-stat-num" id="inv-stat-total">0</div><div class="inv-stat-label">Total Submissions</div></div>
  <div class="inv-stat"><div class="inv-stat-num" style="color:var(--accent2)" id="inv-stat-live">0</div><div class="inv-stat-label">Live Opportunities</div></div>
  <div class="inv-stat"><div class="inv-stat-num" style="color:var(--gold)" id="inv-stat-review">0</div><div class="inv-stat-label">Under Review</div></div>
  <div class="inv-stat"><div class="inv-stat-num" style="color:var(--muted)" id="inv-stat-views">0</div><div class="inv-stat-label">Total Founder Views</div></div>
</div>

<div class="inv-section-header">
  <div class="inv-section-title">Your Submissions</div>
</div>

<div id="submissionsList"></div>

<div class="tips-panel">
  <div class="tips-panel-title">💡 Tips for Higher Visibility</div>
  <ul class="tips-list">
    <li>Include specific eligibility criteria — founders filter heavily by these</li>
    <li>Set a clear deadline — opportunities without one get deprioritised in search</li>
    <li>Add tags like "Non-dilutive" or "Climate" to appear in filtered searches</li>
    <li>Keep your short description under 200 characters for best display in listing cards</li>
  </ul>
</div>
```

  </div>
</div>

<!-- ═══════════════════════════════════
     VIEW: ADMIN PANEL
═══════════════════════════════════ -->

<div class="view" id="view-admin">
  <div class="admin-layout">

```
<!-- Sidebar -->
<aside class="admin-sidebar">
  <div class="admin-sidebar-section">
    <div class="admin-sidebar-label">Overview</div>
    <button class="admin-nav-item active" id="anav-overview" onclick="switchAdminPanel('overview')">
      <span class="nav-icon">📊</span> Overview
    </button>
  </div>
  <div class="admin-sidebar-section">
    <div class="admin-sidebar-label">Moderation</div>
    <button class="admin-nav-item" id="anav-queue" onclick="switchAdminPanel('queue')">
      <span class="nav-icon">📋</span> Review Queue
      <span class="admin-nav-badge" id="admin-queue-badge">0</span>
    </button>
    <button class="admin-nav-item" id="anav-live" onclick="switchAdminPanel('live')">
      <span class="nav-icon">🟢</span> Live Listings
      <span class="admin-nav-badge green" id="admin-live-badge">0</span>
    </button>
    <button class="admin-nav-item" id="anav-flagged" onclick="switchAdminPanel('flagged')">
      <span class="nav-icon">⚑</span> Flagged
      <span class="admin-nav-badge gold" id="admin-flag-badge">0</span>
    </button>
    <button class="admin-nav-item" id="anav-rejected" onclick="switchAdminPanel('rejected')">
      <span class="nav-icon">✗</span> Rejected
    </button>
  </div>
  <div class="admin-sidebar-section">
    <div class="admin-sidebar-label">Platform</div>
    <button class="admin-nav-item" id="anav-users" onclick="switchAdminPanel('users')">
      <span class="nav-icon">👥</span> Users
    </button>
    <button class="admin-nav-item" id="anav-activity" onclick="switchAdminPanel('activity')">
      <span class="nav-icon">⚡</span> Activity Log
    </button>
  </div>
  <div class="admin-sidebar-section" style="margin-top:auto;padding-top:20px;border-top:1px solid rgba(255,255,255,0.06)">
    <button class="admin-nav-item" onclick="showView('landing')">
      <span class="nav-icon">←</span> Back to App
    </button>
  </div>
</aside>

<!-- Main content area -->
<main class="admin-main">

  <!-- ── OVERVIEW ── -->
  <div class="admin-panel active" id="apanel-overview">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">Command Centre</div>
        <div class="admin-page-sub">CapStack platform health — live data from localStorage</div>
      </div>
      <button class="action-btn action-btn-view" onclick="renderAdminDashboard()">↻ Refresh</button>
    </div>

    <div class="admin-kpi-row" id="admin-kpis">
      <!-- rendered by JS -->
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
      <div class="admin-card">
        <div class="admin-card-header">
          <div class="admin-card-title">PENDING REVIEW</div>
          <button class="action-btn action-btn-view" style="font-size:11px;padding:5px 10px" onclick="switchAdminPanel('queue')">View all →</button>
        </div>
        <div class="admin-card-body" id="overview-pending-list">
          <div class="admin-empty"><div class="admin-empty-icon">✓</div><h3>Queue is clear</h3><p>No submissions awaiting review</p></div>
        </div>
      </div>
      <div class="admin-card">
        <div class="admin-card-header">
          <div class="admin-card-title">ACTIVITY LOG</div>
          <button class="action-btn action-btn-view" style="font-size:11px;padding:5px 10px" onclick="switchAdminPanel('activity')">View all →</button>
        </div>
        <div class="admin-card-body" id="overview-activity-list">
        </div>
      </div>
    </div>

    <div class="admin-card" style="margin-top:20px">
      <div class="admin-card-header">
        <div class="admin-card-title">REGISTERED USERS — RECENT</div>
        <button class="action-btn action-btn-view" style="font-size:11px;padding:5px 10px" onclick="switchAdminPanel('users')">All users →</button>
      </div>
      <div class="admin-card-body" style="padding:0">
        <table class="admin-table" id="overview-users-table">
          <thead><tr><th>Name</th><th>Email</th><th>Type</th><th>Joined</th></tr></thead>
          <tbody id="overview-users-tbody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ── REVIEW QUEUE ── -->
  <div class="admin-panel" id="apanel-queue">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">Review Queue</div>
        <div class="admin-page-sub">Investor submissions awaiting approval before going live</div>
      </div>
      <div class="admin-filter-pills">
        <button class="admin-filter-pill active" onclick="setQueueFilter('pending',this)">Pending</button>
        <button class="admin-filter-pill" onclick="setQueueFilter('all',this)">All submissions</button>
      </div>
    </div>
    <div id="queue-list"></div>
  </div>

  <!-- ── LIVE LISTINGS ── -->
  <div class="admin-panel" id="apanel-live">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">Live Listings</div>
        <div class="admin-page-sub">Approved investor-submitted opportunities currently visible to founders</div>
      </div>
      <input type="text" class="admin-search" placeholder="Search live listings..." oninput="renderLiveListings(this.value)">
    </div>
    <div id="live-list"></div>
  </div>

  <!-- ── FLAGGED ── -->
  <div class="admin-panel" id="apanel-flagged">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">Flagged for Review</div>
        <div class="admin-page-sub">Listings founders have flagged as potentially outdated or inaccurate</div>
      </div>
    </div>
    <div id="flagged-list"></div>
  </div>

  <!-- ── REJECTED ── -->
  <div class="admin-panel" id="apanel-rejected">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">Rejected Submissions</div>
        <div class="admin-page-sub">Submissions that did not meet listing standards</div>
      </div>
    </div>
    <div id="rejected-list"></div>
  </div>

  <!-- ── USERS ── -->
  <div class="admin-panel" id="apanel-users">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">User Management</div>
        <div class="admin-page-sub">All registered accounts on CapStack</div>
      </div>
      <input type="text" class="admin-search" placeholder="Search users..." oninput="renderUsersTable(this.value)">
    </div>
    <div class="admin-table-wrap">
      <table class="admin-table">
        <thead><tr><th>Name</th><th>Email</th><th>Type</th><th>Submissions</th><th>Joined</th><th>Actions</th></tr></thead>
        <tbody id="users-tbody"></tbody>
      </table>
    </div>
  </div>

  <!-- ── ACTIVITY LOG ── -->
  <div class="admin-panel" id="apanel-activity">
    <div class="admin-page-header">
      <div>
        <div class="admin-page-title">Activity Log</div>
        <div class="admin-page-sub">All moderation actions taken on this platform</div>
      </div>
      <button class="action-btn action-btn-reject" onclick="clearActivityLog()">Clear log</button>
    </div>
    <div class="admin-card">
      <div class="admin-card-body" style="padding:0 20px">
        <div class="activity-feed" id="activity-feed"></div>
      </div>
    </div>
  </div>

</main>
```

  </div>
</div>

<script>
// ═══════════════════════════════════════════
// DATABASE (localStorage simulation)
// ═══════════════════════════════════════════
const DB = {
  getUsers: () => JSON.parse(localStorage.getItem('capstack_users') || '[]'),
  saveUsers: (users) => localStorage.setItem('capstack_users', JSON.stringify(users)),
  getCurrentUser: () => JSON.parse(localStorage.getItem('capstack_current_user') || 'null'),
  setCurrentUser: (user) => localStorage.setItem('capstack_current_user', JSON.stringify(user)),
  clearCurrentUser: () => localStorage.removeItem('capstack_current_user'),
  getSubmissions: () => JSON.parse(localStorage.getItem('capstack_submissions') || '[]'),
  saveSubmissions: (subs) => localStorage.setItem('capstack_submissions', JSON.stringify(subs)),
};

let selectedUserType = 'founder';

// ═══════════════════════════════════════════
// OPPORTUNITY DATA
// ═══════════════════════════════════════════
let opportunities = [
  { id:1, logo:"🇪🇺", name:"EIC Accelerator 2026", org:"European Innovation Council", type:"Government Grant", stage:["Pre-seed","Seed","Series A"], geo:"Europe", amount:"Up to €2.5M", deadline:"May 6, 2026", urgent:false, status:"active", verified:"Today", matchScore:91, communityRating:4.6, reviewCount:142, tags:["Deep Tech","Hardware","Climate","Europe"], desc:"The EIC Accelerator supports individual SMEs and startups to develop and scale up breakthrough innovations with EU-wide and global potential. Grant + equity investment up to €15M.", fullDesc:"The EIC Accelerator provides a combination of grant financing (up to €2.5M) and equity investment (up to €15M) for high-impact startups in deep tech, cleantech, and digital.", eligibility:[{ok:true,text:"SMEs in EU Member State or associated country"},{ok:true,text:"TRL 5–6 minimum"},{ok:true,text:"Deep tech, cleantech, healthtech, or digital"},{ok:false,text:"Not open to large enterprises as lead applicants"}], reviews:[{name:"Elena K.",rating:5,date:"Feb 2026",text:"Long process but worth it. TRL documentation is critical."},{name:"David T.",rating:4,date:"Jan 2026",text:"Business innovation component matters as much as tech."}], isNew:false, applyUrl:"https://ec.europa.eu/info/funding-tenders/opportunities/portal/screen/home" },

  { id:2, logo:"🚀", name:"Y Combinator S26", org:"Y Combinator", type:"Accelerator", stage:["Pre-seed","Seed"], geo:"Global", amount:"$500K", deadline:"Apr 22, 2026", urgent:false, status:"active", verified:"Yesterday", matchScore:87, communityRating:4.8, reviewCount:3102, tags:["Accelerator","Global","Any Sector"], desc:"The world's most prestigious startup accelerator. $500K for 7% equity. 3-month programme in San Francisco ending with Demo Day to 5,000+ investors.", fullDesc:"Y Combinator invests $500,000 in exchange for 7% equity. Summer 2026 batch runs July–September in San Francisco. Unlimited access to YC partners, alumni, and the most powerful investor network on earth.", eligibility:[{ok:true,text:"Any stage — pre-launch to Series A"},{ok:true,text:"Any sector or geography"},{ok:false,text:"Prior raise over $2M rarely accepted"}], reviews:[{name:"James H.",rating:5,date:"Feb 2026",text:"The network opens every door."},{name:"Mei L.",rating:5,date:"Jan 2026",text:"Be crystal clear on why you, why now."}], isNew:true, applyUrl:"https://www.ycombinator.com/apply" },

  { id:3, logo:"🇺🇸", name:"SBIR Phase I — NSF", org:"National Science Foundation", type:"Government Grant", stage:["Pre-seed","Seed"], geo:"USA", amount:"Up to $275K", deadline:"Jun 3, 2026", urgent:false, status:"active", verified:"3 days ago", matchScore:78, communityRating:3.9, reviewCount:416, tags:["Government","USA","Non-dilutive","R&D"], desc:"NSF SBIR Phase I funds early-stage R&D for US small businesses. Non-dilutive, equity-free. Strong preference for deep tech and scientific innovation with commercial potential.", fullDesc:"NSF SBIR Phase I awards support feasibility research for innovations with strong commercial and societal potential. Awards up to $275K over 6–12 months.", eligibility:[{ok:true,text:"US-based small business under 500 employees"},{ok:true,text:"51%+ US citizen or permanent resident owned"},{ok:false,text:"Non-US entities not eligible"},{ok:false,text:"Pure software without scientific basis rarely funded"}], reviews:[{name:"Dr. Anita W.",rating:4,date:"Feb 2026",text:"Bureaucratic but genuinely non-dilutive."},{name:"Carlos M.",rating:3,date:"Jan 2026",text:"Give yourself twice the time you think you need."}], isNew:false, applyUrl:"https://www.sbir.gov/apply" },

  { id:4, logo:"⚡", name:"Techstars SF 2026", org:"Techstars", type:"Accelerator", stage:["Pre-seed","Seed"], geo:"USA", amount:"$120K", deadline:"May 6, 2026", urgent:false, status:"active", verified:"2 days ago", matchScore:83, communityRating:4.2, reviewCount:412, tags:["Accelerator","USA","San Francisco","B2B"], desc:"Techstars San Francisco accelerator — $120K investment, 3-month mentorship-driven programme, culminating in Demo Day before 500+ investors.", fullDesc:"Techstars SF connects startups with world-class mentors and investors. The 3-month programme ends with Demo Day and lifetime access to the Techstars global network.", eligibility:[{ok:true,text:"Pre-seed to seed stage"},{ok:true,text:"Any sector, generalist programme"},{ok:true,text:"Willing to be in SF for 3 months"},{ok:false,text:"Consumer apps without network effects rarely selected"}], reviews:[{name:"Sofia K.",rating:4,date:"Feb 2026",text:"The mentor network is exceptional."},{name:"Wei Z.",rating:5,date:"Jan 2026",text:"Best 3 months of our startup journey."}], isNew:true, applyUrl:"https://www.techstars.com/accelerators" },

  { id:5, logo:"🌱", name:"Breakthrough Energy Fellows Cohort 6", org:"Breakthrough Energy", type:"Foundation", stage:["Pre-seed","Seed"], geo:"Global", amount:"Up to $3M", deadline:"Rolling 2026", urgent:false, status:"active", verified:"1 week ago", matchScore:62, communityRating:4.5, reviewCount:87, tags:["Climate","Clean Energy","Global","Non-dilutive"], desc:"Breakthrough Energy Fellows provides up to $3M non-dilutive funding for early-stage climate tech innovators. Cohort 6 begins September 2026.", fullDesc:"Supports scientists and entrepreneurs working on electricity, transportation, agriculture, manufacturing, and buildings. Full-time 1-year fellowship with stipend, lab costs, and expert network.", eligibility:[{ok:true,text:"Climate tech focus — 500M+ ton CO₂ reduction potential"},{ok:true,text:"Pre-seed to seed stage, under $2M raised"},{ok:false,text:"Pure software without emissions impact not eligible"}], reviews:[{name:"Dr. Fatima A.",rating:5,date:"Jan 2026",text:"Technical review is rigorous but evaluates real impact."},{name:"Ravi P.",rating:4,date:"Dec 2025",text:"They want to see you've thought seriously about scale."}], isNew:false, applyUrl:"https://befellows.smapply.org/" },

  { id:6, logo:"🏛️", name:"Innovate UK Smart Grant", org:"UK Research & Innovation", type:"Government Grant", stage:["Pre-seed","Seed","Series A"], geo:"UK", amount:"£25K–£500K", deadline:"Apr 1, 2026", urgent:false, status:"active", verified:"4 days ago", matchScore:71, communityRating:3.7, reviewCount:623, tags:["Government","UK","R&D","Non-dilutive"], desc:"Innovate UK's flagship open funding competition for game-changing R&D innovations with major UK economic impact. Up to £500K for single companies.", fullDesc:"Smart is Innovate UK's open competition targeting disruptive innovations. Single companies can apply for £25K–£500K. Collaborative projects can receive more.", eligibility:[{ok:true,text:"UK-registered company"},{ok:true,text:"R&D-led, clearly disruptive innovation"},{ok:false,text:"Non-UK entities not eligible"}], reviews:[{name:"Ben A.",rating:4,date:"Feb 2026",text:"Focus on UK economic impact, not just technical novelty."},{name:"Laura T.",rating:3,date:"Jan 2026",text:"Very competitive. A consultant made a huge difference."}], isNew:false, applyUrl:"https://apply-for-innovation-funding.service.gov.uk/competition/search" },

  { id:7, logo:"👼", name:"500 Global Flagship Fund", org:"500 Global", type:"VC / Angel", stage:["Pre-seed","Seed"], geo:"Global", amount:"$150K–$250K", deadline:"Rolling", urgent:false, status:"active", verified:"5 days ago", matchScore:76, communityRating:4.1, reviewCount:288, tags:["Angel","Global","Pre-seed","Seed"], desc:"500 Global invests in pre-seed and seed startups worldwide. One of the most prolific early-stage funds globally with 2,800+ portfolio companies across 80 countries.", fullDesc:"500 Global's flagship fund invests $150K–$250K at pre-seed and seed stages. Strong networks in Southeast Asia, Latin America, Middle East, and the US.", eligibility:[{ok:true,text:"Pre-seed or seed stage, any geography"},{ok:true,text:"Strong founding team with evidence of execution"},{ok:false,text:"Not suitable for pre-revenue ideas without traction"}], reviews:[{name:"Ama S.",rating:4,date:"Feb 2026",text:"Fast decision-making and great LATAM network."},{name:"Kiran R.",rating:4,date:"Jan 2026",text:"Good for internationally minded founders."}], isNew:false, applyUrl:"https://500.co/thefund" },

  { id:8, logo:"🌐", name:"Google for Startups Accelerator", org:"Google", type:"Accelerator", stage:["Seed","Series A"], geo:"Global", amount:"Up to $350K in credits + equity-free", deadline:"Rolling 2026", urgent:false, status:"active", verified:"2 days ago", matchScore:80, communityRating:4.4, reviewCount:521, tags:["Accelerator","Global","AI","Tech"], desc:"Google for Startups Accelerator is a 3-month equity-free programme for AI-first startups. Includes up to $350K in Google Cloud credits, technical mentorship from Googlers, and investor access.", fullDesc:"The programme focuses on AI/ML startups. You get access to Google engineers, product experts, and a global demo event. Zero equity taken.", eligibility:[{ok:true,text:"AI-first or ML-driven product"},{ok:true,text:"Seed to Series A stage"},{ok:true,text:"Any country — multiple regional cohorts"},{ok:false,text:"Non-tech companies rarely accepted"}], reviews:[{name:"Priya N.",rating:5,date:"Feb 2026",text:"Google Cloud credits alone are worth $350K. The engineering mentorship is world-class."},{name:"Tobias L.",rating:4,date:"Jan 2026",text:"Excellent for AI startups needing compute infrastructure."}], isNew:true, applyUrl:"https://startup.google.com/programs/accelerator/" },

  { id:9, logo:"🏗️", name:"a16z Speedrun — Pre-seed", org:"Andreessen Horowitz", type:"VC / Angel", stage:["Pre-seed"], geo:"USA", amount:"$1M–$3M", deadline:"Rolling", urgent:false, status:"active", verified:"1 week ago", matchScore:68, communityRating:4.3, reviewCount:174, tags:["Angel","Pre-seed","USA","Consumer","B2B"], desc:"a16z Speedrun is a pre-seed programme from one of the world's top VC firms. Fast decisions, large initial checks, and access to the full a16z platform.", fullDesc:"Andreessen Horowitz's early-stage programme invests $1M–$3M at pre-seed in exceptional founding teams. Focus on software, AI, crypto, fintech, and consumer.", eligibility:[{ok:true,text:"Pre-seed stage, usually pre-revenue"},{ok:true,text:"Based in or willing to relocate to USA"},{ok:false,text:"Hardware-only companies rarely funded"}], reviews:[{name:"Leo K.",rating:5,date:"Jan 2026",text:"The platform support is unreal. Portfolio intros opened our seed round."},{name:"Hannah G.",rating:4,date:"Dec 2025",text:"Fast process. They know quickly if they're interested."}], isNew:false, applyUrl:"https://a16z.com/speedrun/" },

  { id:10, logo:"🦁", name:"Antler Global Residency", org:"Antler", type:"Accelerator", stage:["Pre-seed"], geo:"Global", amount:"$200K–$250K", deadline:"Rolling 2026", urgent:false, status:"active", verified:"3 days ago", matchScore:73, communityRating:4.0, reviewCount:298, tags:["Accelerator","Pre-seed","Global","Co-founder"], desc:"Antler is a global day-zero investor that helps exceptional people build companies from scratch. 10-week residency with $200K–$250K for 10–12% equity.", fullDesc:"Antler operates in 30+ cities. You join as an individual or team, go through an intensive co-founding and validation period, then pitch for investment. 10-12% equity for $200K–$250K.", eligibility:[{ok:true,text:"Individuals or early teams — even pre-idea"},{ok:true,text:"Any sector and any geography"},{ok:false,text:"Not suitable for post-seed companies"}], reviews:[{name:"Yuki T.",rating:4,date:"Feb 2026",text:"Great if you're looking for a co-founder. The residency is intense but clarifying."},{name:"Obi M.",rating:4,date:"Jan 2026",text:"Good network across Africa and Asia."}], isNew:true, applyUrl:"https://www.antler.co/apply" },

  { id:11, logo:"💡", name:"Founders Factory Accelerator", org:"Founders Factory", type:"Accelerator", stage:["Pre-seed","Seed"], geo:"Europe", amount:"£250K + studio support", deadline:"Rolling 2026", urgent:false, status:"active", verified:"5 days ago", matchScore:65, communityRating:4.1, reviewCount:142, tags:["Accelerator","Europe","Studio","B2B"], desc:"Founders Factory is a global startup studio and accelerator backed by L'Oréal, Aviva, and Holtzbrinck. £250K investment plus hands-on build support for 6 months.", fullDesc:"Founders Factory has two tracks: accelerator (external startups, £250K) and studio (FF-built companies). Deep industry partnerships in media, beauty, finance, and mobility.", eligibility:[{ok:true,text:"Pre-seed to seed, early stage"},{ok:true,text:"UK or European companies preferred"},{ok:false,text:"Consumer hardware difficult without strong IP"}], reviews:[{name:"Rachel W.",rating:4,date:"Jan 2026",text:"The corporate partnership access is genuinely unique."},{name:"Dayo A.",rating:4,date:"Dec 2025",text:"Good operational support, not just money."}], isNew:false, applyUrl:"https://foundersfactory.com/accelerate/" },

  { id:12, logo:"🌍", name:"Africa Seed Fund — Partech", org:"Partech Africa", type:"VC / Angel", stage:["Seed"], geo:"Africa", amount:"$1M–$5M", deadline:"Rolling", urgent:false, status:"active", verified:"1 week ago", matchScore:55, communityRating:4.2, reviewCount:63, tags:["Angel","Africa","Seed","Emerging Markets"], desc:"Partech Africa invests $1M–$5M at seed stage in tech startups across Sub-Saharan Africa. One of the continent's most active and respected seed funds.", fullDesc:"Partech Africa focuses on fintech, agritech, health, and mobility across Nigeria, Kenya, Francophone Africa, and South Africa.", eligibility:[{ok:true,text:"Tech startup with African market focus"},{ok:true,text:"Seed stage with some traction"},{ok:false,text:"Non-African market focus not considered"}], reviews:[{name:"Chidi O.",rating:5,date:"Feb 2026",text:"Best fund for pan-African ambitions. Deep continent expertise."},{name:"Amara D.",rating:4,date:"Jan 2026",text:"Strong Francophone Africa network is rare."}], isNew:false, applyUrl:"https://partechpartners.com/africa" },

  { id:13, logo:"🔬", name:"Wellcome Leap R&D Fund", org:"Wellcome Trust", type:"Foundation", stage:["Pre-seed","Seed"], geo:"Global", amount:"Up to $1M+", deadline:"Rolling 2026", urgent:false, status:"active", verified:"4 days ago", matchScore:58, communityRating:4.6, reviewCount:47, tags:["Foundation","Global","Health","Non-dilutive","R&D"], desc:"Wellcome Leap funds ambitious R&D programmes that could deliver transformative health impact. Non-dilutive. Strong focus on biology, neuroscience, and quantum biology.", fullDesc:"Wellcome Leap's challenge-based programmes fund high-risk, high-reward health innovations. Each programme has specific milestones and is intensely milestone-driven.", eligibility:[{ok:true,text:"University spinouts, startups, or research teams"},{ok:true,text:"Bold health or biomedical technology focus"},{ok:false,text:"Commercial software without research component not eligible"}], reviews:[{name:"Dr. James P.",rating:5,date:"Jan 2026",text:"One of the best non-dilutive health funders globally. Very mission-driven."},{name:"Sara T.",rating:4,date:"Dec 2025",text:"Rigorous milestones but fair and supportive."}], isNew:false, applyUrl:"https://wellcomeleap.org/programs/" },

  { id:14, logo:"🏦", name:"SBA Small Business Loan (7a)", org:"US Small Business Administration", type:"Government Grant", stage:["Seed","Series A"], geo:"USA", amount:"Up to $5M", deadline:"Rolling", urgent:false, status:"active", verified:"1 week ago", matchScore:60, communityRating:3.5, reviewCount:892, tags:["Government","USA","Loan","Non-dilutive"], desc:"The SBA 7(a) loan programme is the most common government-backed small business loan in the USA. Up to $5M with favourable terms. Not a grant — must be repaid.", fullDesc:"SBA 7(a) loans are partially guaranteed by the federal government, allowing banks to offer better terms to small businesses that might not otherwise qualify.", eligibility:[{ok:true,text:"US-registered for-profit business"},{ok:true,text:"Meets SBA size standards (varies by industry)"},{ok:false,text:"Non-US businesses not eligible"},{ok:false,text:"Not suitable for pure R&D pre-revenue companies"}], reviews:[{name:"Maria F.",rating:4,date:"Feb 2026",text:"Good rates if you qualify. Bank relationship matters a lot."},{name:"Derek W.",rating:3,date:"Jan 2026",text:"Paperwork is significant but worth it for the rates."}], isNew:false, applyUrl:"https://www.sba.gov/funding-programs/loans/7a-loans" },

  { id:15, logo:"🧬", name:"Schmidt Futures Innovation Fund", org:"Schmidt Futures", type:"Foundation", stage:["Pre-seed","Seed"], geo:"Global", amount:"$100K–$1M", deadline:"Rolling 2026", urgent:false, status:"active", verified:"3 days ago", matchScore:64, communityRating:4.4, reviewCount:38, tags:["Foundation","Global","Science","Non-dilutive"], desc:"Schmidt Futures funds people and projects that leverage talent and technology to benefit humanity — especially at the intersection of AI, biology, and climate.", fullDesc:"Eric Schmidt's philanthropic initiative funds breakthrough science-led ventures. They back exceptional individuals who work at the frontier of AI, computational biology, and climate solutions.", eligibility:[{ok:true,text:"Science-led innovation with societal benefit"},{ok:true,text:"Global — no geography restriction"},{ok:false,text:"Business-only plays without scientific underpinning not funded"}], reviews:[{name:"Dr. Yara M.",rating:5,date:"Jan 2026",text:"Best funder for scientist-entrepreneurs. True long-term thinking."},{name:"Eric B.",rating:4,date:"Dec 2025",text:"Exceptional network access in AI and bio."}], isNew:true, applyUrl:"https://schmidtfutures.com/our-work/apply/" },

  { id:16, logo:"🔥", name:"First Round Capital — Seed", org:"First Round Capital", type:"VC / Angel", stage:["Seed"], geo:"USA", amount:"$500K–$1.5M", deadline:"Rolling", urgent:false, status:"active", verified:"2 days ago", matchScore:72, communityRating:4.5, reviewCount:319, tags:["Angel","Seed","USA","B2B","Consumer"], desc:"First Round Capital is one of the most founder-friendly seed funds. Famous for investments in Uber, Square, and Warby Parker. Active seed investor in 2026.", fullDesc:"FRC invests $500K–$1.5M at seed stage across B2B software, consumer, fintech, and marketplace businesses. Known for operational support and community.", eligibility:[{ok:true,text:"Seed stage, US-based preferred"},{ok:true,text:"Software-led business model"},{ok:false,text:"Hardware or non-tech companies rarely funded"}], reviews:[{name:"Alex P.",rating:5,date:"Feb 2026",text:"The community platform is worth as much as the money."},{name:"Julia C.",rating:5,date:"Jan 2026",text:"Most founder-friendly seed fund. They actually help."}], isNew:false, applyUrl:"https://firstround.com/apply/" },

  { id:17, logo:"🌏", name:"Sequoia Arc — Global Seed", org:"Sequoia Capital", type:"VC / Angel", stage:["Pre-seed","Seed"], geo:"Global", amount:"Up to $1M", deadline:"Rolling 2026", urgent:false, status:"active", verified:"4 days ago", matchScore:69, communityRating:4.7, reviewCount:201, tags:["Angel","Global","Pre-seed","Seed","AI"], desc:"Sequoia Arc is Sequoia's global pre-seed and seed programme for early-stage companies. Equity investment plus intensive support across the US, Europe, India, and Southeast Asia.", fullDesc:"Sequoia Arc runs regular global cohorts with intensive mentorship, peer networks, and follow-on access to Sequoia's main fund. Focus on AI, infrastructure, and consumer.", eligibility:[{ok:true,text:"Pre-seed or seed stage"},{ok:true,text:"Global — US, EU, India, SEA cohorts available"},{ok:false,text:"Post-Series A not eligible"}], reviews:[{name:"Nina K.",rating:5,date:"Feb 2026",text:"The brand alone opens every door. Arc is the best entry point."},{name:"Arjun S.",rating:4,date:"Jan 2026",text:"Cohort community is exceptional. Strong India programme."}], isNew:true, applyUrl:"https://www.sequoiacap.com/arc/" },

  { id:18, logo:"💼", name:"Acumen Academy Fellowship", org:"Acumen", type:"Foundation", stage:["Pre-seed","Seed"], geo:"Global", amount:"$60K non-dilutive + network", deadline:"Mar 31, 2026", urgent:false, status:"active", verified:"5 days ago", matchScore:52, communityRating:4.3, reviewCount:76, tags:["Foundation","Global","Impact","Non-dilutive","Social Enterprise"], desc:"Acumen Fellows is a year-long leadership and funding programme for founders building companies that serve low-income communities. $60K non-dilutive stipend plus global cohort.", fullDesc:"Acumen's fellowship combines $60K in non-dilutive support with intensive leadership development and a global network of impact investors and social enterprise leaders.", eligibility:[{ok:true,text:"Social enterprise or impact-first business"},{ok:true,text:"Any geography — global cohorts across Africa, Asia, Americas"},{ok:false,text:"Not suitable for pure profit-first businesses without social mission"}], reviews:[{name:"Amira B.",rating:5,date:"Jan 2026",text:"Transformative for impact founders. The peer network lasts forever."},{name:"Samuel L.",rating:4,date:"Dec 2025",text:"The leadership curriculum is genuinely world-class."}], isNew:false, applyUrl:"https://acumen.org/fellowships/" },
];

// ═══════════════════════════════════════════
// VIEW MANAGEMENT
// ═══════════════════════════════════════════
function showView(name) {
  const user = DB.getCurrentUser();

  // Auth guards
  if (name === 'admin') {
    if (!user || (user.type !== 'admin' && user.email !== ADMIN_EMAIL)) {
      showToast('Admin access required', 'error'); return;
    }
  }
  if (['profile','tracker'].includes(name) && !user) { openModal('authModal'); return; }
  if (name === 'investor') {
    if (!user) { openModal('authModal'); return; }
    if (user.type !== 'investor' && user.type !== 'admin') { showToast('This area is for investors', 'error'); return; }
  }

  // Crossfade: fade out current, then switch
  const current = document.querySelector('.view.active');
  const next    = document.getElementById('view-' + name);
  if (!next) return;
  if (current === next) return;

  const doSwitch = () => {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    next.classList.add('active');
    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
    const navEl = document.getElementById('nav-' + name);
    if (navEl) navEl.classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
    if (name === 'directory') {
      showSkeletonCards(5);
      setTimeout(() => renderOpps(getAllOpps()), 220);
    }
    if (name === 'tracker')   renderTracker();
    if (name === 'profile')   renderGoogleConnectionSection();
    if (name === 'investor')  renderInvestorDashboard();
    if (name === 'admin')     switchAdminPanel('overview');
  };

  if (current) {
    current.style.transition = 'opacity 0.18s ease, transform 0.18s ease';
    current.style.opacity    = '0';
    current.style.transform  = 'translateY(-6px)';
    setTimeout(() => {
      current.style.transition = '';
      current.style.opacity    = '';
      current.style.transform  = '';
      doSwitch();
    }, 180);
  } else {
    doSwitch();
  }
}

// ═══════════════════════════════════════════
// AUTH MODAL
// ═══════════════════════════════════════════
function openModal(id) {
  document.getElementById(id).classList.add('open');
  document.body.style.overflow = 'hidden';
}
function closeModal(id) {
  document.getElementById(id).classList.remove('open');
  document.body.style.overflow = '';
}

document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) closeModal(overlay.id);
  });
});

function switchAuthTab(tab) {
  document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
  document.getElementById('tab-' + tab).classList.add('active');
  document.getElementById('form-' + tab).classList.add('active');
  // clear errors
  document.querySelectorAll('.form-error').forEach(e => e.classList.remove('show'));
}

function selectUserType(type) {
  selectedUserType = type;
  document.querySelectorAll('.user-type-btn').forEach(b => {
    b.classList.remove('selected','founder','investor');
  });
  const btn = document.getElementById('type-' + type);
  btn.classList.add('selected', type);
}

function handleSignIn() {
  const email = document.getElementById('signin-email').value.trim();
  const password = document.getElementById('signin-password').value;
  const errEl = document.getElementById('signin-error');
  errEl.classList.remove('show');

  if (!email || !password) { errEl.textContent = 'Please fill in all fields'; errEl.classList.add('show'); return; }

  // Check for admin super-login
  if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
    const adminUser = { id: 'admin_001', name: 'CapStack Admin', email: ADMIN_EMAIL, type: 'admin', createdAt: new Date().toISOString() };
    DB.setCurrentUser(adminUser);
    closeModal('authModal');
    updateNavForUser(adminUser);
    showToast('Welcome back, Admin ⚡', 'success');
    setTimeout(() => showView('admin'), 400);
    return;
  }

  const users = DB.getUsers();
  const user = users.find(u => u.email === email && u.password === password);

  if (!user) { errEl.classList.add('show'); return; }

  DB.setCurrentUser(user);
  closeModal('authModal');
  updateNavForUser(user);
  showToast(`Welcome back, ${user.name.split(' ')[0]}! 👋`, 'success');

  if (user.type === 'investor') {
    setTimeout(() => showView('investor'), 400);
  } else if (user.type === 'admin') {
    setTimeout(() => showView('admin'), 400);
  } else {
    setTimeout(() => showView('directory'), 400);
  }
}

function handleSignUp() {
  const fname = document.getElementById('signup-fname').value.trim();
  const lname = document.getElementById('signup-lname').value.trim();
  const email = document.getElementById('signup-email').value.trim();
  const password = document.getElementById('signup-password').value;

  document.querySelectorAll('#form-signup .form-error').forEach(e => e.classList.remove('show'));

  let valid = true;
  if (!email.includes('@')) { document.getElementById('signup-email-error').classList.add('show'); valid = false; }
  if (password.length < 8)  { document.getElementById('signup-pass-error').classList.add('show'); valid = false; }
  if (!valid) return;

  const users = DB.getUsers();
  if (users.find(u => u.email === email)) {
    document.getElementById('signup-exists-error').classList.add('show');
    return;
  }

  const newUser = {
    id: 'user_' + Date.now(),
    name: `${fname} ${lname}`.trim() || email.split('@')[0],
    email, password,
    type: selectedUserType,
    createdAt: new Date().toISOString(),
    profile: {}
  };

  users.push(newUser);
  DB.saveUsers(users);
  DB.setCurrentUser(newUser);
  closeModal('authModal');
  updateNavForUser(newUser);

  if (newUser.type === 'investor') {
    showToast(`Welcome, ${newUser.name.split(' ')[0]}! Let's get your listings live. 🚀`, 'success');
    setTimeout(() => showView('investor'), 400);
  } else {
    // Founders get the onboarding flow
    setTimeout(() => startOnboarding(newUser), 400);
  }
}

function handleLogout() {
  // 1. Close dropdown immediately
  document.getElementById('user-dropdown').classList.remove('open');
  document.getElementById('user-menu').classList.remove('open');
  // 2. Clear session
  DB.clearCurrentUser();
  // 3. Reset nav (hides user menu, shows sign-in)
  updateNavForUser(null);
  // 4. Navigate home with a short delay so CSS settles
  setTimeout(() => showView('landing'), 30);
  showToast('Signed out. See you soon! 👋');
}

function updateNavForUser(user) {
  const signinBtn  = document.getElementById('nav-signin-btn');
  const userMenu   = document.getElementById('user-menu');
  const navProfile = document.getElementById('nav-profile');
  const navTracker = document.getElementById('nav-tracker');
  const navInvestor= document.getElementById('nav-investor');
  const navAdmin   = document.getElementById('nav-admin');

  const dNavProfile  = document.getElementById('dropdown-nav-profile');
  const dNavTracker  = document.getElementById('dropdown-nav-tracker');
  const dNavInvestor = document.getElementById('dropdown-nav-investor');
  const dNavAdmin    = document.getElementById('dropdown-nav-admin');

  if (user) {
    // Hide sign-in, show user menu
    signinBtn.classList.add('hidden');
    userMenu.classList.remove('hidden');

    const initials = user.name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
    const firstName = user.name.split(' ')[0];

    document.getElementById('user-avatar-initials').textContent = initials;
    document.getElementById('user-avatar-name').textContent    = firstName;

    const avatarLarge = document.getElementById('dropdown-avatar-large');
    if (avatarLarge) {
      avatarLarge.textContent = initials;
      avatarLarge.className   = 'dropdown-avatar-large' + (user.type !== 'founder' ? ' investor' : '');
    }
    document.getElementById('user-avatar-btn').className =
      'user-avatar' + (user.type !== 'founder' ? ' investor' : '');

    document.getElementById('dropdown-name').textContent  = user.name;
    document.getElementById('dropdown-email').textContent = user.email;
    const typeEl = document.getElementById('dropdown-type');
    typeEl.textContent = user.type === 'investor' ? '🏦 Investor / Funder'
                       : user.type === 'admin'    ? '⚡ Super Admin'
                       :                            '🚀 Founder';
    typeEl.className = 'dropdown-type ' + (user.type === 'admin' ? 'admin' : user.type);

    const isAdmin    = user.type === 'admin' || user.email === ADMIN_EMAIL;
    const isInvestor = user.type === 'investor';
    const isFounder  = user.type === 'founder';

    navProfile.classList.toggle('hidden',  !isFounder);
    navTracker.classList.toggle('hidden',  !isFounder);
    navInvestor.classList.toggle('hidden', !isInvestor && !isAdmin);
    navAdmin.classList.toggle('hidden',    !isAdmin);

    dNavProfile.style.display  = isFounder             ? 'flex' : 'none';
    dNavTracker.style.display  = isFounder             ? 'flex' : 'none';
    dNavInvestor.style.display = (isInvestor||isAdmin) ? 'flex' : 'none';
    dNavAdmin.style.display    = isAdmin               ? 'flex' : 'none';

  } else {
    // Logged out: show sign-in, FULLY hide user menu
    signinBtn.classList.remove('hidden');
    userMenu.classList.add('hidden');
    // Close dropdown
    document.getElementById('user-dropdown').classList.remove('open');
    userMenu.classList.remove('open');
    // Hide all gated nav links
    [navProfile, navTracker, navInvestor, navAdmin].forEach(n => { if (n) n.classList.add('hidden'); });
  }
  // Sync mobile drawer if open
  if (typeof syncMobileDrawerUser === 'function') syncMobileDrawerUser();
}

function toggleUserMenu() {
  const menu = document.getElementById('user-menu');
  const dropdown = document.getElementById('user-dropdown');
  const isOpen = dropdown.classList.contains('open');
  dropdown.classList.toggle('open', !isOpen);
  menu.classList.toggle('open', !isOpen);
}

document.addEventListener('click', (e) => {
  const menu = document.getElementById('user-menu');
  if (menu && !menu.contains(e.target)) {
    document.getElementById('user-dropdown').classList.remove('open');
    menu.classList.remove('open');
  }
});

// ═══════════════════════════════════════════
// SUBMIT OPPORTUNITY MODAL
// ═══════════════════════════════════════════
function openSubmitModal() {
  // Init with 2 eligibility rows
  const builder = document.getElementById('eligBuilder');
  builder.innerHTML = '';
  addEligRow(true);
  addEligRow(false);
  openModal('submitModal');
}

function addEligRow(isCheck = true) {
  const builder = document.getElementById('eligBuilder');
  const row = document.createElement('div');
  row.className = 'elig-row';
  row.innerHTML = `
    <div class="elig-type-toggle">
      <button class="elig-type-btn check ${isCheck ? 'active' : ''}" onclick="toggleEligType(this,'check')">✓</button>
      <button class="elig-type-btn cross ${!isCheck ? 'active' : ''}" onclick="toggleEligType(this,'cross')">✗</button>
    </div>
    <input class="elig-input" placeholder="e.g. Must be incorporated in EU member state">
    <button class="elig-remove" onclick="this.closest('.elig-row').remove()">×</button>
  `;
  builder.appendChild(row);
}

function toggleEligType(btn, type) {
  const toggle = btn.closest('.elig-type-toggle');
  toggle.querySelectorAll('.elig-type-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

function toggleStage(chip) {
  chip.classList.toggle('selected');
}

function updateCharCount(el, counterId, max) {
  const counter = document.getElementById(counterId);
  const len = el.value.length;
  counter.textContent = `${len} / ${max}`;
  counter.className = 'char-counter' + (len > max * 0.85 ? ' warn' : '');
}

function handleSubmitOpportunity() {
  const user = DB.getCurrentUser();
  if (!user) return;

  const errEl = document.getElementById('submit-form-error');
  errEl.classList.remove('show');

  const org = document.getElementById('sub-org').value.trim();
  const name = document.getElementById('sub-name').value.trim();
  const type = document.getElementById('sub-type').value;
  const geo = document.getElementById('sub-geo').value;
  const amount = document.getElementById('sub-amount').value.trim();
  const deadline = document.getElementById('sub-deadline').value;
  const url = document.getElementById('sub-url').value.trim();
  const shortDesc = document.getElementById('sub-short-desc').value.trim();

  if (!org || !name || !type || !geo || !amount || !deadline || !url || !shortDesc) {
    errEl.classList.add('show');
    return;
  }

  // Collect stages
  const stages = Array.from(document.querySelectorAll('#stageChips .stage-chip.selected')).map(c => c.dataset.stage);

  // Collect eligibility
  const eligibility = Array.from(document.querySelectorAll('#eligBuilder .elig-row')).map(row => {
    const isCheck = row.querySelector('.check').classList.contains('active');
    const text = row.querySelector('.elig-input').value.trim();
    return text ? { ok: isCheck, text } : null;
  }).filter(Boolean);

  // Collect tags
  const tagsRaw = document.getElementById('sub-tags').value;
  const tags = tagsRaw.split(',').map(t => t.trim()).filter(Boolean);

  const submission = {
    id: 'sub_' + Date.now(),
    userId: user.id,
    name, org, type, geo, amount, deadline, url,
    desc: shortDesc,
    fullDesc: document.getElementById('sub-full-desc').value.trim(),
    stage: stages,
    eligibility,
    tags,
    contact: document.getElementById('sub-contact').value.trim(),
    website: document.getElementById('sub-website').value.trim(),
    status: 'pending',
    views: 0,
    submittedAt: new Date().toISOString(),
  };

  const subs = DB.getSubmissions();
  subs.push(submission);
  DB.saveSubmissions(subs);

  closeModal('submitModal');
  showToast('Submitted! We\'ll review within 48 hours ✓', 'success');
  renderInvestorDashboard();
}

// ═══════════════════════════════════════════
// INVESTOR DASHBOARD
// ═══════════════════════════════════════════
function renderInvestorDashboard() {
  const user = DB.getCurrentUser();
  if (!user) return;

  const allSubs = DB.getSubmissions();
  const mySubs = allSubs.filter(s => s.userId === user.id);

  const live = mySubs.filter(s => s.status === 'live').length;
  const pending = mySubs.filter(s => s.status === 'pending').length;
  const totalViews = mySubs.reduce((acc, s) => acc + (s.views || 0), 0);

  document.getElementById('inv-stat-total').textContent = mySubs.length;
  document.getElementById('inv-stat-live').textContent = live;
  document.getElementById('inv-stat-review').textContent = pending;
  document.getElementById('inv-stat-views').textContent = totalViews;

  const container = document.getElementById('submissionsList');

  if (mySubs.length === 0) {
    container.innerHTML = `
      <div class="inv-empty">
        <div class="inv-empty-icon">📋</div>
        <h3>No submissions yet</h3>
        <p>Submit your first funding opportunity and reach thousands of qualified founders actively looking for funding.</p>
        <button class="btn btn-blue" onclick="openSubmitModal()">+ Submit New Opportunity</button>
      </div>`;
    return;
  }

  const statusMap = {
    pending: { badge: 'badge-pending', label: '⏳ Under Review' },
    live: { badge: 'badge-live', label: '● Live' },
    rejected: { badge: 'badge-rejected', label: '✗ Rejected' },
  };

  container.innerHTML = mySubs.map(sub => {
    const s = statusMap[sub.status] || statusMap.pending;
    const date = new Date(sub.submittedAt).toLocaleDateString('en-GB', { day:'numeric', month:'short', year:'numeric' });
    return `
      <div class="submission-card">
        <div class="sub-icon">🏢</div>
        <div class="sub-main">
          <div class="sub-top">
            <div>
              <div class="sub-name">${sub.name}</div>
              <div class="sub-org">${sub.org}</div>
            </div>
            <div class="sub-right">
              <span class="badge ${s.badge}">${s.label}</span>
              <div class="sub-views">👁 ${sub.views} views</div>
            </div>
          </div>
          <div style="font-size:13px;color:var(--muted);margin-top:8px;line-height:1.5">${sub.desc}</div>
          <div class="sub-meta">
            <span class="sub-meta-item">💰 ${sub.amount}</span>
            <span class="sub-meta-item">📅 ${sub.deadline}</span>
            <span class="sub-meta-item">🌍 ${sub.geo}</span>
            <span class="sub-meta-item">🏷 ${sub.type}</span>
            <span class="sub-meta-item" style="margin-left:auto;color:var(--border)">Submitted ${date}</span>
          </div>
          ${sub.status === 'pending' ? `<div style="margin-top:12px;font-size:12px;background:rgba(184,134,11,0.06);border:1px solid rgba(184,134,11,0.2);border-radius:6px;padding:8px 12px;color:var(--gold)">⏳ Our team will review this within 48 hours. We may contact you at ${sub.contact || sub.userId} if we need more information.</div>` : ''}
        </div>
      </div>`;
  }).join('');
}

// ═══════════════════════════════════════════
// DIRECTORY
// ═══════════════════════════════════════════
function getAllOpps() {
  // Expose for recalcMatchScores mutation
  window._OPPS = opportunities;
  // Merge scraped + approved investor submissions
  const subs = DB.getSubmissions().filter(s => s.status === 'live');
  const mappedSubs = subs.map(s => ({
    ...s, logo: '🏢', urgent: false,
    matchScore: Math.floor(Math.random() * 30) + 50,
    communityRating: 0, reviewCount: 0, reviews: [], isNew: true,
    eligibility: s.eligibility || [],
  }));
  return [...opportunities, ...mappedSubs];
}

function getTypeChipClass(type) {
  if (!type) return 'chip-government';
  const t = type.toLowerCase();
  if (t.includes('accelerator')) return 'chip-accelerator';
  if (t.includes('government') || t.includes('grant')) return 'chip-government';
  if (t.includes('vc') || t.includes('angel')) return 'chip-vc';
  if (t.includes('foundation')) return 'chip-foundation';
  if (t.includes('angel')) return 'chip-angel';
  return 'chip-government';
}

function getTypeIcon(type) {
  if (!type) return '🏛️';
  const t = type.toLowerCase();
  if (t.includes('accelerator')) return '⚡';
  if (t.includes('government') || t.includes('grant')) return '🏛️';
  if (t.includes('vc') || t.includes('angel')) return '👼';
  if (t.includes('foundation')) return '🔬';
  return '💼';
}

function renderOpps(list) {
  const container = document.getElementById('oppsList');
  const countEl = document.getElementById('resultsCount');
  countEl.innerHTML = `<strong>${list.length}</strong> opportunit${list.length !== 1 ? 'ies' : 'y'} found`;
  if (list.length === 0) {
    container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">🔍</div><h3>No opportunities found</h3><p>Try adjusting your filters or search terms</p></div>`;
    return;
  }
  container.innerHTML = list.map((o, idx) => `
    <div class="opp-card" style="animation-delay:${idx*0.03}s;margin-bottom:12px;position:relative" onclick="openDetail('${o.id}')">
      ${o.isNew ? `<div style="position:absolute;top:14px;right:0;background:var(--accent);color:#fff;font-family:var(--font-display);font-size:9px;font-weight:800;letter-spacing:0.08em;padding:3px 10px 3px 8px;border-radius:4px 0 0 4px">NEW</div>` : ''}
      <div style="display:flex;align-items:flex-start;gap:14px;padding:20px 22px 14px">
        <div style="width:46px;height:46px;border-radius:10px;background:var(--bg2);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">${o.logo || '🏢'}</div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px">
            <div>
              <div style="font-family:var(--font-display);font-size:15px;font-weight:700;color:var(--ink);letter-spacing:-0.01em;line-height:1.3;margin-bottom:2px">${o.name}</div>
              <div style="font-size:12px;color:var(--muted);font-weight:500">${o.org}</div>
            </div>
            <div style="font-family:var(--font-display);font-size:14px;font-weight:800;color:var(--accent2);background:rgba(42,107,74,0.07);border:1px solid rgba(42,107,74,0.14);border-radius:6px;padding:4px 10px;white-space:nowrap;flex-shrink:0">${o.amount}</div>
          </div>
          <div style="font-size:13px;color:var(--ink2);line-height:1.5;margin:10px 0 0;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden">${o.desc}</div>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:8px;padding:10px 22px;background:var(--surface2);border-top:1px solid var(--border);flex-wrap:wrap">
        <span class="opp-type-chip ${getTypeChipClass(o.type)}">${getTypeIcon(o.type)} ${o.type}</span>
        <span style="font-size:10px;color:var(--muted);background:var(--bg2);border:1px solid var(--border);padding:2px 7px;border-radius:4px;font-weight:600">🌍 ${o.geo}</span>
        ${(o.stage||[]).slice(0,1).map(s => `<span style="font-size:10px;color:var(--muted);background:var(--bg2);border:1px solid var(--border);padding:2px 7px;border-radius:4px;font-weight:600">${s}</span>`).join('')}
        <span style="margin-left:auto">${buildMatchPill(o.matchScore, [
          o.stage && o.stage[0] ? 'Stage: ' + o.stage[0] : 'Any stage',
          'Location: ' + o.geo,
          o.tags && o.tags[0] ? o.tags[0] : 'Active'
        ])}</span>
        <span style="font-size:11px;color:var(--muted);white-space:nowrap">📅 ${o.deadline}</span>
      </div>
    </div>`).join('');
}

function filterOpps() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  const all = getAllOpps();
  const filtered = query ? all.filter(o => o.name.toLowerCase().includes(query) || o.org.toLowerCase().includes(query) || o.desc.toLowerCase().includes(query) || (o.tags||[]).some(t => t.toLowerCase().includes(query))) : all;
  renderOpps(filtered);
}

function sortOpps(sortBy) {
  let sorted = [...getAllOpps()];
  if (sortBy === 'deadline') sorted.sort((a,b) => new Date(a.deadline) - new Date(b.deadline));
  else if (sortBy === 'amount') sorted.sort((a,b) => { const g = s => { const m = s.match(/[\d.]+/); return m ? parseFloat(m[0]) : 0; }; return g(b.amount) - g(a.amount); });
  else sorted.sort((a,b) => b.matchScore - a.matchScore);
  renderOpps(sorted);
}

// ═══════════════════════════════════════════
// DETAIL VIEW
// ═══════════════════════════════════════════
function openDetail(id) {
  const allOpps = getAllOpps();
  const o = allOpps.find(x => String(x.id) === String(id));
  if (!o) return;
  loadDetail(o);
  showView('detail');
}

function loadDetail(o) {
  document.getElementById('detailContent').innerHTML = `
    <div class="detail-logo">${o.logo || '🏢'}</div>
    <h1 class="detail-title">${o.name}</h1>
    <div class="detail-org">${o.org} · ${o.type} · ${o.geo}</div>
    <div class="detail-badges">
      <span class="badge badge-active">● Active</span>
      <span class="badge badge-verified">✓ Verified ${o.verified || 'recently'}</span>
      ${o.isNew ? '<span class="badge badge-new">NEW</span>' : ''}
      ${(o.tags||[]).map(t => `<span class="tag">${t}</span>`).join('')}
    </div>
    <div class="trust-panel">
      <div class="trust-panel-title">🛡 Trust & Verification</div>
      <div class="trust-grid">
        <div class="trust-item"><div class="trust-item-label">Status</div><div class="trust-item-value"><span class="badge badge-active">● Active</span></div></div>
        <div class="trust-item"><div class="trust-item-label">Last Verified</div><div class="trust-item-value" style="color:var(--accent2)">✓ ${o.verified || 'Recently'}</div></div>
        <div class="trust-item"><div class="trust-item-label">Community Rating</div><div class="trust-item-value">${o.communityRating ? `<span class="trust-stars">${'★'.repeat(Math.round(o.communityRating))}</span> ${o.communityRating}` : 'No reviews yet'}</div></div>
        <div class="trust-item"><div class="trust-item-label">Reviews</div><div class="trust-item-value">${o.reviewCount || 0} founders</div></div>
      </div>
    </div>
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <button class="btn btn-primary" onclick="addToTrackerById('${o.id}')">Save to Tracker</button>
      <button class="btn btn-green" onclick="window.open('${o.applyUrl || '#'}','_blank')">Apply Now ↗</button>
      <button class="btn btn-ghost btn-sm" onclick="showToast('Thanks for flagging. We\'ll review within 24 hours.')">⚑ Flag as outdated</button>
    </div>`;

  document.getElementById('detailBody').innerHTML = `
    <div class="detail-section"><h3>About This Programme</h3><p>${o.fullDesc || o.desc}</p></div>
    <div class="detail-section"><h3>Funding</h3>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px">
        <div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:16px;text-align:center"><div style="font-size:11px;color:var(--muted);margin-bottom:4px">Amount</div><div style="font-family:var(--font-display);font-size:20px;font-weight:800;color:var(--accent2)">${o.amount}</div></div>
        <div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:16px;text-align:center"><div style="font-size:11px;color:var(--muted);margin-bottom:4px">Deadline</div><div style="font-family:var(--font-display);font-size:16px;font-weight:700;color:var(--ink)">${o.deadline}</div></div>
        <div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:16px;text-align:center"><div style="font-size:11px;color:var(--muted);margin-bottom:4px">Stage</div><div style="font-family:var(--font-display);font-size:14px;font-weight:700;color:var(--ink)">${(o.stage||[]).join(' · ')}</div></div>
      </div>
    </div>
    ${(o.eligibility||[]).length ? `
    <div class="detail-section"><h3>Eligibility Criteria</h3>
      <ul class="eligibility-list">
        ${o.eligibility.map(e => `<li><span class="${e.ok ? 'elig-check' : 'elig-cross'}">${e.ok ? '✓' : '✗'}</span><span>${e.text}</span></li>`).join('')}
      </ul>
    </div>` : ''}
    <div class="detail-section"><h3>Your Match</h3>
      <div style="background:var(--surface2);border:1.5px solid var(--border);border-radius:10px;padding:20px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <span style="font-family:var(--font-display);font-weight:700">Luminary Labs × ${o.name}</span>
          ${buildMatchPill(o.matchScore, [o.stage && o.stage[0] ? 'Stage: '+o.stage[0] : 'Any stage', 'Location: '+o.geo, o.tags && o.tags[0] ? o.tags[0] : 'Active'])}
        </div>
        <div style="background:var(--bg2);border-radius:6px;height:8px;overflow:hidden">
          <div style="background:linear-gradient(90deg,var(--accent2),#4CAF50);height:100%;width:${o.matchScore}%;border-radius:6px;transition:width 0.6s ease"></div>
        </div>
        <p style="font-size:12px;color:var(--muted);margin-top:10px">Based on your profile: Seed-stage B2B, USA, $28K MRR, AI/Supply Chain.</p>
      </div>
    </div>
    ${(o.reviews||[]).length ? `
    <div class="detail-section"><h3>Founder Reviews (${o.reviewCount})</h3>
      ${o.reviews.map(r => `<div class="review-card"><div class="review-header"><div class="reviewer">${r.name}</div><div class="review-date">${r.date}</div></div><div class="review-stars">${'★'.repeat(r.rating)}${'☆'.repeat(5-r.rating)}</div><div class="review-text">${r.text}</div></div>`).join('')}
      <button class="btn btn-ghost btn-sm" onclick="showToast('Review submission coming soon!')">+ Write a review</button>
    </div>` : ''}
    <div class="apply-box">
      <h3>Ready to apply?</h3>
      <p>Complete your profile to unlock auto-fill for this application.</p>
      <div class="apply-btns">
        <button class="btn btn-primary" onclick="addToTrackerById('${o.id}')">Save to Tracker</button>
        <button class="btn btn-green" onclick="window.open('${o.applyUrl || '#'}','_blank')">Apply Now ↗</button>
        <button class="btn btn-secondary" onclick="showView('profile')">Complete My Profile</button>
      </div>
    </div>`;
}

function addToTrackerById(id) {
  const user = DB.getCurrentUser();
  if (!user) { openModal('authModal'); return; }
  showToast('Added to your tracker! ✓', 'success');
}

// ═══════════════════════════════════════════
// PROFILE
// ═══════════════════════════════════════════
function updateProgress() {
  const bar = document.getElementById('profileProgress');
  const label = document.getElementById('progressLabel');
  const inputs = document.querySelectorAll('#view-profile .form-input, #view-profile .form-textarea');
  let filled = 0;
  inputs.forEach(i => { if (i.value.trim().length > 0) filled++; });
  const pct = Math.min(95, Math.round((filled / inputs.length) * 100));
  bar.style.width = pct + '%';
  label.textContent = `Profile ${pct}% complete — ${pct < 80 ? 'add more details to unlock better matching' : 'Looking great!'}`;
}

// ═══════════════════════════════════════════
// TOAST
// ═══════════════════════════════════════════
function showToast(msg, type = '') {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.className = 'toast' + (type ? ' ' + type : '');
  // Reset animation
  toast.style.animation = 'none';
  toast.offsetHeight; // reflow
  toast.style.animation = '';
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 3200);
}

function showSkeletonCards(n = 4) {
  const container = document.getElementById('oppsList');
  if (!container) return;
  container.innerHTML = Array.from({length: n}, () => `
    <div class="skeleton-card">
      <div class="skeleton-block" style="width:46px;height:46px;border-radius:10px"></div>
      <div style="flex:1;display:flex;flex-direction:column;gap:10px">
        <div class="skeleton-block" style="height:16px;width:55%"></div>
        <div class="skeleton-block" style="height:12px;width:35%"></div>
        <div class="skeleton-block" style="height:12px;width:80%"></div>
        <div class="skeleton-block" style="height:12px;width:65%"></div>
      </div>
      <div class="skeleton-block" style="width:80px;height:28px;border-radius:6px"></div>
    </div>`).join('');
}

// ═══════════════════════════════════════════
// ADMIN — DATA & STATE
// ═══════════════════════════════════════════
const ADMIN_EMAIL = 'admin@capstack.io';
const ADMIN_PASSWORD = 'admin2026';

// Activity log stored in memory (resets on reload — by design for prototype)
let activityLog = JSON.parse(localStorage.getItem('capstack_activity') || '[]');

function logActivity(icon, text, type = 'blue') {
  activityLog.unshift({
    icon, text, type,
    time: new Date().toISOString()
  });
  if (activityLog.length > 100) activityLog = activityLog.slice(0, 100);
  localStorage.setItem('capstack_activity', JSON.stringify(activityLog));
}

let rejectTargetId = null;
let selectedRejectReason = null;
let currentQueueFilter = 'pending';

// ═══════════════════════════════════════════
// ADMIN — NAVIGATION
// ═══════════════════════════════════════════
function switchAdminPanel(name) {
  document.querySelectorAll('.admin-panel').forEach(p => p.classList.remove('active'));
  document.getElementById('apanel-' + name).classList.add('active');
  document.querySelectorAll('.admin-nav-item').forEach(i => i.classList.remove('active'));
  const navEl = document.getElementById('anav-' + name);
  if (navEl) navEl.classList.add('active');

  // Render the relevant panel
  if (name === 'overview') renderAdminDashboard();
  if (name === 'queue') renderQueue();
  if (name === 'live') renderLiveListings();
  if (name === 'flagged') renderFlaggedListings();
  if (name === 'rejected') renderRejectedListings();
  if (name === 'users') renderUsersTable();
  if (name === 'activity') renderActivityFeed();
}

// ═══════════════════════════════════════════
// ADMIN — DASHBOARD OVERVIEW
// ═══════════════════════════════════════════
function renderAdminDashboard() {
  const allSubs = DB.getSubmissions();
  const allUsers = DB.getUsers();
  const pending = allSubs.filter(s => s.status === 'pending');
  const live = allSubs.filter(s => s.status === 'live');
  const rejected = allSubs.filter(s => s.status === 'rejected');
  const flagged = allSubs.filter(s => s.status === 'flagged');
  const founders = allUsers.filter(u => u.type === 'founder');
  const investors = allUsers.filter(u => u.type === 'investor');

  // Update sidebar badges
  document.getElementById('admin-queue-badge').textContent = pending.length;
  document.getElementById('admin-live-badge').textContent = live.length;
  document.getElementById('admin-flag-badge').textContent = flagged.length;

  // KPIs
  document.getElementById('admin-kpis').innerHTML = `
    <div class="admin-kpi">
      <div class="admin-kpi-num">${allUsers.length}</div>
      <div class="admin-kpi-label">Total Users</div>
      <div class="admin-kpi-delta up">↑ ${allUsers.length > 0 ? allUsers.length : 0} registered</div>
    </div>
    <div class="admin-kpi">
      <div class="admin-kpi-num">${founders.length}</div>
      <div class="admin-kpi-label">Founders</div>
      <div class="admin-kpi-delta up">🚀 Active seekers</div>
    </div>
    <div class="admin-kpi">
      <div class="admin-kpi-num">${investors.length}</div>
      <div class="admin-kpi-label">Investors / Funders</div>
      <div class="admin-kpi-delta ${investors.length > 0 ? 'up' : 'warn'}">🏦 ${investors.length > 0 ? 'Submitting' : 'None yet'}</div>
    </div>
    <div class="admin-kpi">
      <div class="admin-kpi-num">${pending.length}</div>
      <div class="admin-kpi-label">Pending Review</div>
      <div class="admin-kpi-delta ${pending.length > 0 ? 'warn' : 'up'}">${pending.length > 0 ? '⏳ Needs attention' : '✓ Clear'}</div>
    </div>
    <div class="admin-kpi">
      <div class="admin-kpi-num">${live.length + 6}</div>
      <div class="admin-kpi-label">Live Opportunities</div>
      <div class="admin-kpi-delta up">↑ ${live.length} community + 6 scraped</div>
    </div>
  `;

  // Overview pending list
  const pendingEl = document.getElementById('overview-pending-list');
  if (pending.length === 0) {
    pendingEl.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">✅</div><h3>Queue is clear</h3><p>No submissions awaiting review</p></div>`;
  } else {
    pendingEl.innerHTML = pending.slice(0, 3).map(s => `
      <div style="display:flex;justify-content:space-between;align-items:flex-start;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.04);">
        <div>
          <div style="font-size:13px;color:#fff;font-weight:600;margin-bottom:3px">${s.name}</div>
          <div style="font-size:11px;color:rgba(255,255,255,0.35)">${s.org} · ${s.type} · ${s.geo}</div>
        </div>
        <div style="display:flex;gap:6px;flex-shrink:0;margin-left:12px">
          <button class="action-btn action-btn-approve" onclick="approveSubmission('${s.id}');renderAdminDashboard()">✓ Approve</button>
          <button class="action-btn action-btn-reject" onclick="openRejectModal('${s.id}')">✗</button>
        </div>
      </div>`).join('') + (pending.length > 3 ? `<div style="text-align:center;padding-top:12px"><button class="action-btn action-btn-view" onclick="switchAdminPanel('queue')">View ${pending.length - 3} more →</button></div>` : '');
  }

  // Overview activity
  const actEl = document.getElementById('overview-activity-list');
  if (activityLog.length === 0) {
    actEl.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">⚡</div><h3>No activity yet</h3><p>Actions will appear here</p></div>`;
  } else {
    actEl.innerHTML = activityLog.slice(0, 5).map(a => renderActivityItem(a)).join('');
  }

  // Overview users table
  const tbody = document.getElementById('overview-users-tbody');
  const recent = allUsers.slice(-5).reverse();
  tbody.innerHTML = recent.length === 0
    ? `<tr><td colspan="4" style="text-align:center;color:rgba(255,255,255,0.2);padding:24px">No users registered yet</td></tr>`
    : recent.map(u => `
      <tr>
        <td class="td-name">${u.name}</td>
        <td>${u.email}</td>
        <td><span class="td-type-badge td-type-${u.type}">${u.type === 'founder' ? '🚀' : '🏦'} ${u.type}</span></td>
        <td>${formatDate(u.createdAt)}</td>
      </tr>`).join('');
}

// ═══════════════════════════════════════════
// ADMIN — REVIEW QUEUE
// ═══════════════════════════════════════════
function setQueueFilter(filter, btn) {
  currentQueueFilter = filter;
  document.querySelectorAll('.admin-filter-pill').forEach(p => p.classList.remove('active'));
  btn.classList.add('active');
  renderQueue();
}

function renderQueue() {
  const allSubs = DB.getSubmissions();
  const list = currentQueueFilter === 'pending' ? allSubs.filter(s => s.status === 'pending') : allSubs;
  const container = document.getElementById('queue-list');

  if (list.length === 0) {
    container.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">✅</div><h3>${currentQueueFilter === 'pending' ? 'Queue is empty' : 'No submissions yet'}</h3><p>${currentQueueFilter === 'pending' ? 'All caught up — nothing pending review' : 'Investor submissions will appear here'}</p></div>`;
    return;
  }

  container.innerHTML = list.map((s, i) => renderQueueCard(s, i)).join('');
}

function renderQueueCard(s, idx) {
  const allUsers = DB.getUsers();
  const submitter = allUsers.find(u => u.id === s.userId);
  const date = formatDate(s.submittedAt);
  const statusMap = { pending:'asb-pending', live:'asb-live', rejected:'asb-rejected', flagged:'asb-flagged' };
  const statusLabel = { pending:'⏳ Pending', live:'● Live', rejected:'✗ Rejected', flagged:'⚑ Flagged' };

  return `
  <div class="review-queue-card" style="animation-delay:${idx * 0.04}s" id="rqc-${s.id}">
    <div class="rqc-header">
      <div class="rqc-left">
        <div class="rqc-name">${s.name}</div>
        <div class="rqc-org">${s.org}</div>
      </div>
      <div class="rqc-right">
        <span class="admin-status-badge ${statusMap[s.status] || 'asb-pending'}">${statusLabel[s.status] || '⏳ Pending'}</span>
        ${s.status === 'pending' ? `
          <button class="action-btn action-btn-approve" onclick="approveSubmission('${s.id}')">✓ Approve</button>
          <button class="action-btn action-btn-flag" onclick="flagSubmission('${s.id}')">⚑ Flag</button>
          <button class="action-btn action-btn-reject" onclick="openRejectModal('${s.id}')">✗ Reject</button>
        ` : ''}
        ${s.status === 'live' ? `<button class="action-btn action-btn-reject" onclick="revokeSubmission('${s.id}')">↩ Revoke</button>` : ''}
        ${s.status === 'flagged' ? `
          <button class="action-btn action-btn-approve" onclick="approveSubmission('${s.id}')">✓ Approve anyway</button>
          <button class="action-btn action-btn-reject" onclick="openRejectModal('${s.id}')">✗ Reject</button>
        ` : ''}
      </div>
    </div>

    <div class="rqc-meta">
      <span class="rqc-meta-item">💰 <strong>${s.amount}</strong></span>
      <span class="rqc-meta-item">📅 <strong>${s.deadline}</strong></span>
      <span class="rqc-meta-item">🌍 <strong>${s.geo}</strong></span>
      <span class="rqc-meta-item">🏷 <strong>${s.type}</strong></span>
      <span class="rqc-meta-item">📊 Stages: <strong>${(s.stage || []).join(', ') || 'Not specified'}</strong></span>
    </div>

    <div class="rqc-desc">${s.desc}</div>

    ${(s.eligibility || []).length > 0 ? `
    <div class="rqc-eligibility">
      ${s.eligibility.map(e => `<span class="rqc-elig-chip ${e.ok ? 'ok' : 'no'}">${e.ok ? '✓' : '✗'} ${e.text}</span>`).join('')}
    </div>` : ''}

    ${s.url ? `<div style="margin-bottom:10px"><a href="${s.url}" target="_blank" style="font-size:12px;color:rgba(30,79,168,0.8);text-decoration:none">🔗 ${s.url}</a></div>` : ''}

    <div class="rqc-submitter">
      <span>Submitted by <strong style="color:rgba(255,255,255,0.5)">${submitter ? submitter.name : 'Unknown'}</strong> (${submitter ? submitter.email : s.userId})</span>
      <span>·</span>
      <span>${date}</span>
      ${s.rejectReason ? `<span>·</span><span style="color:#f87171">Rejection reason: ${s.rejectReason}</span>` : ''}
    </div>
  </div>`;
}

// ═══════════════════════════════════════════
// ADMIN — ACTIONS
// ═══════════════════════════════════════════
function approveSubmission(id) {
  const subs = DB.getSubmissions();
  const sub = subs.find(s => s.id === id);
  if (!sub) return;
  sub.status = 'live';
  sub.approvedAt = new Date().toISOString();
  DB.saveSubmissions(subs);
  logActivity('✅', `Approved: <strong>${sub.name}</strong> by ${sub.org} — now live in directory`, 'green');
  showToast(`✓ "${sub.name}" is now live in the directory`, 'success');
  refreshAdminAfterAction();
}

function revokeSubmission(id) {
  const subs = DB.getSubmissions();
  const sub = subs.find(s => s.id === id);
  if (!sub) return;
  sub.status = 'pending';
  delete sub.approvedAt;
  DB.saveSubmissions(subs);
  logActivity('↩', `Revoked live listing: <strong>${sub.name}</strong> — returned to pending`, 'gold');
  showToast(`"${sub.name}" revoked — moved back to pending`);
  refreshAdminAfterAction();
}

function flagSubmission(id) {
  const subs = DB.getSubmissions();
  const sub = subs.find(s => s.id === id);
  if (!sub) return;
  sub.status = 'flagged';
  DB.saveSubmissions(subs);
  logActivity('⚑', `Flagged for review: <strong>${sub.name}</strong> by ${sub.org}`, 'gold');
  showToast(`"${sub.name}" flagged for further review`);
  refreshAdminAfterAction();
}

function openRejectModal(id) {
  rejectTargetId = id;
  selectedRejectReason = null;
  document.querySelectorAll('.reject-reason-btn').forEach(b => b.classList.remove('selected'));
  document.getElementById('rejectCustomNote').value = '';
  openModal('rejectModal');
}

function selectRejectReason(btn) {
  document.querySelectorAll('.reject-reason-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  selectedRejectReason = btn.textContent.trim();
}

function confirmReject() {
  if (!rejectTargetId) return;
  const reason = selectedRejectReason || document.getElementById('rejectCustomNote').value.trim() || 'No reason provided';
  const subs = DB.getSubmissions();
  const sub = subs.find(s => s.id === rejectTargetId);
  if (!sub) return;
  sub.status = 'rejected';
  sub.rejectReason = reason;
  sub.rejectedAt = new Date().toISOString();
  DB.saveSubmissions(subs);
  logActivity('✗', `Rejected: <strong>${sub.name}</strong> — "${reason.substring(0,50)}..."`, 'red');
  closeModal('rejectModal');
  showToast(`"${sub.name}" rejected`, 'error');
  rejectTargetId = null;
  refreshAdminAfterAction();
}

function deleteUser(userId) {
  if (!confirm('Are you sure you want to delete this user? This cannot be undone.')) return;
  const users = DB.getUsers().filter(u => u.id !== userId);
  DB.saveUsers(users);
  // Also remove their submissions
  const subs = DB.getSubmissions().filter(s => s.userId !== userId);
  DB.saveSubmissions(subs);
  logActivity('🗑', `Deleted user account and all associated submissions`, 'red');
  showToast('User deleted');
  renderUsersTable();
}

function promoteToAdmin(userId) {
  const users = DB.getUsers();
  const user = users.find(u => u.id === userId);
  if (!user) return;
  user.type = 'admin';
  DB.saveUsers(users);
  logActivity('⬆', `Promoted <strong>${user.name}</strong> to admin`, 'blue');
  showToast(`${user.name} promoted to admin`);
  renderUsersTable();
}

function refreshAdminAfterAction() {
  const activePanel = document.querySelector('.admin-panel.active');
  if (!activePanel) return;
  const id = activePanel.id.replace('apanel-', '');
  if (id === 'overview') renderAdminDashboard();
  else if (id === 'queue') { renderQueue(); renderAdminDashboard(); }
  else if (id === 'live') renderLiveListings();
  else if (id === 'flagged') renderFlaggedListings();
  else if (id === 'rejected') renderRejectedListings();
  // Always update badges
  const subs = DB.getSubmissions();
  document.getElementById('admin-queue-badge').textContent = subs.filter(s => s.status === 'pending').length;
  document.getElementById('admin-live-badge').textContent = subs.filter(s => s.status === 'live').length;
  document.getElementById('admin-flag-badge').textContent = subs.filter(s => s.status === 'flagged').length;
}

// ═══════════════════════════════════════════
// ADMIN — LISTINGS PANELS
// ═══════════════════════════════════════════
function renderLiveListings(search = '') {
  const subs = DB.getSubmissions().filter(s => s.status === 'live');
  const filtered = search ? subs.filter(s => s.name.toLowerCase().includes(search.toLowerCase()) || s.org.toLowerCase().includes(search.toLowerCase())) : subs;
  const container = document.getElementById('live-list');

  if (filtered.length === 0) {
    container.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">🟢</div><h3>No live listings yet</h3><p>Approve submissions to make them visible to founders</p></div>`;
    return;
  }
  container.innerHTML = filtered.map((s, i) => `
    <div class="review-queue-card" style="animation-delay:${i*0.04}s">
      <div class="rqc-header">
        <div class="rqc-left"><div class="rqc-name">${s.name}</div><div class="rqc-org">${s.org}</div></div>
        <div class="rqc-right">
          <span class="admin-status-badge asb-live">● Live</span>
          <button class="action-btn action-btn-flag" onclick="flagSubmission('${s.id}')">⚑ Flag</button>
          <button class="action-btn action-btn-reject" onclick="revokeSubmission('${s.id}')">↩ Revoke</button>
        </div>
      </div>
      <div class="rqc-meta">
        <span class="rqc-meta-item">💰 <strong>${s.amount}</strong></span>
        <span class="rqc-meta-item">📅 <strong>${s.deadline}</strong></span>
        <span class="rqc-meta-item">🌍 <strong>${s.geo}</strong></span>
        <span class="rqc-meta-item">👁 <strong>${s.views || 0}</strong> views</span>
        <span class="rqc-meta-item">✅ Approved ${formatDate(s.approvedAt)}</span>
      </div>
      <div class="rqc-desc">${s.desc}</div>
    </div>`).join('');
}

function renderFlaggedListings() {
  const subs = DB.getSubmissions().filter(s => s.status === 'flagged');
  const container = document.getElementById('flagged-list');
  if (subs.length === 0) {
    container.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">⚑</div><h3>Nothing flagged</h3><p>Flagged listings from founders or your team will appear here</p></div>`;
    return;
  }
  container.innerHTML = subs.map((s, i) => renderQueueCard(s, i)).join('');
}

function renderRejectedListings() {
  const subs = DB.getSubmissions().filter(s => s.status === 'rejected');
  const container = document.getElementById('rejected-list');
  if (subs.length === 0) {
    container.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">✗</div><h3>No rejections</h3><p>Rejected submissions will be archived here</p></div>`;
    return;
  }
  container.innerHTML = subs.map((s, i) => renderQueueCard(s, i)).join('');
}

// ═══════════════════════════════════════════
// ADMIN — USERS TABLE
// ═══════════════════════════════════════════
function renderUsersTable(search = '') {
  const allUsers = DB.getUsers();
  const allSubs = DB.getSubmissions();
  const filtered = search ? allUsers.filter(u => u.name.toLowerCase().includes(search.toLowerCase()) || u.email.toLowerCase().includes(search.toLowerCase())) : allUsers;
  const tbody = document.getElementById('users-tbody');

  if (filtered.length === 0) {
    tbody.innerHTML = `<tr><td colspan="6" style="text-align:center;color:rgba(255,255,255,0.2);padding:36px">No users found</td></tr>`;
    return;
  }

  tbody.innerHTML = filtered.map(u => {
    const subCount = allSubs.filter(s => s.userId === u.id).length;
    return `
    <tr>
      <td class="td-name">${u.name}</td>
      <td>${u.email}</td>
      <td><span class="td-type-badge td-type-${u.type}">${u.type === 'founder' ? '🚀' : u.type === 'investor' ? '🏦' : '⚡'} ${u.type}</span></td>
      <td>${subCount > 0 ? `<span style="color:#fff;font-weight:600">${subCount}</span>` : '<span style="color:rgba(255,255,255,0.2)">—</span>'}</td>
      <td>${formatDate(u.createdAt)}</td>
      <td>
        <div style="display:flex;gap:6px">
          ${u.type !== 'admin' ? `<button class="action-btn action-btn-flag" style="font-size:11px;padding:5px 9px" onclick="promoteToAdmin('${u.id}')">→ Admin</button>` : '<span style="font-size:11px;color:rgba(255,255,255,0.25)">Super admin</span>'}
          <button class="action-btn action-btn-reject" style="font-size:11px;padding:5px 9px" onclick="deleteUser('${u.id}')">Delete</button>
        </div>
      </td>
    </tr>`;
  }).join('');
}

// ═══════════════════════════════════════════
// ADMIN — ACTIVITY LOG
// ═══════════════════════════════════════════
function renderActivityFeed() {
  const feed = document.getElementById('activity-feed');
  if (activityLog.length === 0) {
    feed.innerHTML = `<div class="admin-empty"><div class="admin-empty-icon">⚡</div><h3>No activity yet</h3><p>Moderation actions will be logged here in real time</p></div>`;
    return;
  }
  feed.innerHTML = activityLog.map(a => renderActivityItem(a)).join('');
}

function renderActivityItem(a) {
  const colorMap = { green: 'ad-green', red: 'ad-red', gold: 'ad-gold', blue: 'ad-blue' };
  const time = a.time ? new Date(a.time).toLocaleString('en-GB', { day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' }) : 'recently';
  return `
    <div class="activity-item">
      <div class="activity-dot ${colorMap[a.type] || 'ad-blue'}">${a.icon}</div>
      <div class="activity-content">
        <div class="activity-text">${a.text}</div>
        <div class="activity-time">${time}</div>
      </div>
    </div>`;
}

function clearActivityLog() {
  if (!confirm('Clear the entire activity log?')) return;
  activityLog = [];
  localStorage.setItem('capstack_activity', '[]');
  renderActivityFeed();
}

// ═══════════════════════════════════════════
// UTILS
// ═══════════════════════════════════════════
function formatDate(iso) {
  if (!iso) return '—';
  try {
    return new Date(iso).toLocaleDateString('en-GB', { day:'numeric', month:'short', year:'numeric' });
  } catch(e) { return iso; }
}

// ═══════════════════════════════════════════
// ONBOARDING FLOW
// ═══════════════════════════════════════════
let obStep = 0;
const obTotalSteps = 4; // 0=welcome, 1=sector, 2=stage, 3=geo
const obSelections = { sector: [], stage: [], geo: [] };

const obConfig = [
  {
    heading: 'Welcome to CapStack 🎉',
    sub: 'Let\'s personalise your funding matches in 3 quick steps.',
    btn: 'Let\'s go →',
    progress: 0
  },
  {
    heading: 'What sector are you in?',
    sub: 'Select all that apply — we\'ll surface the most relevant grants and programmes.',
    btn: 'Next →',
    progress: 33
  },
  {
    heading: 'What stage is your startup?',
    sub: 'We\'ll use this to filter funding that\'s actually available to you right now.',
    btn: 'Next →',
    progress: 66
  },
  {
    heading: 'Where are you based?',
    sub: 'Many grants are region-specific — this ensures you only see eligible opportunities.',
    btn: 'See my matches →',
    progress: 90
  }
];

function startOnboarding(user) {
  obStep = 0;
  obSelections.sector = [];
  obSelections.stage = [];
  obSelections.geo = [];
  document.querySelectorAll('.onboarding-chip').forEach(c => c.classList.remove('selected'));
  renderObStep(0);
  document.getElementById('onboardingOverlay').classList.add('open');
}

function renderObStep(step) {
  const cfg = obConfig[step];
  document.getElementById('ob-heading').textContent = cfg.heading;
  document.getElementById('ob-subheading').textContent = cfg.sub;
  document.getElementById('ob-next-btn').textContent = cfg.btn;
  document.getElementById('ob-progress').style.width = cfg.progress + '%';

  // Update dots
  for (let i = 0; i < obTotalSteps; i++) {
    const dot = document.getElementById('ob-dot-' + i);
    if (!dot) continue;
    dot.classList.remove('active', 'done');
    if (i < step) dot.classList.add('done');
    else if (i === step) dot.classList.add('active');
  }

  // Show/hide steps
  document.querySelectorAll('.onboarding-step').forEach((el, i) => {
    el.classList.remove('active');
    if (i === step) el.classList.add('active');
  });
}

function toggleChip(el, key, mode = 'multi') {
  if (mode === 'single') {
    // Deselect siblings in same group
    el.closest('.onboarding-chips').querySelectorAll('.onboarding-chip').forEach(c => c.classList.remove('selected'));
    el.classList.add('selected');
    obSelections[key] = [el.textContent.split('\n')[0].replace(/[^\w\s\/]/g, '').trim()];
  } else {
    el.classList.toggle('selected');
    const val = el.textContent.split('\n')[0].trim();
    if (el.classList.contains('selected')) {
      obSelections[key].push(val);
    } else {
      obSelections[key] = obSelections[key].filter(v => v !== val);
    }
  }
}

function onboardingNext() {
  if (obStep < obTotalSteps - 1) {
    obStep++;
    renderObStep(obStep);
  } else {
    finishOnboarding();
  }
}

function skipOnboarding() {
  document.getElementById('onboardingOverlay').classList.remove('open');
  showToast('No worries — update your profile anytime to get better matches.', '');
  setTimeout(() => showView('directory'), 300);
}

function finishOnboarding() {
  document.getElementById('onboardingOverlay').classList.remove('open');

  // Save profile selections to user
  const user = DB.getCurrentUser();
  if (user) {
    user.profile = user.profile || {};
    user.profile.sectors  = obSelections.sector;
    user.profile.stage    = obSelections.stage[0] || '';
    user.profile.geo      = obSelections.geo[0] || '';
    user.profile.onboarded = true;

    // Recalculate match scores based on selections
    if (obSelections.sector.length || obSelections.stage.length || obSelections.geo.length) {
      recalcMatchScores(user.profile);
    }

    const users = DB.getUsers();
    const idx = users.findIndex(u => u.id === user.id);
    if (idx > -1) { users[idx] = user; DB.saveUsers(users); }
    DB.setCurrentUser(user);
  }

  const firstName = user ? user.name.split(' ')[0] : 'there';
  showToast(`Perfect, ${firstName}! Your matches are ready ✦`, 'success');
  setTimeout(() => {
    showView('directory');
    // Pulse the match pills to draw attention
    setTimeout(() => {
      document.querySelectorAll('.match-pill').forEach((pill, i) => {
        setTimeout(() => {
          pill.style.transform = 'scale(1.1)';
          pill.style.transition = 'transform 0.2s';
          setTimeout(() => { pill.style.transform = ''; }, 200);
        }, i * 60);
      });
    }, 600);
  }, 350);
}

function recalcMatchScores(profile) {
  // Boost match scores for opps matching user's profile
  // This mutates the in-memory OPPS array for the session
  if (!profile) return;
  const stageMap = {
    'Idea stage': ['Pre-seed'],
    'Building MVP': ['Pre-seed'],
    'Pre-seed': ['Pre-seed', 'Seed'],
    'Seed': ['Seed', 'Series A'],
    'Series A+': ['Series A']
  };
  const userStages = stageMap[profile.stage] || [];
  const userGeo = (profile.geo || '').replace(/[🇺🇸🇬🇧🇪🇺🇮🇳🌍🌏🇨🇦🌐]/gu, '').trim();

  // Map geo chip text to opp geo values
  const geoMap = {
    'United States': 'USA', 'United Kingdom': 'UK',
    'Europe (EU)': 'Europe', 'India': 'India',
    'Africa': 'Africa', 'Southeast Asia': 'Global',
    'Canada': 'USA', 'Global / Remote': 'Global'
  };
  const mappedGeo = geoMap[userGeo] || userGeo;

  window._OPPS && window._OPPS.forEach(o => {
    let score = 50;
    // Stage match
    if (userStages.length && o.stage && o.stage.some(s => userStages.includes(s))) score += 20;
    // Geo match
    if (mappedGeo && (o.geo === mappedGeo || o.geo === 'Global')) score += 15;
    // Sector/tag match
    const oppTags = (o.tags || []).map(t => t.toLowerCase());
    const userSectors = (profile.sectors || []).map(s => s.replace(/[^\w\s]/g, '').trim().toLowerCase());
    if (userSectors.some(s => oppTags.some(t => t.includes(s.split(' ')[0])))) score += 15;
    o.matchScore = Math.min(99, Math.max(40, score));
  });
}

// ═══════════════════════════════════════════
// TRACKER — DYNAMIC RENDERER
// ═══════════════════════════════════════════
// Tracker items stored per-user in localStorage
function getTrackerItems() {
  const user = DB.getCurrentUser();
  if (!user) return [];
  const key = 'capstack_tracker_' + user.id;
  try { return JSON.parse(localStorage.getItem(key) || '[]'); } catch { return []; }
}

function saveTrackerItems(items) {
  const user = DB.getCurrentUser();
  if (!user) return;
  localStorage.setItem('capstack_tracker_' + user.id, JSON.stringify(items));
}

function addToTrackerById(oppId) {
  const user = DB.getCurrentUser();
  if (!user) { openModal('authModal'); return; }
  const all = getAllOpps();
  const opp = all.find(o => String(o.id) === String(oppId));
  if (!opp) return;
  const items = getTrackerItems();
  if (items.find(i => String(i.oppId) === String(oppId))) {
    showToast('Already in your tracker!', '');
    return;
  }
  items.push({
    oppId: opp.id, name: opp.name, org: opp.org,
    amount: opp.amount, deadline: opp.deadline,
    matchScore: opp.matchScore, logo: opp.logo,
    status: 'saved', note: '', addedAt: new Date().toISOString()
  });
  saveTrackerItems(items);
  showToast(`"${opp.name}" saved to tracker 📊`, 'success');
}

function renderTracker() {
  const container = document.getElementById('tracker-content');
  if (!container) return;
  const items = getTrackerItems();

  if (items.length === 0) {
    container.innerHTML = `
      <div class="tracker-empty-state">
        <div class="tracker-empty-icon">📊</div>
        <div class="tracker-empty-title">Your tracker is empty</div>
        <div class="tracker-empty-sub">Save funding opportunities from the directory and track every application from one place — deadlines, notes, and status all in one board.</div>
        <div class="tracker-empty-steps">
          <div class="tracker-empty-step">
            <div class="tes-num">1</div>
            <div class="tes-text"><strong>Browse the directory</strong>Find grants, accelerators, and VCs that match your startup</div>
          </div>
          <div class="tracker-empty-step">
            <div class="tes-num">2</div>
            <div class="tes-text"><strong>Save to tracker</strong>Hit "Save to Tracker" on any opportunity card</div>
          </div>
          <div class="tracker-empty-step">
            <div class="tes-num">3</div>
            <div class="tes-text"><strong>Track your progress</strong>Move cards across columns as you apply — Saved → In Progress → Submitted → Decision</div>
          </div>
        </div>
        <div style="margin-bottom:20px">
          <div class="tracker-demo-label">Example card</div>
          <div class="tracker-demo-card" onclick="openDetail(1)">
            <div class="tracker-demo-name">EIC Accelerator 2026</div>
            <div class="tracker-demo-org">European Innovation Council</div>
            <div class="tracker-demo-footer">
              <span class="match-pill" style="font-size:11px">✦ 91% match</span>
              <span style="font-size:11px;color:var(--muted)">📅 May 6, 2026</span>
              <span style="font-size:11px;color:var(--muted);background:var(--bg2);padding:2px 8px;border-radius:4px;border:1px solid var(--border)">Up to €2.5M</span>
            </div>
          </div>
        </div>
        <button class="btn btn-primary" onclick="showView('directory')" style="width:100%;justify-content:center">Browse Funding Opportunities →</button>
      </div>`;
    return;
  }

  // Group by status
  const cols = [
    { key: 'saved',       label: 'Saved',       color: 'var(--ink2)' },
    { key: 'inprogress',  label: 'In Progress',  color: 'var(--accent3)' },
    { key: 'submitted',   label: 'Submitted',    color: 'var(--accent2)' },
    { key: 'decision',    label: 'Decision',     color: 'var(--gold)' },
  ];
  const grouped = {};
  cols.forEach(c => grouped[c.key] = items.filter(i => i.status === c.key));

  const total = items.length;
  const submitted = grouped.submitted.length;
  const inprog = grouped.inprogress.length;
  const decision = grouped.decision.length;

  container.innerHTML = `
    <div class="stats-row" style="margin-bottom:20px">
      <div class="stat-card"><div class="stat-num">${total}</div><div class="stat-label">Total saved</div></div>
      <div class="stat-card"><div class="stat-num" style="color:var(--accent3)">${inprog}</div><div class="stat-label">In progress</div></div>
      <div class="stat-card"><div class="stat-num" style="color:var(--accent2)">${submitted}</div><div class="stat-label">Submitted</div></div>
      <div class="stat-card"><div class="stat-num" style="color:var(--gold)">${decision}</div><div class="stat-label">Decision</div></div>
    </div>
    <div class="kanban">
      ${cols.map(col => `
        <div class="kanban-col" data-col="${col.key}">
          <div class="kanban-col-header" style="color:${col.color}">
            ${col.label} <span class="kanban-count">${grouped[col.key].length}</span>
          </div>
          ${grouped[col.key].length === 0 ? `
            <div style="border:1.5px dashed var(--border);border-radius:10px;padding:20px 14px;text-align:center;color:var(--muted);font-size:12px;margin-top:4px">
              Drop cards here
            </div>` : ''}
          ${grouped[col.key].map(item => renderTrackerCard(item, col.key, cols)).join('')}
        </div>`).join('')}
    </div>`;
}

function renderTrackerCard(item, currentCol, cols) {
  const otherCols = cols.filter(c => c.key !== currentCol);
  const moveOpts = otherCols.map(c => `<option value="${c.key}">${c.label}</option>`).join('');
  const urgency = isUrgent(item.deadline);
  return `
    <div class="tracker-card" style="${currentCol === 'decision' ? 'border-left:3px solid var(--gold)' : ''}">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:8px">
        <div style="flex:1;min-width:0">
          <div class="tracker-card-name" onclick="openDetail('${item.oppId}')" style="cursor:pointer">${item.name}</div>
          <div class="tracker-card-org">${item.org}</div>
        </div>
        <button onclick="removeFromTracker('${item.oppId}')" title="Remove" style="background:none;border:none;cursor:pointer;color:var(--muted);font-size:14px;padding:0;flex-shrink:0;line-height:1" onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color='var(--muted)'">✕</button>
      </div>
      <div class="tracker-card-deadline ${urgency ? 'soon' : ''}" style="margin-top:6px">📅 ${urgency ? '⚠ ' : ''}${item.deadline}</div>
      <div class="tracker-card-amount">${item.amount}</div>
      ${item.matchScore ? `
        <div style="margin-top:8px">
          ${buildMatchPill(item.matchScore, ['Matches your stage', 'Matches geography', 'Active deadline'])}
        </div>` : ''}
      ${item.note ? `<div class="tracker-card-note">${item.note}</div>` : ''}
      <div style="margin-top:10px;display:flex;align-items:center;gap:6px">
        <select onchange="moveTrackerItem('${item.oppId}',this.value)" style="flex:1;font-size:11px;padding:5px 8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--ink2);cursor:pointer;font-family:var(--font-body)" title="Move to…">
          <option value="">Move to…</option>
          ${moveOpts}
        </select>
        <button onclick="editTrackerNote('${item.oppId}')" style="font-size:11px;padding:5px 10px;border:1px solid var(--border);border-radius:6px;background:var(--surface);color:var(--ink2);cursor:pointer;font-family:var(--font-body)" title="Add note">✏</button>
      </div>
    </div>`;
}

function isUrgent(deadline) {
  if (!deadline || deadline === 'Rolling') return false;
  const d = new Date(deadline);
  if (isNaN(d)) return false;
  return (d - new Date()) < 14 * 86400000;
}

function moveTrackerItem(oppId, newStatus) {
  if (!newStatus) return;
  const items = getTrackerItems();
  const item = items.find(i => String(i.oppId) === String(oppId));
  if (!item) return;
  item.status = newStatus;
  saveTrackerItems(items);
  renderTracker();
  showToast(`Moved to "${newStatus.replace('inprogress','In Progress')}" 📋`, '');
}

function removeFromTracker(oppId) {
  let items = getTrackerItems();
  items = items.filter(i => String(i.oppId) !== String(oppId));
  saveTrackerItems(items);
  renderTracker();
}

function editTrackerNote(oppId) {
  const items = getTrackerItems();
  const item = items.find(i => String(i.oppId) === String(oppId));
  if (!item) return;
  const note = prompt('Add a note for this application:', item.note || '');
  if (note === null) return;
  item.note = note;
  saveTrackerItems(items);
  renderTracker();
}

// ═══════════════════════════════════════════
// MATCH SCORE TOOLTIP
// ═══════════════════════════════════════════
function buildMatchPill(score, reasons) {
  const user = DB.getCurrentUser();
  const profile = user && user.profile ? user.profile : null;

  // Build dynamic reasons based on profile if available
  const rows = [];
  if (profile && profile.stage) {
    rows.push({ icon: '📍', text: `Stage: ${profile.stage}` });
  }
  if (profile && profile.geo) {
    rows.push({ icon: '🌍', text: `Location: ${profile.geo.replace(/[^\w\s\/]/gu,'').trim()}` });
  }
  if (profile && profile.sectors && profile.sectors.length) {
    rows.push({ icon: '🏷', text: profile.sectors.slice(0,2).map(s=>s.replace(/[^\w\s\/]/g,'').trim()).join(', ') });
  }

  // Fallback generic reasons
  const displayRows = rows.length ? rows : (reasons || []).map((r,i) => ({ icon: ['✓','✓','✓'][i] || '✓', text: r }));

  const tooltipHtml = `
    <div class="match-tooltip">
      <div class="match-tooltip-title">Why this score?</div>
      <div class="match-tooltip-score">${score}% match</div>
      ${displayRows.map(r => `
        <div class="match-tooltip-row">
          <span class="mtr-icon">${r.icon}</span>
          <span>${r.text}</span>
        </div>`).join('')}
      ${!profile ? `<div style="margin-top:8px;font-size:10px;color:rgba(255,255,255,0.35);border-top:1px solid rgba(255,255,255,0.08);padding-top:7px">Complete your profile for personalised scores</div>` : ''}
    </div>`;

  return `<span class="match-pill-wrap">
    <span class="match-pill">✦ ${score}% match</span>
    ${tooltipHtml}
  </span>`;
}

// ═══════════════════════════════════════════
// MOBILE NAVIGATION
// ═══════════════════════════════════════════
function toggleMobileDrawer() {
  const drawer = document.getElementById('mobile-drawer');
  const hamburger = document.getElementById('nav-hamburger');
  const isOpen = drawer.classList.contains('open');
  if (isOpen) { closeMobileDrawer(); return; }
  drawer.classList.add('open');
  hamburger.classList.add('open');
  document.body.style.overflow = 'hidden';
  syncMobileDrawerUser();
}

function closeMobileDrawer() {
  const drawer = document.getElementById('mobile-drawer');
  const hamburger = document.getElementById('nav-hamburger');
  drawer.classList.remove('open');
  hamburger.classList.remove('open');
  document.body.style.overflow = '';
}

function syncMobileDrawerUser() {
  const user = DB.getCurrentUser();
  const drawerUser = document.getElementById('mobile-drawer-user');
  const drawerAvatar = document.getElementById('mobile-drawer-avatar');
  const drawerName = document.getElementById('mobile-drawer-name');
  const drawerType = document.getElementById('mobile-drawer-type');
  const drawerSignin = document.getElementById('drawer-signin-btn');
  const drawerSignout = document.getElementById('drawer-signout-btn');
  const drawerFounder = document.getElementById('drawer-founder-section');
  const drawerInvestor = document.getElementById('drawer-investor-section');
  const drawerAdmin = document.getElementById('drawer-admin-section');

  if (user) {
    drawerUser.classList.remove('hidden');
    const initials = user.name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
    drawerAvatar.textContent = initials;
    drawerName.textContent = user.name;
    drawerType.textContent = user.type === 'investor' ? '🏦 Investor / Funder' : user.type === 'admin' ? '⚡ Super Admin' : '🚀 Founder';
    drawerSignin.classList.add('hidden');
    drawerSignout.classList.remove('hidden');
    drawerFounder.style.display = user.type === 'founder' ? 'block' : 'none';
    drawerInvestor.style.display = (user.type === 'investor' || user.type === 'admin') ? 'block' : 'none';
    drawerAdmin.style.display = (user.type === 'admin' || user.email === ADMIN_EMAIL) ? 'block' : 'none';
  } else {
    drawerUser.classList.add('hidden');
    drawerSignin.classList.remove('hidden');
    drawerSignout.classList.add('hidden');
    drawerFounder.style.display = 'none';
    drawerInvestor.style.display = 'none';
    drawerAdmin.style.display = 'none';
  }
}

function setActiveTab(name) {
  document.querySelectorAll('.mobile-tab-btn').forEach(b => b.classList.remove('active'));
  const tab = document.getElementById('tab-' + name);
  if (tab) tab.classList.add('active');
}

function handleTrackerTab() {
  const user = DB.getCurrentUser();
  if (!user) { openModal('authModal'); return; }
  showView('tracker'); setActiveTab('tracker');
}

function handleProfileTab() {
  const user = DB.getCurrentUser();
  if (!user) { openModal('authModal'); return; }
  showView('profile'); setActiveTab('profile');
}

// Sync tab bar active state when showView is called
const _origShowView = showView;
// (tab sync is handled inline in setActiveTab calls above)
// ═══════════════════════════════════════════
// GOOGLE AUTH — Full Implementation
// ═══════════════════════════════════════════
//
// HOW TO ENABLE REAL GOOGLE SIGN-IN:
//   1. Go to console.cloud.google.com
//   2. Create a project → APIs & Services → Credentials
//   3. Create OAuth 2.0 Client ID → Web Application
//   4. Add your domain to "Authorised JavaScript origins"
//      e.g. https://yourdomain.com OR http://localhost for local dev
//   5. Paste the Client ID below and redeploy
//
// When GOOGLE_CLIENT_ID is empty, the app shows a realistic
// account picker demo so the prototype is fully testable.
// ═══════════════════════════════════════════

const GOOGLE_CLIENT_ID = ''; // ← paste your Client ID here

// Demo accounts shown in the picker when no Client ID is configured
const DEMO_GOOGLE_ACCOUNTS = [
  {
    name: 'Alex Johnson',
    email: 'alex.johnson@gmail.com',
    initials: 'AJ',
    color: '#4285F4',
    type: 'founder'
  },
  {
    name: 'Priya Sharma',
    email: 'priya.sharma@gmail.com',
    initials: 'PS',
    color: '#34A853',
    type: 'founder'
  }
];

let _googleAuthMode  = 'signin';
let _googleAuthType  = 'founder';
let _googlePickerOpen = false;

// ── Entry point ──────────────────────────────────────────────────
function handleGoogleAuth(mode) {
  _googleAuthMode = mode;
  _googleAuthType = selectedUserType || 'founder';

  const btn = document.getElementById(mode === 'signin' ? 'google-signin-btn' : 'google-signup-btn');
  if (btn) { btn.classList.add('loading'); btn.querySelector('.google-btn-text').textContent = 'Connecting'; }

  setTimeout(() => {
    if (btn) { btn.classList.remove('loading'); btn.querySelector('.google-btn-text').textContent = 'Continue with Google'; }

    if (GOOGLE_CLIENT_ID) {
      // Real Google OAuth flow
      loadGSIAndAuth();
    } else {
      // Demo flow — show realistic account picker
      openGooglePicker();
    }
  }, 600);
}

// ── Real OAuth ────────────────────────────────────────────────────
function loadGSIAndAuth() {
  if (window.google && window.google.accounts) {
    triggerGooglePopup();
    return;
  }
  const script = document.createElement('script');
  script.src = 'https://accounts.google.com/gsi/client';
  script.async = true; script.defer = true;
  script.onload = triggerGooglePopup;
  script.onerror = () => showToast('Could not load Google auth. Check your connection.', 'error');
  document.head.appendChild(script);
}

function triggerGooglePopup() {
  try {
    google.accounts.oauth2.initTokenClient({
      client_id: GOOGLE_CLIENT_ID,
      scope: 'openid email profile',
      prompt: 'select_account',
      callback: (response) => {
        if (response.error) {
          showToast('Google sign-in cancelled', '');
          return;
        }
        fetchGoogleProfile(response.access_token);
      }
    }).requestAccessToken();
  } catch(e) {
    showToast('Google sign-in failed. Try the email option below.', 'error');
  }
}

function fetchGoogleProfile(accessToken) {
  showToast('Verifying with Google…');
  fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
    headers: { Authorization: `Bearer ${accessToken}` }
  })
  .then(r => r.json())
  .then(profile => {
    if (!profile.email) { showToast('Google sign-in failed — try again', 'error'); return; }
    completeGoogleSignIn({
      name: profile.name,
      email: profile.email,
      picture: profile.picture,
      googleId: profile.sub
    });
  })
  .catch(() => showToast('Could not reach Google. Please try again.', 'error'));
}

// ── Demo account picker ───────────────────────────────────────────
function openGooglePicker() {
  _googlePickerOpen = true;
  const overlay = document.getElementById('googlePickerOverlay');
  const container = document.getElementById('picker-accounts');
  const title = document.getElementById('picker-title');
  const sub = document.getElementById('picker-sub');

  title.textContent = _googleAuthMode === 'signin' ? 'Choose an account' : 'Continue as…';
  sub.textContent = 'to continue to CapStack';

  // Build account rows from demo accounts + any real Google users saved
  const savedUsers = DB.getUsers().filter(u => u.provider === 'google');
  const allAccounts = [
    ...savedUsers.map(u => ({
      name: u.name, email: u.email,
      initials: u.name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase(),
      color: u.type === 'investor' ? '#34A853' : '#4285F4',
      type: u.type, _realUser: u
    })),
    ...DEMO_GOOGLE_ACCOUNTS.filter(d => !savedUsers.find(u => u.email === d.email))
  ];

  container.innerHTML = allAccounts.map((acc, i) => `
    <div class="google-account-row" onclick="selectGoogleAccount(${i})" data-idx="${i}">
      <div class="google-account-avatar" style="background:${acc.color}">
        ${acc.picture
          ? `<img class="avatar-img" src="${acc.picture}" alt="${acc.name}" onerror="this.parentElement.textContent='${acc.initials}'">`
          : acc.initials}
      </div>
      <div class="google-account-info">
        <div class="google-account-name">${acc.name}</div>
        <div class="google-account-email">${acc.email}</div>
      </div>
    </div>`).join('');

  // Store for callback
  window._pickerAccounts = allAccounts;

  overlay.classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeGooglePicker() {
  document.getElementById('googlePickerOverlay').classList.remove('open');
  document.body.style.overflow = '';
  _googlePickerOpen = false;
}

function renderGoogleConnectionSection() {
  const el = document.getElementById('google-connection-section');
  if (!el) return;
  const user = DB.getCurrentUser();
  if (!user) { el.innerHTML = ''; return; }

  if (user.provider === 'google' || user.googleId) {
    // Connected
    el.innerHTML = `
      <div class="google-connect-prompt" style="background:#f0fdf4;border-color:#86efac">
        <div class="google-connect-left">
          <svg width="22" height="22" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
          <div class="google-connect-info">
            <strong>Connected with Google</strong>
            <span>${user.email}</span>
          </div>
        </div>
        <span class="google-connected-badge">✓ Connected</span>
      </div>`;
  } else {
    // Not connected — show connect prompt
    el.innerHTML = `
      <div class="google-connect-prompt">
        <div class="google-connect-left">
          <svg width="22" height="22" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
          <div class="google-connect-info">
            <strong>Connect your Google account</strong>
            <span>Sign in faster and sync your profile automatically</span>
          </div>
        </div>
        <button class="google-btn" onclick="connectGoogleToAccount()" style="width:auto;padding:8px 16px;font-size:13px">
          <svg width="14" height="14" viewBox="0 0 18 18"><path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 002.38-5.88c0-.57-.05-.66-.15-1.18z"/><path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 01-7.18-2.54H1.83v2.07A8 8 0 008.98 17z"/><path fill="#FBBC05" d="M4.5 10.52a4.8 4.8 0 010-3.04V5.41H1.83a8 8 0 000 7.18l2.67-2.07z"/><path fill="#EA4335" d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 001.83 5.4L4.5 7.49a4.77 4.77 0 014.48-3.3z"/></svg>
          <span class="google-btn-text">Connect Google</span>
        </button>
      </div>`;
  }
}

function connectGoogleToAccount() {
  _googleAuthMode = 'connect';
  const btn = document.querySelector('#google-connection-section .google-btn');
  if (btn) { btn.classList.add('loading'); btn.querySelector('.google-btn-text').textContent = 'Connecting'; }
  setTimeout(() => {
    if (btn) { btn.classList.remove('loading'); btn.querySelector('.google-btn-text').textContent = 'Connect Google'; }
    if (GOOGLE_CLIENT_ID) {
      loadGSIAndAuth();
    } else {
      // Demo: pick an account and link it
      _googleAuthMode = 'connect';
      openGooglePicker();
    }
  }, 600);
}

function selectGoogleAccount(idx) {
  const acc = window._pickerAccounts[idx];
  if (!acc) return;

  // Animate selection
  const rows = document.querySelectorAll('.google-account-row');
  rows.forEach(r => r.style.opacity = '0.4');
  if (rows[idx]) rows[idx].style.opacity = '1';

  setTimeout(() => {
    closeGooglePicker();
    // Small delay for a realistic feel
    setTimeout(() => {
      if (acc._realUser) {
        // Known user — sign straight in
        completeGoogleSignIn({ name: acc.name, email: acc.email, googleId: acc._realUser.googleId, _existingUser: acc._realUser });
      } else {
        // Demo account — create/sign in
        completeGoogleSignIn({ name: acc.name, email: acc.email, googleId: 'demo_' + acc.email, _demoType: acc.type });
      }
    }, 300);
  }, 250);
}

function addNewGoogleAccount() {
  closeGooglePicker();
  // Show a simple email prompt in demo mode
  setTimeout(() => {
    const email = prompt('Enter the Google account email you want to use:');
    if (!email || !email.includes('@')) return;
    const name = email.split('@')[0].replace(/[._]/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
    completeGoogleSignIn({ name, email, googleId: 'demo_' + email });
  }, 200);
}

// ── Shared completion logic (real + demo) ─────────────────────────
function completeGoogleSignIn({ name, email, picture, googleId, _existingUser, _demoType }) {
  const users = DB.getUsers();
  let user = _existingUser || users.find(u => u.email === email);

  if (user) {
    // Update picture if available
    if (picture && !user.picture) { user.picture = picture; DB.saveUsers(users); }
    DB.setCurrentUser(user);
    closeModal('authModal');
    updateNavForUser(user);
    // Show avatar if Google picture available
    if (user.picture) injectGoogleAvatar(user.picture);
    showToast(`Welcome back, ${user.name.split(' ')[0]}! 👋`, 'success');
    setTimeout(() => {
      if (user.type === 'investor') showView('investor');
      else if (user.type === 'admin') showView('admin');
      else showView('directory');
    }, 350);
  } else {
    // New user via Google
    const newUser = {
      id: 'guser_' + Date.now(),
      name: name || email.split('@')[0],
      email,
      picture: picture || null,
      googleId,
      type: _demoType || _googleAuthType,
      provider: 'google',
      createdAt: new Date().toISOString(),
      profile: {}
    };
    users.push(newUser);
    DB.saveUsers(users);
    DB.setCurrentUser(newUser);
    closeModal('authModal');
    updateNavForUser(newUser);
    if (newUser.picture) injectGoogleAvatar(newUser.picture);
    if (newUser.type === 'investor') {
      showToast(`Welcome, ${newUser.name.split(' ')[0]}! Let's get your listings live 🚀`, 'success');
      setTimeout(() => showView('investor'), 400);
    } else {
      setTimeout(() => startOnboarding(newUser), 400);
    }
  }
}

// Inject Google profile picture into avatar elements
function injectGoogleAvatar(pictureUrl) {
  if (!pictureUrl) return;
  const initEls = document.querySelectorAll('#user-avatar-initials, #dropdown-avatar-large, #mobile-drawer-avatar');
  initEls.forEach(el => {
    const img = document.createElement('img');
    img.src = pictureUrl;
    img.alt = 'Profile';
    img.style.cssText = 'width:100%;height:100%;border-radius:inherit;object-fit:cover;position:absolute;inset:0';
    img.onerror = () => img.remove();
    el.style.position = 'relative';
    el.style.overflow = 'hidden';
    el.appendChild(img);
  });
}

// Close picker on backdrop click
document.getElementById('googlePickerOverlay').addEventListener('click', (e) => {
  if (e.target === document.getElementById('googlePickerOverlay')) closeGooglePicker();
});

// ── showGoogleSetupPrompt kept for edge cases ─────────────────────
function showGoogleSetupPrompt() {
  showToast('Add your Google Client ID to the JS to enable real sign-in.', '');
}

document.addEventListener('DOMContentLoaded', () => {
  // Restore session
  const user = DB.getCurrentUser();
  if (user) {
    updateNavForUser(user);
    // Recalc match scores if user completed onboarding
    if (user.profile && user.profile.onboarded) {
      window._OPPS = opportunities;
      recalcMatchScores(user.profile);
    }
  }

  // Init directory
  renderOpps(getAllOpps());

  // Init eligibility builder
  addEligRow(true);
  addEligRow(false);

  // Restore activity log
  activityLog = JSON.parse(localStorage.getItem('capstack_activity') || '[]');
});
</script>

<!-- ══ GOOGLE ACCOUNT PICKER ══ -->

<div class="google-picker-overlay" id="googlePickerOverlay">
  <div class="google-picker">
    <div class="google-picker-header">
      <div class="google-picker-logo">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        <span>Sign in with Google</span>
      </div>
      <div class="google-picker-title" id="picker-title">Choose an account</div>
      <div class="google-picker-sub" id="picker-sub">to continue to CapStack</div>
    </div>
    <div class="google-picker-accounts" id="picker-accounts">
      <!-- populated dynamically -->
    </div>
    <div class="google-picker-divider"></div>
    <div class="google-picker-add-row" onclick="addNewGoogleAccount()">
      <div class="google-picker-add-icon">＋</div>
      <div class="google-picker-add-text">Use another account</div>
    </div>
    <div class="google-picker-footer">
      <button class="google-picker-cancel" onclick="closeGooglePicker()">Cancel</button>
    </div>
  </div>
</div>

<!-- ══ ONBOARDING MODAL ══ -->

<div class="onboarding-overlay" id="onboardingOverlay">
  <div class="onboarding-modal">
    <div class="onboarding-header">
      <div class="onboarding-step-dots">
        <div class="onboarding-step-dot active" id="ob-dot-0"></div>
        <div class="onboarding-step-dot" id="ob-dot-1"></div>
        <div class="onboarding-step-dot" id="ob-dot-2"></div>
        <div class="onboarding-step-dot" id="ob-dot-3"></div>
      </div>
      <h2 id="ob-heading">Welcome to CapStack 🎉</h2>
      <p id="ob-subheading">Let's personalise your experience in 3 quick steps so we can match you to the right funding.</p>
    </div>
    <div class="onboarding-progress-bar">
      <div class="onboarding-progress-fill" id="ob-progress" style="width:0%"></div>
    </div>
    <div class="onboarding-body">

```
  <!-- Step 0: Welcome -->
  <div class="onboarding-step active" id="ob-step-0">
    <div class="onboarding-welcome-screen">
      <ul class="onboarding-welcome-list">
        <li><span class="wl-icon">🔍</span>Browse 2,400+ verified funding opportunities</li>
        <li><span class="wl-icon">✦</span>Get a personalised match score for every listing</li>
        <li><span class="wl-icon">📊</span>Track all your applications in one kanban board</li>
        <li><span class="wl-icon">🔔</span>Never miss a deadline with smart reminders</li>
      </ul>
    </div>
  </div>

  <!-- Step 1: Sector -->
  <div class="onboarding-step" id="ob-step-1">
    <div class="onboarding-question">What sector is your startup in?</div>
    <p class="onboarding-hint">Select all that apply — we'll use this to filter relevant grants and programmes.</p>
    <div class="onboarding-chips" id="ob-chips-sector">
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🤖 AI / ML</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🌱 Climate Tech</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🏥 Health / Bio</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">💰 Fintech</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🔬 Deep Tech</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🛍 Consumer</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🏢 B2B SaaS</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🌍 Impact / Social</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">⚡ Energy</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🚗 Mobility</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">🎮 Gaming / Media</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'sector')">Other</span>
    </div>
  </div>

  <!-- Step 2: Stage -->
  <div class="onboarding-step" id="ob-step-2">
    <div class="onboarding-question">What stage is your startup at?</div>
    <p class="onboarding-hint">This helps us surface the most relevant funding rounds and accelerators.</p>
    <div class="onboarding-chips" id="ob-chips-stage">
      <span class="onboarding-chip" onclick="toggleChip(this,'stage','single')">💡 Idea stage<br><small style="font-weight:400;opacity:0.7">Haven't built anything yet</small></span>
      <span class="onboarding-chip" onclick="toggleChip(this,'stage','single')">🛠 Building MVP<br><small style="font-weight:400;opacity:0.7">Pre-revenue, under $50K raised</small></span>
      <span class="onboarding-chip" onclick="toggleChip(this,'stage','single')">🌱 Pre-seed<br><small style="font-weight:400;opacity:0.7">Early traction, raising first round</small></span>
      <span class="onboarding-chip" onclick="toggleChip(this,'stage','single')">🌿 Seed<br><small style="font-weight:400;opacity:0.7">$250K–$2M raised</small></span>
      <span class="onboarding-chip" onclick="toggleChip(this,'stage','single')">🚀 Series A+<br><small style="font-weight:400;opacity:0.7">$2M+ raised</small></span>
    </div>
  </div>

  <!-- Step 3: Geography -->
  <div class="onboarding-step" id="ob-step-3">
    <div class="onboarding-question">Where is your startup based?</div>
    <p class="onboarding-hint">Many grants and accelerators are region-specific — this ensures you only see eligible opportunities.</p>
    <div class="onboarding-chips" id="ob-chips-geo">
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🇺🇸 United States</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🇬🇧 United Kingdom</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🇪🇺 Europe (EU)</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🇮🇳 India</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🌍 Africa</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🌏 Southeast Asia</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🇨🇦 Canada</span>
      <span class="onboarding-chip" onclick="toggleChip(this,'geo','single')">🌐 Global / Remote</span>
    </div>
  </div>

</div>
<div class="onboarding-footer">
  <button class="onboarding-skip" onclick="skipOnboarding()">Skip for now</button>
  <button class="btn btn-primary" id="ob-next-btn" onclick="onboardingNext()">Get Started →</button>
</div>
```

  </div>
</div>

<!-- ══ REJECT REASON MODAL — must be last in DOM for correct stacking ══ -->

<div class="modal-overlay" id="rejectModal">
  <div class="reject-modal">
    <div class="reject-modal-header">
      <h3>Reject Submission</h3>
      <p>Select a reason — this will be sent to the submitter.</p>
    </div>
    <div class="reject-modal-body">
      <button class="reject-reason-btn" onclick="selectRejectReason(this)">🔍 Duplicate — we already have this opportunity listed</button>
      <button class="reject-reason-btn" onclick="selectRejectReason(this)">📋 Incomplete information — key fields are missing or vague</button>
      <button class="reject-reason-btn" onclick="selectRejectReason(this)">❌ Cannot verify — organisation or programme cannot be confirmed</button>
      <button class="reject-reason-btn" onclick="selectRejectReason(this)">🚫 Ineligible type — does not meet CapStack listing standards</button>
      <button class="reject-reason-btn" onclick="selectRejectReason(this)">💀 Expired — this programme has already closed or ended</button>
      <div style="margin-top:12px">
        <label style="font-size:11px;color:rgba(255,255,255,0.35);display:block;margin-bottom:6px;font-weight:600;letter-spacing:0.04em">CUSTOM NOTE (OPTIONAL)</label>
        <textarea id="rejectCustomNote" style="width:100%;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:10px 12px;font-family:var(--font-body);font-size:13px;color:rgba(255,255,255,0.7);outline:none;min-height:60px;resize:vertical;box-sizing:border-box" placeholder="Add any additional context for the submitter..."></textarea>
      </div>
    </div>
    <div class="reject-modal-footer">
      <button class="action-btn action-btn-view" onclick="closeModal('rejectModal')">Cancel</button>
      <button class="action-btn action-btn-reject" onclick="confirmReject()">Confirm Rejection</button>
    </div>
  </div>
</div>

</body>
</html>